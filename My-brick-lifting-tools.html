<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
  <link rel="mask-icon" href="/favicon.ico" color="#222">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="//fonts.loli.net/css?family=Lato:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://blog.k8s.li').hostname,
    root: '/',
    scheme: 'Gemini',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"always","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":true,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"buttons","active":null,"storage":true,"lazyload":true,"nav":{"disqus":{"text":"Load Disqus","order":-1}}},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":false,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>
  <meta name="description" content="咕咕咕本来打算上上周就该更新完的这篇博文，但最近因为离职的事宜拖到今天晚上才捡起来，最终还是咕咕咕了😂。虽然文章还未补充完，等到以后再继续更新上吧。 Linux确切地来讲 Linux 仅仅是一个操作系统的内核，而且它的代码在一个发行版中的占用率也不到 20%。 入门咱一直觉着学习技术吧，并不是看书看视频能学会的。对于一些底层的只是确实需要仔细研读书籍来吃透他，这趟会让我们对操作系统这个体系结构有">
<meta property="og:type" content="article">
<meta property="og:title" content="木子的搬砖工具😂">
<meta property="og:url" content="https://blog.k8s.li/My-brick-lifting-tools.html">
<meta property="og:site_name" content="木子">
<meta property="og:description" content="咕咕咕本来打算上上周就该更新完的这篇博文，但最近因为离职的事宜拖到今天晚上才捡起来，最终还是咕咕咕了😂。虽然文章还未补充完，等到以后再继续更新上吧。 Linux确切地来讲 Linux 仅仅是一个操作系统的内核，而且它的代码在一个发行版中的占用率也不到 20%。 入门咱一直觉着学习技术吧，并不是看书看视频能学会的。对于一些底层的只是确实需要仔细研读书籍来吃透他，这趟会让我们对操作系统这个体系结构有">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://p.k8s.li/20200506142544440.png">
<meta property="og:image" content="https://p.k8s.li/20200506151706148.png">
<meta property="og:image" content="https://p.k8s.li/20200506143310955.png">
<meta property="og:image" content="https://p.k8s.li/20200506154459952.png">
<meta property="article:published_time" content="2020-05-21T16:00:00.000Z">
<meta property="article:modified_time" content="2021-05-30T14:38:18.416Z">
<meta property="article:author" content="木子">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="搬砖">
<meta property="article:tag" content="工具">
<meta property="article:tag" content="命令行">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://p.k8s.li/20200506142544440.png">
<link rel="canonical" href="https://blog.k8s.li/My-brick-lifting-tools.html">
<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>
  <title>木子的搬砖工具😂 | 木子</title>
  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }
  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>
<link rel="alternate" href="/atom.xml" title="木子" type="application/atom+xml">
</head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">
    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">木子</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>
<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">
    <a href="/" rel="section"><i class="fa fa-fw fa-desktop"></i>Home</a>
  </li>
        <li class="menu-item menu-item-books">
    <a href="/booklist.html" rel="section"><i class="fa fa-fw fa-book"></i>Books</a>
  </li>
        <li class="menu-item menu-item-kindle">
    <a href="https://kindle.502.li/" rel="noopener" target="_blank"><i class="fa fa-fw fa-book"></i>Kindle</a>
  </li>
        <li class="menu-item menu-item-friend">
    <a href="/link/" rel="section"><i class="fa fa-fw fa-link"></i>Friend</a>
  </li>
        <li class="menu-item menu-item-about">
    <a href="/about.html" rel="section"><i class="fa fa-fw fa-user-circle-o"></i>About</a>
  </li>
  </ul>
</nav>
</div>
    </header>
  <div class="reading-progress-bar"></div>
    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div class="content">
  <div class="posts-expand">
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.k8s.li/My-brick-lifting-tools.html">
    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blog.k8s.li/avatar.png">
      <meta itemprop="name" content="木子">
      <meta itemprop="description" content="">
    </span>
    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木子">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          木子的搬砖工具😂
        </h2>
        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="创建时间：2020-05-22 2020-05-22T00:00:00+08:00" itemprop="dateCreated datePublished" datetime="2020-05-22T00:00:00+08:00">2020-05-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-05-30 2021-05-30T22:38:18+08:00" itemprop="dateModified" datetime="2021-05-30T22:38:18+08:00">2021-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>
            </span>
  <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    <a title="disqus" href="/My-brick-lifting-tools.html#comments" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="My-brick-lifting-tools.html" itemprop="commentCount"></span>
    </a>
  </span>
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>45k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1:15</span>
            </span>
        </div>
      </header>
    <div class="post-body" itemprop="articleBody">
        <h2 id="咕咕咕"><a href="#咕咕咕" class="headerlink" title="咕咕咕"></a>咕咕咕</h2><p>本来打算上上周就该更新完的这篇博文，但最近因为离职的事宜拖到今天晚上才捡起来，最终还是咕咕咕了😂。虽然文章还未补充完，等到以后再继续更新上吧。</p>
<h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><p>确切地来讲 Linux 仅仅是一个操作系统的内核，而且它的代码在一个发行版中的占用率也不到 20%。</p>
<h3 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h3><p>咱一直觉着学习技术吧，并不是看书看视频能学会的。对于一些底层的只是确实需要仔细研读书籍来吃透他，这趟会让我们对操作系统这个体系结构有更下透彻的认识。但是呢，光看不练还是不行滴，咱学习 Linux 纯靠瞎玩，瞎折腾。咱大学时学校没有开设 Linux 课程，只能靠自己自学。于是乎，和大家一样，搭建 WordPress ，一步步安装 LAMP 环境，配置 iptables，写 shell 脚本备份网站，搭建梯子等等。可谓是玩得不亦乐乎😂。</p>
<p>所以说学习和入门 Linux 咱还是推荐鸟哥的《鸟哥 Linux 私房菜》这本书，结合着自己搭建网站一步步来就可以。</p>
<h3 id="放弃"><a href="#放弃" class="headerlink" title="放弃"></a>放弃</h3><p>入门完 Linux 之后就开始挑战高难度的啦，比如：</p>
<ul>
<li>OpenStack</li>
<li>Docker</li>
<li>Kubernetes</li>
<li>CI/CD</li>
</ul>
<p>目前来讲在运维这个搬砖行业，kubernetes 云原生无疑是最具有挑战性和前景的，所以如果汝想更近一层楼就不妨学习一下 Docker 和 Kuberneets 这一块。</p>
<h3 id="发行版"><a href="#发行版" class="headerlink" title="发行版"></a>发行版</h3><p>从运维这个搬砖行业来讲，企业内部使用的 Linux 发行版当属 RedHat 和 Debian 家族的最多，像其他的什么 archlinux 咱还真没见过有在生产环境使用的，毕竟滚动更新不小心就滚挂了不好说😂。国内企业和云计算厂商使用最多的当然是 CentOS 啦，我记得是在 2018 年年末的时候阿里云/腾讯云还没有 Ubuntu 1804 的云主机可用😑。国外使用 Ubuntu 的较多一些，咱是倾向于使用 Ubuntu 😝</p>
<p>从 <a href="https://www.datanyze.com" target="_blank" rel="noopener">datanyze</a> 家偷来一张企业 Linux 市场占有率的统计表格 <a href="https://www.datanyze.com/market-share/operating-systems--443" target="_blank" rel="noopener">Operating Systems</a>😂</p>
<table>
<thead>
<tr>
<th align="center">Ranking</th>
<th align="left">Technology</th>
<th align="right">Domains</th>
<th align="right">Market Share</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/ubuntu-market-share" target="_blank" rel="noopener">Ubuntu</a></td>
<td align="right">278,611</td>
<td align="right">29.30%</td>
</tr>
<tr>
<td align="center">2</td>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/unix-market-share" target="_blank" rel="noopener">Unix</a></td>
<td align="right">192,215</td>
<td align="right">20.21%</td>
</tr>
<tr>
<td align="center">3</td>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/centos-market-share" target="_blank" rel="noopener">CentOS</a></td>
<td align="right">165,640</td>
<td align="right">17.42%</td>
</tr>
<tr>
<td align="center">4</td>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/debian-market-share" target="_blank" rel="noopener">Debian</a></td>
<td align="right">108,373</td>
<td align="right">11.40%</td>
</tr>
<tr>
<td align="center">5</td>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/linux-market-share" target="_blank" rel="noopener">Linux</a></td>
<td align="right">24,563</td>
<td align="right">2.58%</td>
</tr>
<tr>
<td align="center">6</td>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/windows-server-market-share" target="_blank" rel="noopener">Windows Server</a></td>
<td align="right">23,872</td>
<td align="right">2.51%</td>
</tr>
<tr>
<td align="center">7</td>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/gentoo-market-share" target="_blank" rel="noopener">Gentoo</a></td>
<td align="right">16,756</td>
<td align="right">1.76%</td>
</tr>
<tr>
<td align="center">8</td>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/red-hat-enterprise-linux-market-share" target="_blank" rel="noopener">Red Hat Enterprise Linux</a></td>
<td align="right">13,659</td>
<td align="right">1.44%</td>
</tr>
<tr>
<td align="center">9</td>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/windows-7-market-share" target="_blank" rel="noopener">Windows 7</a></td>
<td align="right">11,843</td>
<td align="right">1.25%</td>
</tr>
<tr>
<td align="center">10</td>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/microsoft-windows-os-market-share" target="_blank" rel="noopener">Microsoft Windows OS</a></td>
<td align="right">10,986</td>
<td align="right">1.16%</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="left">op Competitors</th>
<th align="right">Websites</th>
<th align="right">Market Share</th>
<th align="right">Versus Page</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/ubuntu-market-share" target="_blank" rel="noopener">Ubuntu</a></td>
<td align="right">278,611</td>
<td align="right">29.30%</td>
<td align="right"><a href="https://www.datanyze.com/market-share/operating-systems--443/linux-vs-ubuntu" target="_blank" rel="noopener">Linux vs. Ubuntu</a></td>
</tr>
<tr>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/unix-market-share" target="_blank" rel="noopener">Unix</a></td>
<td align="right">192,215</td>
<td align="right">20.21%</td>
<td align="right"><a href="https://www.datanyze.com/market-share/operating-systems--443/linux-vs-unix" target="_blank" rel="noopener">Linux vs. Unix</a></td>
</tr>
<tr>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/centos-market-share" target="_blank" rel="noopener">CentOS</a></td>
<td align="right">165,640</td>
<td align="right">17.42%</td>
<td align="right"><a href="https://www.datanyze.com/market-share/operating-systems--443/linux-vs-centos" target="_blank" rel="noopener">Linux vs. CentOS</a></td>
</tr>
<tr>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/debian-market-share" target="_blank" rel="noopener">Debian</a></td>
<td align="right">108,373</td>
<td align="right">11.40%</td>
<td align="right"><a href="https://www.datanyze.com/market-share/operating-systems--443/linux-vs-debian" target="_blank" rel="noopener">Linux vs. Debian</a></td>
</tr>
<tr>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/windows-server-market-share" target="_blank" rel="noopener">Windows Server</a></td>
<td align="right">23,872</td>
<td align="right">2.51%</td>
<td align="right"><a href="https://www.datanyze.com/market-share/operating-systems--443/linux-vs-windows-server" target="_blank" rel="noopener">Linux vs. Windows Server</a></td>
</tr>
<tr>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/gentoo-market-share" target="_blank" rel="noopener">Gentoo</a></td>
<td align="right">16,756</td>
<td align="right">1.76%</td>
<td align="right"><a href="https://www.datanyze.com/market-share/operating-systems--443/linux-vs-gentoo" target="_blank" rel="noopener">Linux vs. Gentoo</a></td>
</tr>
<tr>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/red-hat-enterprise-linux-market-share" target="_blank" rel="noopener">Red Hat Enterprise Linux</a></td>
<td align="right">13,659</td>
<td align="right">1.44%</td>
<td align="right"><a href="https://www.datanyze.com/market-share/operating-systems--443/linux-vs-red-hat-enterprise-linux" target="_blank" rel="noopener">Linux vs. Red Hat Enterprise Linux</a></td>
</tr>
<tr>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/windows-7-market-share" target="_blank" rel="noopener">Windows 7</a></td>
<td align="right">11,843</td>
<td align="right">1.25%</td>
<td align="right"><a href="https://www.datanyze.com/market-share/operating-systems--443/linux-vs-windows-7" target="_blank" rel="noopener">Linux vs. Windows 7</a></td>
</tr>
<tr>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/microsoft-windows-os-market-share" target="_blank" rel="noopener">Microsoft Windows OS</a></td>
<td align="right">10,986</td>
<td align="right">1.16%</td>
<td align="right"><a href="https://www.datanyze.com/market-share/operating-systems--443/linux-vs-microsoft-windows-os" target="_blank" rel="noopener">Linux vs. Microsoft Windows OS</a></td>
</tr>
<tr>
<td align="left"><a href="https://www.datanyze.com/market-share/operating-systems--443/freebsd-market-share" target="_blank" rel="noopener">FreeBSD</a></td>
<td align="right">9,633</td>
<td align="right">1.01%</td>
<td align="right"><a href="https://www.datanyze.com/market-share/operating-systems--443/linux-vs-freebsd" target="_blank" rel="noopener">Linux vs. FreeBSD</a></td>
</tr>
</tbody></table>
<h4 id="RedHat-CentOS"><a href="#RedHat-CentOS" class="headerlink" title="RedHat/CentOS"></a>RedHat/CentOS</h4><h4 id="Debian-Ubuntu"><a href="#Debian-Ubuntu" class="headerlink" title="Debian/Ubuntu"></a>Debian/Ubuntu</h4><p>咱的 VPS 清一色 Ubuntu 1804 ，主要是省事儿。</p>
<h2 id="命令行工具"><a href="#命令行工具" class="headerlink" title="命令行工具"></a>命令行工具</h2><h3 id="文本处理"><a href="#文本处理" class="headerlink" title="文本处理"></a>文本处理</h3><p>提到 Linux 上的文本处理工具当然是离不开三剑客（awk、grep、sed），这也是咱当初跟着《鸟哥 Linux 私房菜》学来的😂。</p>
<h4 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h4><h4 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h4><h4 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h4><h4 id="jq"><a href="#jq" class="headerlink" title="jq"></a>jq</h4><h4 id="tr"><a href="#tr" class="headerlink" title="tr"></a>tr</h4><h4 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h4><h4 id="wc"><a href="#wc" class="headerlink" title="wc"></a>wc</h4><h4 id="join"><a href="#join" class="headerlink" title="join"></a>join</h4><h4 id="cut"><a href="#cut" class="headerlink" title="cut"></a>cut</h4><h3 id="系统信息"><a href="#系统信息" class="headerlink" title="系统信息"></a>系统信息</h3><h4 id="htop"><a href="#htop" class="headerlink" title="htop"></a>htop</h4><p>top 黑乎乎的颜值太低了，咱还是喜欢花花绿绿的 htop （大雾</p>
<ul>
<li>install</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> RHEL/CentOS</span></span><br><span class="line">yum install htop</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Debian/Ubuntu</span></span><br><span class="line">apt install htop</span><br></pre></td></tr></table></figure>
<p><img src="https://p.k8s.li/20200506142544440.png" alt=""></p>
<h3 id="bashtop"><a href="#bashtop" class="headerlink" title="bashtop"></a><a href="https://github.com/aristocratos/bashtop" target="_blank" rel="noopener">bashtop</a></h3><p>bashtop 相比于 htop 有种吊炸天的感觉，炫酷无比😄</p>
<ul>
<li>install</li>
</ul>
<p>安装起来很简单，其实这是一个 shell 可执行文件，直接使用 curl 或者 wget 命令下载到本地并赋予 +x 权限即可。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://raw.githubusercontent.com/aristocratos/bashtop/master/bashtop -o /usr/bin/bashtop &amp;&amp; chmod +x /usr/bin/bashtop</span><br></pre></td></tr></table></figure>
<p>国内用户推荐使用 jsdelivr.net 的 CDN 来下载该脚本😑，（fuck GFW by jsdelivr😡</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://cdn.jsdelivr.net/gh/aristocratos/bashtop/bashtop  -o /usr/bin/bashtop ;chmod +x /usr/bin/bashtop</span><br></pre></td></tr></table></figure>
<p><img src="https://p.k8s.li/20200506151706148.png" alt=""></p>
<h4 id="pstree"><a href="#pstree" class="headerlink" title="pstree"></a>pstree</h4><p>以树状图的方式展现进程之间的派生关系，显示效果比 ps 更直观一些，可以很清楚地分辨出子进程和父进程之间的关系。可以用来排查一些孤儿进程。</p>
<ul>
<li>install</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> RHEL/CentOS</span></span><br><span class="line">yum install psmisc</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Debian/Ubuntu</span></span><br><span class="line">apt install psmisc</span><br></pre></td></tr></table></figure>
<ul>
<li>output example</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">╭─root@k8s-node-3 /proc</span><br><span class="line">╰─# pstree</span><br><span class="line">systemd─┬─agetty</span><br><span class="line">        ├─auditd───&#123;auditd&#125;</span><br><span class="line">        ├─containerd─┬─6*[containerd-shim─┬─pause]</span><br><span class="line">        │            │                    └─9*[&#123;containerd-shim&#125;]]</span><br><span class="line">        │            ├─containerd-shim─┬─kube-proxy───12*[&#123;kube-proxy&#125;]</span><br><span class="line">        │            │                 └─9*[&#123;containerd-shim&#125;]</span><br><span class="line">        │            ├─4*[containerd-shim─┬─pause]</span><br><span class="line">        │            │                    └─10*[&#123;containerd-shim&#125;]]</span><br><span class="line">        │            ├─containerd-shim─┬─lvscare───11*[&#123;lvscare&#125;]</span><br><span class="line">        │            │                 └─10*[&#123;containerd-shim&#125;]</span><br><span class="line">        │            ├─containerd-shim─┬─agent───10*[&#123;agent&#125;]</span><br><span class="line">        │            │                 └─10*[&#123;containerd-shim&#125;]</span><br><span class="line">        │            ├─containerd-shim─┬─runsvdir─┬─runsv───bird6</span><br><span class="line">        │            │                 │          ├─runsv───calico-node───18*[&#123;calico-node&#125;]</span><br><span class="line">        │            │                 │          ├─runsv───calico-node───15*[&#123;calico-node&#125;]</span><br><span class="line">        │            │                 │          └─runsv───bird</span><br><span class="line">        │            │                 └─12*[&#123;containerd-shim&#125;]</span><br><span class="line">        │            ├─containerd-shim─┬─node_exporter───4*[&#123;node_exporter&#125;]</span><br><span class="line">        │            │                 └─10*[&#123;containerd-shim&#125;]</span><br><span class="line">        │            ├─containerd-shim─┬─nginx-proxy─┬─confd───11*[&#123;confd&#125;]</span><br><span class="line">        │            │                 │             └─nginx───nginx</span><br><span class="line">        │            │                 └─9*[&#123;containerd-shim&#125;]</span><br><span class="line">        │            ├─containerd-shim─┬─deploy.sh───sleep</span><br><span class="line">        │            │                 └─10*[&#123;containerd-shim&#125;]</span><br><span class="line">        │            ├─containerd-shim─┬─nginx-ingress─┬─nginx───4*[nginx]</span><br><span class="line">        │            │                 │               └─14*[&#123;nginx-ingress&#125;]</span><br><span class="line">        │            │                 └─10*[&#123;containerd-shim&#125;]</span><br><span class="line">        │            ├─containerd-shim─┬─configmap-reloa───4*[&#123;configmap-reloa&#125;]</span><br><span class="line">        │            │                 └─9*[&#123;containerd-shim&#125;]</span><br><span class="line">        │            ├─containerd-shim─┬─bash</span><br><span class="line">        │            │                 └─9*[&#123;containerd-shim&#125;]</span><br><span class="line">        │            ├─containerd-shim─┬─ruby2.3─┬─ruby2.3───4*[&#123;ruby2.3&#125;]</span><br><span class="line">        │            │                 │         └─11*[&#123;ruby2.3&#125;]</span><br><span class="line">        │            │                 └─10*[&#123;containerd-shim&#125;]</span><br><span class="line">        │            └─46*[&#123;containerd&#125;]</span><br><span class="line">        ├─crond</span><br><span class="line">        ├─dbus-daemon───&#123;dbus-daemon&#125;</span><br><span class="line">        ├─dockerd───25*[&#123;dockerd&#125;]</span><br><span class="line">        ├─gssproxy───5*[&#123;gssproxy&#125;]</span><br><span class="line">        ├─irqbalance</span><br><span class="line">        ├─kubelet───26*[&#123;kubelet&#125;]</span><br><span class="line">        ├─lvmetad</span><br><span class="line">        ├─polkitd───6*[&#123;polkitd&#125;]</span><br><span class="line">        ├─rpc.idmapd</span><br><span class="line">        ├─rpc.mountd</span><br><span class="line">        ├─rpc.statd</span><br><span class="line">        ├─rpcbind</span><br><span class="line">        ├─rsyslogd───2*[&#123;rsyslogd&#125;]</span><br><span class="line">        ├─sshd───sshd───zsh───pstree</span><br><span class="line">        ├─systemd-journal</span><br><span class="line">        ├─systemd-logind</span><br><span class="line">        ├─systemd-udevd</span><br><span class="line">        └─tuned───4*[&#123;tuned&#125;]</span><br></pre></td></tr></table></figure>
<ul>
<li><p>可以看到 init 进程 systemd 为系统的 PID 1 号进程，所有的进程都在 systemd 的管理之下。</p>
</li>
<li><p>在运行 docker 的服务器上，容器进程的父进程并不是 dockerd 这个守护进程，而是一个名为　<code>containerd-shim-${container_name}</code>　而 containerd-shim 的父进程为容器运行时 <a href="https://containerd.io/" target="_blank" rel="noopener">containerd</a>，docker 是通过 gRPC 协议与 containerd 进程通信来，以此来进行管理所运行的容器。关于容器运行时的关系可以参考 <a href="https://xuanwo.io/2019/08/06/oci-intro/" target="_blank" rel="noopener">开放容器标准(OCI) 内部分享</a>，当时理解 dockerd 、containerd、containerd-shim 这些关系时感觉有点绕，不过用 pstree 命令看一下进程树结构就一目了然了😂，对理解进程之间的关系很有帮助。</p>
</li>
</ul>
<h4 id="ncdu"><a href="#ncdu" class="headerlink" title="ncdu"></a>ncdu</h4><p>面试的时候被问道过 <code>Linux 下如何查看文件见大小？</code>，当然是 <code>du -sh</code> 啦😂。不过咱还是喜欢用 ncdu</p>
<p>使用 <code>ncdu</code> 的好处就是可以通过交互式的方式查看目录占用空间的大小，要比 <code>du -sh</code> 命令方便很多，不过缺点也有，就是该命令为扫描目标目录下的所有文件，很耗时！如果想要立即查看一下目录占用的大小，还是用 <code>du -sh</code> 最方便，使用 ncdu 可以帮助我们分析文件夹下各个文件占用的情况。</p>
<ul>
<li>install</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> RHEL/CentOS</span></span><br><span class="line">yum install ncdu</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Debian/Ubuntu</span></span><br><span class="line">apt install ncdu</span><br></pre></td></tr></table></figure>
<ul>
<li>output example</li>
</ul>
<p>使用反向键和回车键进行目录奇幻，很方便的说😂</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">ncdu 1.13 ~ Use the arrow keys to navigate, press ? for help</span><br><span class="line">--- / ------------</span><br><span class="line">    5.2 GiB [##########] /var</span><br><span class="line">    2.2 GiB [####      ] /opt</span><br><span class="line">    2.0 GiB [###       ] /usr</span><br><span class="line">  363.6 MiB [          ] /root</span><br><span class="line">	45.8 MiB [          ] /boot</span><br><span class="line">	45.2 MiB [          ] /run</span><br><span class="line">	 4.6 MiB [          ] /etc</span><br><span class="line">	44.0 KiB [          ] /tmp</span><br><span class="line">	24.0 KiB [          ] /home</span><br><span class="line">e  16.0 KiB [          ] /lost+found</span><br><span class="line">	 8.0 KiB [          ] /media</span><br><span class="line">e   4.0 KiB [          ] /srv</span><br><span class="line">e   4.0 KiB [          ] /mnt</span><br><span class="line">.   0.0   B [          ] /proc</span><br><span class="line">	 0.0   B [          ] /sys</span><br><span class="line">	 0.0   B [          ] /dev</span><br><span class="line">@   0.0   B [          ]  initrd.img.old</span><br><span class="line">@   0.0   B [          ]  initrd.img</span><br><span class="line">@   0.0   B [          ]  vmlinuz.old</span><br><span class="line">@   0.0   B [          ]  vmlinuz</span><br><span class="line">@   0.0   B [          ]  libx32</span><br><span class="line">@   0.0   B [          ]  lib64</span><br><span class="line">@   0.0   B [          ]  lib32</span><br><span class="line">@   0.0   B [          ]  sbin</span><br><span class="line"></span><br><span class="line">ncdu 1.13 ~ Use the arrow keys to navigate, press ? for help</span><br><span class="line">--- /var --------------</span><br><span class="line">	 3.5 GiB [##########] /lib</span><br><span class="line">	 1.4 GiB [####      ] /opt</span><br><span class="line">  156.9 MiB [          ] /cache</span><br><span class="line">	79.6 MiB [          ] /log</span><br><span class="line">	 1.8 MiB [          ] /backups</span><br><span class="line">	20.0 KiB [          ] /tmp</span><br><span class="line">	16.0 KiB [          ] /spool</span><br><span class="line">e   4.0 KiB [          ] /mail</span><br><span class="line">e   4.0 KiB [          ] /local</span><br><span class="line">@   0.0   B [          ]  lock</span><br><span class="line">@   0.0   B [          ]  run</span><br></pre></td></tr></table></figure>
<ul>
<li>G/GB</li>
</ul>
<blockquote>
<p>The SIZE argument is an integer and optional unit (example: 10K is 10*1024). Units are K,M,G,T,P,E,Z,Y (powers of 1024) or KB,MB,… (powers of 1000).</p>
</blockquote>
<h4 id="nload"><a href="#nload" class="headerlink" title="nload"></a>nload</h4><p>nload 命令是一个实时监控网络流量和带宽使用的控制台应用程序，使用两个图表可视化地展示接收和发送的流量，并提供诸如数据交换总量、最小/最大网络带宽使用量等附加信息。</p>
<ul>
<li>install</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> RHEL/CentOS</span></span><br><span class="line">yum install nload</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Debian/Ubuntu</span></span><br><span class="line">apt install nload</span><br></pre></td></tr></table></figure>
<ul>
<li>output example</li>
</ul>
<p>按下回车键可以切换不同的网卡</p>
<p><img src="https://p.k8s.li/20200506143310955.png" alt=""></p>
<h3 id="ls-兄弟们"><a href="#ls-兄弟们" class="headerlink" title="ls 兄弟们"></a>ls 兄弟们</h3><p>以 ls 开头的命令大多都是列出 XX 信息，这些工具也可以方便我们快速了解一下目前系统的状态。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">╭─root@gitlab /opt</span><br><span class="line">╰─<span class="comment"># ls</span></span><br><span class="line">ls           lsblk        LS_COLORS    lsinitramfs  lslogins     lsns         lspgpot</span><br><span class="line">lsa          lsb_release  lscpu        lsipc        lsmem        lsof</span><br><span class="line">lsattr       LSCOLORS     lshw         lslocks      lsmod        lspci</span><br></pre></td></tr></table></figure>
<h4 id="ls"><a href="#ls" class="headerlink" title="ls"></a>ls</h4><blockquote>
<p>ls - list directory contents 列出文件夹内容</p>
</blockquote>
<h4 id="lsattr"><a href="#lsattr" class="headerlink" title="lsattr"></a>lsattr</h4><blockquote>
<p>lsattr - list file attributes on a Linux second extended file system</p>
</blockquote>
<p>列出文件的属性，</p>
<h4 id="lsblk"><a href="#lsblk" class="headerlink" title="lsblk"></a>lsblk</h4><blockquote>
<p>lsblk - list block devices 列出块设备</p>
</blockquote>
<p>这个命令在查看块设备（磁盘) 分区和挂载点，以及磁盘尚未分配的空间信息很有帮助，要比 fdisk 更直观一些。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">╭─root@gitlab /opt</span><br><span class="line">╰─<span class="comment"># lsblk</span></span><br><span class="line">NAME                      MAJ:MIN RM SIZE RO TYPE MOUNTPOINT</span><br><span class="line">sda                         8:0    0  30G  0 disk</span><br><span class="line">├─sda1                      8:1    0   1M  0 part</span><br><span class="line">├─sda2                      8:2    0   1G  0 part /boot</span><br><span class="line">└─sda3                      8:3    0  29G  0 part</span><br><span class="line">  └─ubuntu--vg-ubuntu--lv 253:0    0  28G  0 lvm  /</span><br></pre></td></tr></table></figure>
<h4 id="lsb-release"><a href="#lsb-release" class="headerlink" title="lsb_release"></a>lsb_release</h4><blockquote>
<p>lsb_release - print distribution-specific information 打印发行版详情</p>
</blockquote>
<p>有些发行版尚未安装</p>
<h4 id="lscpu"><a href="#lscpu" class="headerlink" title="lscpu"></a>lscpu</h4><blockquote>
<p>lscpu - display information about the CPU architecture</p>
</blockquote>
<p>列出 CPU 的信息，和 cat /proc/cpuinfo 输出结果类似。相当于 Linux 下的 CPU-Z 😂</p>
<ul>
<li>output example</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">╭─root@gitlab</span> <span class="string">/opt</span></span><br><span class="line"><span class="string">╰─#</span> <span class="string">lscpu</span></span><br><span class="line"><span class="attr">Architecture:</span>        <span class="string">x86_64</span></span><br><span class="line"><span class="string">CPU</span> <span class="string">op-mode(s):</span>      <span class="number">32</span><span class="string">-bit,</span> <span class="number">64</span><span class="string">-bit</span></span><br><span class="line"><span class="attr">Byte Order:</span>          <span class="string">Little</span> <span class="string">Endian</span></span><br><span class="line"><span class="string">CPU(s):</span>              <span class="number">4</span></span><br><span class="line"><span class="string">On-line</span> <span class="string">CPU(s)</span> <span class="attr">list:</span> <span class="number">0</span><span class="number">-3</span></span><br><span class="line"><span class="string">Thread(s)</span> <span class="attr">per core:</span>  <span class="number">1</span></span><br><span class="line"><span class="string">Core(s)</span> <span class="attr">per socket:</span>  <span class="number">1</span></span><br><span class="line"><span class="string">Socket(s):</span>           <span class="number">4</span></span><br><span class="line"><span class="string">NUMA</span> <span class="string">node(s):</span>        <span class="number">1</span></span><br><span class="line"><span class="attr">Vendor ID:</span>           <span class="string">GenuineIntel</span></span><br><span class="line"><span class="attr">CPU family:</span>          <span class="number">6</span></span><br><span class="line"><span class="attr">Model:</span>               <span class="number">60</span></span><br><span class="line"><span class="attr">Model name:</span>          <span class="string">Intel(R)</span> <span class="string">Xeon(R)</span> <span class="string">CPU</span> <span class="string">E3-1271</span> <span class="string">v3</span> <span class="string">@</span> <span class="number">3.</span><span class="string">60GHz</span></span><br><span class="line"><span class="attr">Stepping:</span>            <span class="number">3</span></span><br><span class="line"><span class="attr">CPU MHz:</span>             <span class="number">3591.683</span></span><br><span class="line"><span class="attr">BogoMIPS:</span>            <span class="number">7183.36</span></span><br><span class="line"><span class="attr">Hypervisor vendor:</span>   <span class="string">VMware</span></span><br><span class="line"><span class="attr">Virtualization type:</span> <span class="string">full</span></span><br><span class="line"><span class="attr">L1d cache:</span>           <span class="string">32K</span></span><br><span class="line"><span class="attr">L1i cache:</span>           <span class="string">32K</span></span><br><span class="line"><span class="attr">L2 cache:</span>            <span class="string">256K</span></span><br><span class="line"><span class="attr">L3 cache:</span>            <span class="string">8192K</span></span><br><span class="line"><span class="string">NUMA</span> <span class="string">node0</span> <span class="string">CPU(s):</span>   <span class="number">0</span><span class="number">-3</span></span><br><span class="line"><span class="attr">Flags:</span>               <span class="string">fpu</span> <span class="string">vme</span> <span class="string">de</span> <span class="string">pse</span> <span class="string">tsc</span> <span class="string">msr</span> <span class="string">pae</span> <span class="string">mce</span> <span class="string">cx8</span> <span class="string">apic</span> <span class="string">sep</span> <span class="string">mtrr</span> <span class="string">pge</span> <span class="string">mca</span> <span class="string">cmov</span> <span class="string">pat</span> <span class="string">pse36</span> <span class="string">clflush</span> <span class="string">dts</span> <span class="string">mmx</span> <span class="string">fxsr</span> <span class="string">sse</span> <span class="string">sse2</span> <span class="string">ss</span> <span class="string">syscall</span> <span class="string">nx</span> <span class="string">pdpe1gb</span> <span class="string">rdtscp</span> <span class="string">lm</span> <span class="string">constant_tsc</span> <span class="string">arch_perfmon</span> <span class="string">pebs</span> <span class="string">bts</span> <span class="string">nopl</span> <span class="string">xtopology</span> <span class="string">tsc_reliable</span> <span class="string">nonstop_tsc</span> <span class="string">cpuid</span> <span class="string">aperfmperf</span> <span class="string">pni</span> <span class="string">pclmulqdq</span> <span class="string">ssse3</span> <span class="string">fma</span> <span class="string">cx16</span> <span class="string">pcid</span> <span class="string">sse4_1</span> <span class="string">sse4_2</span> <span class="string">x2apic</span> <span class="string">movbe</span> <span class="string">popcnt</span> <span class="string">tsc_deadline_timer</span> <span class="string">aes</span> <span class="string">xsave</span> <span class="string">avx</span> <span class="string">f16c</span> <span class="string">rdrand</span> <span class="string">hypervisor</span> <span class="string">lahf_lm</span> <span class="string">abm</span> <span class="string">cpuid_fault</span> <span class="string">epb</span> <span class="string">invpcid_single</span> <span class="string">pti</span> <span class="string">fsgsbase</span> <span class="string">tsc_adjust</span> <span class="string">bmi1</span> <span class="string">avx2</span> <span class="string">smep</span> <span class="string">bmi2</span> <span class="string">invpcid</span> <span class="string">xsaveopt</span> <span class="string">dtherm</span> <span class="string">ida</span> <span class="string">arat</span> <span class="string">pln</span> <span class="string">pts</span></span><br></pre></td></tr></table></figure>
<p><code>cat /proc/cpuinfo</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">╭─root@gitlab</span> <span class="string">/opt</span></span><br><span class="line"><span class="string">╰─#</span> <span class="string">cat</span> <span class="string">/proc/cpuinfo</span></span><br><span class="line"><span class="attr">processor       :</span> <span class="number">0</span></span><br><span class="line"><span class="attr">vendor_id       :</span> <span class="string">GenuineIntel</span></span><br><span class="line"><span class="attr">cpu family      :</span> <span class="number">6</span></span><br><span class="line"><span class="attr">model           :</span> <span class="number">60</span></span><br><span class="line"><span class="attr">model name      :</span> <span class="string">Intel(R)</span> <span class="string">Xeon(R)</span> <span class="string">CPU</span> <span class="string">E3-1271</span> <span class="string">v3</span> <span class="string">@</span> <span class="number">3.</span><span class="string">60GHz</span></span><br><span class="line"><span class="attr">stepping        :</span> <span class="number">3</span></span><br><span class="line"><span class="attr">microcode       :</span> <span class="number">0x1c</span></span><br><span class="line"><span class="attr">cpu MHz         :</span> <span class="number">3591.683</span></span><br><span class="line"><span class="attr">cache size      :</span> <span class="number">8192</span> <span class="string">KB</span></span><br><span class="line"><span class="attr">physical id     :</span> <span class="number">0</span></span><br><span class="line"><span class="attr">siblings        :</span> <span class="number">1</span></span><br><span class="line"><span class="attr">core id         :</span> <span class="number">0</span></span><br><span class="line"><span class="attr">cpu cores       :</span> <span class="number">1</span></span><br><span class="line"><span class="attr">apicid          :</span> <span class="number">0</span></span><br><span class="line"><span class="attr">initial apicid  :</span> <span class="number">0</span></span><br><span class="line"><span class="attr">fpu             :</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">fpu_exception   :</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">cpuid level     :</span> <span class="number">13</span></span><br><span class="line"><span class="attr">wp              :</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">flags           :</span> <span class="string">fpu</span> <span class="string">vme</span> <span class="string">de</span> <span class="string">pse</span> <span class="string">tsc</span> <span class="string">msr</span> <span class="string">pae</span> <span class="string">mce</span> <span class="string">cx8</span> <span class="string">apic</span> <span class="string">sep</span> <span class="string">mtrr</span> <span class="string">pge</span> <span class="string">mca</span> <span class="string">cmov</span> <span class="string">pat</span> <span class="string">pse36</span> <span class="string">clflush</span> <span class="string">dts</span> <span class="string">mmx</span> <span class="string">fxsr</span> <span class="string">sse</span> <span class="string">sse2</span> <span class="string">ss</span> <span class="string">syscall</span> <span class="string">nx</span> <span class="string">pdpe1gb</span> <span class="string">rdtscp</span> <span class="string">lm</span> <span class="string">constant_tsc</span> <span class="string">arch_perfmon</span> <span class="string">pebs</span> <span class="string">bts</span> <span class="string">nopl</span> <span class="string">xtopology</span> <span class="string">tsc_reliable</span> <span class="string">nonstop_tsc</span> <span class="string">cpuid</span> <span class="string">aperfmperf</span> <span class="string">pni</span> <span class="string">pclmulqdq</span> <span class="string">ssse3</span> <span class="string">fma</span> <span class="string">cx16</span> <span class="string">pcid</span> <span class="string">sse4_1</span> <span class="string">sse4_2</span> <span class="string">x2apic</span> <span class="string">movbe</span> <span class="string">popcnt</span> <span class="string">tsc_deadline_timer</span> <span class="string">aes</span> <span class="string">xsave</span> <span class="string">avx</span> <span class="string">f16c</span> <span class="string">rdrand</span> <span class="string">hypervisor</span> <span class="string">lahf_lm</span> <span class="string">abm</span> <span class="string">cpuid_fault</span> <span class="string">epb</span> <span class="string">invpcid_single</span> <span class="string">pti</span> <span class="string">fsgsbase</span> <span class="string">tsc_adjust</span> <span class="string">bmi1</span> <span class="string">avx2</span> <span class="string">smep</span> <span class="string">bmi2</span> <span class="string">invpcid</span> <span class="string">xsaveopt</span> <span class="string">dtherm</span> <span class="string">ida</span> <span class="string">arat</span> <span class="string">pln</span> <span class="string">pts</span></span><br><span class="line"><span class="attr">bugs            :</span> <span class="string">cpu_meltdown</span> <span class="string">spectre_v1</span> <span class="string">spectre_v2</span> <span class="string">spec_store_bypass</span> <span class="string">l1tf</span> <span class="string">mds</span> <span class="string">swapgs</span></span><br><span class="line"><span class="attr">bogomips        :</span> <span class="number">7183.36</span></span><br><span class="line"><span class="attr">clflush size    :</span> <span class="number">64</span></span><br><span class="line"><span class="attr">cache_alignment :</span> <span class="number">64</span></span><br><span class="line"><span class="attr">address sizes   :</span> <span class="number">42</span> <span class="string">bits</span> <span class="string">physical,</span> <span class="number">48</span> <span class="string">bits</span> <span class="string">virtual</span></span><br><span class="line"><span class="attr">power management:</span></span><br></pre></td></tr></table></figure>
<h4 id="lshw"><a href="#lshw" class="headerlink" title="lshw"></a>lshw</h4><blockquote>
<p>lshw - list hardware 列出硬件设备</p>
<p>lshw is a small tool to extract detailed information on the hardware configuration of the machine. It  can report exact memory configuration, firmware version, mainboard configuration, CPU version and speed, cache configuration, bus speed, etc. on DMI-capable x86 or IA-64 systems and on some PowerPC machines  (PowerMac G4 is known to work).It  currently  supports  DMI (x86 and IA-64 only), OpenFirmware device tree (PowerPC only), PCI/AGP, CPUID (x86), IDE/ATA/ATAPI, PCMCIA (only tested on x86), SCSI and USB.</p>
</blockquote>
<p>这个命令就相当于 Windows 下的设备管理器，列出系统里的硬件设备。</p>
<ul>
<li>install</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> RHEL/CentOS</span></span><br><span class="line">yum install lshw</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Debian/Ubuntu</span></span><br><span class="line">apt install lshw</span><br></pre></td></tr></table></figure>
<ul>
<li>output example</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line">╭─root@sg-02 /home/ubuntu</span><br><span class="line">╰─# lshw</span><br><span class="line">sg-02</span><br><span class="line">	 description: Computer</span><br><span class="line">	 product: HVM domU</span><br><span class="line">	 vendor: Xen</span><br><span class="line">	 version: 4.2.amazon</span><br><span class="line">	 serial: ec2c5773-d127-c5a4-60a3-221becf4e6ae</span><br><span class="line">	 width: 64 bits</span><br><span class="line">	 capabilities: smbios-2.7 dmi-2.7 vsyscall32</span><br><span class="line">	 configuration: boot=normal uuid=73572CEC-27D1-A4C5-60A3-221BECF4E6AE</span><br><span class="line">  *-core</span><br><span class="line">		 description: Motherboard</span><br><span class="line">		 physical id: 0</span><br><span class="line">	  *-firmware</span><br><span class="line">			 description: BIOS</span><br><span class="line">			 vendor: Xen</span><br><span class="line">			 physical id: 0</span><br><span class="line">			 version: 4.2.amazon</span><br><span class="line">			 date: 08/24/2006</span><br><span class="line">			 size: 96KiB</span><br><span class="line">			 capabilities: pci edd</span><br><span class="line">	  *-cpu</span><br><span class="line">			 description: CPU</span><br><span class="line">			 product: Intel(R) Xeon(R) CPU E5-2676 v3 @ 2.40GHz</span><br><span class="line">			 vendor: Intel Corp.</span><br><span class="line">			 physical id: 401</span><br><span class="line">			 bus info: cpu@0</span><br><span class="line">			 slot: CPU 1</span><br><span class="line">			 size: 2400MHz</span><br><span class="line">			 capacity: 2400MHz</span><br><span class="line">			 width: 64 bits</span><br><span class="line">			 capabilities: fpu fpu_exception wp vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx rdtscp x86-64 constant_tsc rep_good nopl xtopology cpuid pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm cpuid_fault invpcid_single pti fsgsbase bmi1 avx2 smep bmi2 erms invpcid xsaveopt</span><br><span class="line">	  *-memory</span><br><span class="line">			 description: System Memory</span><br><span class="line">			 physical id: 1000</span><br><span class="line">			 size: 1GiB</span><br><span class="line">			 capacity: 1GiB</span><br><span class="line">			 capabilities: ecc</span><br><span class="line">			 configuration: errordetection=multi-bit-ecc</span><br><span class="line">		  *-bank</span><br><span class="line">				 description: DIMM RAM</span><br><span class="line">				 physical id: 0</span><br><span class="line">				 slot: DIMM 0</span><br><span class="line">				 size: 1GiB</span><br><span class="line">				 width: 64 bits</span><br><span class="line">	  *-pci</span><br><span class="line">			 description: Host bridge</span><br><span class="line">			 product: 440FX - 82441FX PMC [Natoma]</span><br><span class="line">			 vendor: Intel Corporation</span><br><span class="line">			 physical id: 100</span><br><span class="line">			 bus info: pci@0000:00:00.0</span><br><span class="line">			 version: 02</span><br><span class="line">			 width: 32 bits</span><br><span class="line">			 clock: 33MHz</span><br><span class="line">		  *-isa</span><br><span class="line">				 description: ISA bridge</span><br><span class="line">				 product: 82371SB PIIX3 ISA [Natoma/Triton II]</span><br><span class="line">				 vendor: Intel Corporation</span><br><span class="line">				 physical id: 1</span><br><span class="line">				 bus info: pci@0000:00:01.0</span><br><span class="line">				 version: 00</span><br><span class="line">				 width: 32 bits</span><br><span class="line">				 clock: 33MHz</span><br><span class="line">				 capabilities: isa bus_master</span><br><span class="line">				 configuration: latency=0</span><br><span class="line">		  *-ide</span><br><span class="line">				 description: IDE interface</span><br><span class="line">				 product: 82371SB PIIX3 IDE [Natoma/Triton II]</span><br><span class="line">				 vendor: Intel Corporation</span><br><span class="line">				 physical id: 1.1</span><br><span class="line">				 bus info: pci@0000:00:01.1</span><br><span class="line">				 version: 00</span><br><span class="line">				 width: 32 bits</span><br><span class="line">				 clock: 33MHz</span><br><span class="line">				 capabilities: ide bus_master</span><br><span class="line">				 configuration: driver=ata_piix latency=64</span><br><span class="line">				 resources: irq:0 ioport:1f0(size=8) ioport:3f6 ioport:170(size=8) ioport:376 ioport:c100(size=16)</span><br><span class="line">		  *-bridge UNCLAIMED</span><br><span class="line">				 description: Bridge</span><br><span class="line">				 product: 82371AB/EB/MB PIIX4 ACPI</span><br><span class="line">				 vendor: Intel Corporation</span><br><span class="line">				 physical id: 1.3</span><br><span class="line">				 bus info: pci@0000:00:01.3</span><br><span class="line">				 version: 01</span><br><span class="line">				 width: 32 bits</span><br><span class="line">				 clock: 33MHz</span><br><span class="line">				 capabilities: bridge bus_master</span><br><span class="line">				 configuration: latency=0</span><br><span class="line">		  *-display UNCLAIMED</span><br><span class="line">				 description: VGA compatible controller</span><br><span class="line">				 product: GD 5446</span><br><span class="line">				 vendor: Cirrus Logic</span><br><span class="line">				 physical id: 2</span><br><span class="line">				 bus info: pci@0000:00:02.0</span><br><span class="line">				 version: 00</span><br><span class="line">				 width: 32 bits</span><br><span class="line">				 clock: 33MHz</span><br><span class="line">				 capabilities: vga_controller bus_master</span><br><span class="line">				 configuration: latency=0</span><br><span class="line">				 resources: memory:f0000000-f1ffffff memory:f3000000-f3000fff memory:c0000-dffff</span><br><span class="line">		  *-generic</span><br><span class="line">				 description: Unassigned class</span><br><span class="line">				 product: Xen Platform Device</span><br><span class="line">				 vendor: XenSource, Inc.</span><br><span class="line">				 physical id: 3</span><br><span class="line">				 bus info: pci@0000:00:03.0</span><br><span class="line">				 version: 01</span><br><span class="line">				 width: 32 bits</span><br><span class="line">				 clock: 33MHz</span><br><span class="line">				 capabilities: bus_master</span><br><span class="line">				 configuration: driver=xen-platform-pci latency=0</span><br><span class="line">				 resources: irq:28 ioport:c000(size=256) memory:f2000000-f2ffffff</span><br><span class="line">  *-network:0</span><br><span class="line">		 description: Ethernet interface</span><br><span class="line">		 physical id: 1</span><br><span class="line">		 logical name: eth0</span><br><span class="line">		 serial: 02:24:d2:49:f2:94</span><br><span class="line">		 capabilities: ethernet physical</span><br><span class="line">		 configuration: broadcast=yes driver=vif ip=172.26.17.53 link=yes multicast=yes</span><br><span class="line">  *-network:1</span><br><span class="line">		 description: Ethernet interface</span><br><span class="line">		 physical id: 2</span><br><span class="line">		 logical name: docker0</span><br><span class="line">		 serial: 02:42:37:cf:cf:aa</span><br><span class="line">		 capabilities: ethernet physical</span><br><span class="line">		 configuration: broadcast=yes driver=bridge driverversion=2.3 firmware=N/A ip=172.17.0.1 link=no multicast=yes</span><br><span class="line">╭─root@sg-02 /home/ubuntu</span><br><span class="line">╰─#</span><br></pre></td></tr></table></figure>
<h4 id="lsinitramfs"><a href="#lsinitramfs" class="headerlink" title="lsinitramfs"></a>lsinitramfs</h4><blockquote>
<p>lsinitramfs - list content of an initramfs image</p>
<p>The  lsinitramfs  command  lists the content of given initramfs images. It allows one to quickly check the content of one (or multiple) specified initramfs files.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">╭─root@gitlab /opt</span><br><span class="line">╰─<span class="comment"># lsinitramfs /boot/initrd.img-4.15.0-58-generic | head -n 10</span></span><br><span class="line">.</span><br><span class="line">usr</span><br><span class="line">usr/share</span><br><span class="line">usr/share/plymouth</span><br><span class="line">usr/share/plymouth/themes</span><br><span class="line">usr/share/plymouth/themes/details</span><br><span class="line">usr/share/plymouth/themes/details/details.plymouth</span><br><span class="line">usr/share/plymouth/themes/text.plymouth</span><br><span class="line">usr/share/plymouth/themes/ubuntu-text</span><br><span class="line">usr/share/plymouth/themes/ubuntu-text/ubuntu-text.plymouth.in</span><br></pre></td></tr></table></figure>
<h4 id="lsipc"><a href="#lsipc" class="headerlink" title="lsipc"></a>lsipc</h4><blockquote>
<p>lsipc - show information on IPC facilities currently employed in the system</p>
<p>lsipc  shows  information on the inter-process communication facilities for which the calling process has read access.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">╭─root@gitlab /opt</span><br><span class="line">╰─<span class="comment"># lsipc</span></span><br><span class="line">RESOURCE DESCRIPTION                                     LIMIT USED  USE%</span><br><span class="line">MSGMNI   Number of message queues                        32000    0 0.00%</span><br><span class="line">MSGMAX   Max size of message (bytes)                      8192    -     -</span><br><span class="line">MSGMNB   Default max size of queue (bytes)               16384    -     -</span><br><span class="line">SHMMNI   Shared memory segments                           4096    1 0.02%</span><br><span class="line">SHMALL   Shared memory pages                           4194304    0 0.00%</span><br><span class="line">SHMMAX   Max size of shared memory segment (bytes) 17179869184    -     -</span><br><span class="line">SHMMIN   Min size of shared memory segment (bytes)           1    -     -</span><br><span class="line">SEMMNI   Number of semaphore identifiers                   262    0 0.00%</span><br><span class="line">SEMMNS   Total number of semaphores                      32000    0 0.00%</span><br><span class="line">SEMMSL   Max semaphores per semaphore <span class="built_in">set</span>.                 250    -     -</span><br><span class="line">SEMOPM   Max number of operations per semop(2)              32    -     -</span><br><span class="line">SEMVMX   Semaphore max value                             32767    -     -</span><br></pre></td></tr></table></figure>
<h4 id="lslocks"><a href="#lslocks" class="headerlink" title="lslocks"></a>lslocks</h4><blockquote>
<p>lslocks - list local system locks</p>
<p>lslocks lists information about all the currently held file locks in a Linux system</p>
</blockquote>
<p>列出当前系统中被加锁的文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">╭─root@gitlab /opt</span><br><span class="line">╰─<span class="comment"># lslocks</span></span><br><span class="line">COMMAND           PID  TYPE SIZE MODE  M START END PATH</span><br><span class="line">cron              900 FLOCK   4B WRITE 0     0   0 /run/crond.pid</span><br><span class="line">svlogd          53065 FLOCK   0B WRITE 0     0   0 /var/<span class="built_in">log</span>/gitlab/redis/lock</span><br><span class="line">runsv           54095 FLOCK   0B WRITE 0     0   0 /opt/gitlab/sv/sidekiq/supervise/lock</span><br><span class="line">runsv           54095 FLOCK   0B WRITE 0     0   0 /opt/gitlab/sv/sidekiq/<span class="built_in">log</span>/supervise/lock</span><br></pre></td></tr></table></figure>
<h4 id="lslogins"><a href="#lslogins" class="headerlink" title="lslogins"></a>lslogins</h4><p>列出当前已经登录的用户信息</p>
<blockquote>
<p>lslogins - display information about known users in the system</p>
<p>Examine the wtmp and btmp logs, /etc/shadow (if necessary) and /etc/passwd and output the desired data. The default action is to list info about all the users in the system.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">╭─root@gitlab /opt</span><br><span class="line">╰─<span class="comment"># lslogins</span></span><br><span class="line">  UID USER              PROC PWD-LOCK PWD-DENY LAST-LOGIN GECOS</span><br><span class="line">	 0 root               211        0        0      06:58 root</span><br><span class="line">	 1 daemon               1        0        1            daemon</span><br><span class="line">	 2 bin                  0        0        1            bin</span><br><span class="line">	 3 sys                  0        0        1            sys</span><br><span class="line">	 4 sync                 0        0        1            sync</span><br><span class="line">	 5 games                0        0        1            games</span><br><span class="line">	 6 man                  0        0        1            man</span><br><span class="line">	 7 lp                   0        0        1            lp</span><br><span class="line">	 8 mail                 0        0        1            mail</span><br><span class="line">	 9 news                 0        0        1            news</span><br><span class="line">	10 uucp                 0        0        1            uucp</span><br><span class="line">	13 proxy                0        0        1            proxy</span><br><span class="line">	33 www-data             0        0        1            www-data</span><br><span class="line">	34 backup               0        0        1            backup</span><br><span class="line">	38 list                 0        0        1            Mailing List Manager</span><br><span class="line">	39 irc                  0        0        1            ircd</span><br><span class="line">	41 gnats                0        0        1            Gnats Bug-Reporting System (admin)</span><br><span class="line">  100 systemd-network      1        0        1            systemd Network Management,,,</span><br><span class="line">  101 systemd-resolve      1        0        1            systemd Resolver,,,</span><br><span class="line">  102 syslog               1        0        1</span><br><span class="line">  103 messagebus           1        0        1</span><br><span class="line">  104 _apt                 0        0        1</span><br><span class="line">  105 lxd                  0        0        1</span><br><span class="line">  106 uuidd                0        0        1</span><br><span class="line">  107 dnsmasq              0        0        1            dnsmasq,,,</span><br><span class="line">  108 landscape            0        0        1</span><br><span class="line">  109 pollinate            0        0        1</span><br><span class="line">  110 sshd                 0        0        1</span><br><span class="line">  995 gitlab-prometheus    4        0        1</span><br><span class="line">  996 gitlab-psql         18        0        1</span><br><span class="line">  997 gitlab-redis         2        0        1</span><br><span class="line">  998 git                 16        0        1</span><br><span class="line">  999 gitlab-www           5        0        1</span><br><span class="line"> 1000 ubuntu               0        0        0 2019-Aug28 ubuntu</span><br><span class="line">65534 nobody               0        0        1            nobody</span><br></pre></td></tr></table></figure>
<h4 id="lsmem"><a href="#lsmem" class="headerlink" title="lsmem"></a>lsmem</h4><blockquote>
<p>lsmem - list the ranges of available memory with their online status</p>
<p>The  lsmem command lists the ranges of available memory with their online status. The listed memory blocks correspond to the memory block representation in sysfs. The command also shows the memory block  size  and the amount of memory in online and offline state.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">╭─root@gitlab /opt</span><br><span class="line">╰─<span class="comment"># lsmem                                                                                                     127 ↵</span></span><br><span class="line">RANGE                                  SIZE  STATE REMOVABLE BLOCK</span><br><span class="line">0x0000000000000000-0x0000000007ffffff  128M online        no     0</span><br><span class="line">0x0000000008000000-0x000000000fffffff  128M online       yes     1</span><br><span class="line">0x0000000010000000-0x000000001fffffff  256M online        no   2-3</span><br><span class="line">0x0000000020000000-0x0000000027ffffff  128M online       yes     4</span><br><span class="line">0x0000000028000000-0x0000000037ffffff  256M online        no   5-6</span><br><span class="line">0x0000000038000000-0x000000003fffffff  128M online       yes     7</span><br><span class="line">0x0000000040000000-0x000000006fffffff  768M online        no  8-13</span><br><span class="line">0x0000000070000000-0x0000000077ffffff  128M online       yes    14</span><br><span class="line">0x0000000078000000-0x00000000bfffffff  1.1G online        no 15-23</span><br><span class="line">0x0000000100000000-0x000000013fffffff    1G online        no 32-39</span><br><span class="line"></span><br><span class="line">Memory block size:       128M</span><br><span class="line">Total online memory:       4G</span><br><span class="line">Total offline memory:      0B</span><br></pre></td></tr></table></figure>
<h4 id="lsmod"><a href="#lsmod" class="headerlink" title="lsmod"></a>lsmod</h4><p>列出系统内核模块</p>
<blockquote>
<p>lsmod - Show the status of modules in the Linux Kernel</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">╭─root@gitlab /opt</span><br><span class="line">╰─<span class="comment"># lsmod</span></span><br><span class="line">Module                  Size  Used by</span><br><span class="line">tcp_diag               16384  0</span><br><span class="line">inet_diag              24576  1 tcp_diag</span><br><span class="line">joydev                 24576  0</span><br><span class="line">input_leds             16384  0</span><br><span class="line">vmw_balloon            20480  0</span><br><span class="line">serio_raw              16384  0</span><br><span class="line">vmw_vsock_vmci_transport    28672  1</span><br><span class="line">vsock                  36864  2 vmw_vsock_vmci_transport</span><br><span class="line">vmw_vmci               69632  2 vmw_balloon,vmw_vsock_vmci_transport</span><br><span class="line">sch_fq_codel           20480  5</span><br><span class="line">ib_iser                49152  0</span><br><span class="line">rdma_cm                61440  1 ib_iser</span><br><span class="line">iw_cm                  45056  1 rdma_cm</span><br><span class="line">ib_cm                  53248  1 rdma_cm</span><br><span class="line">ib_core               225280  4 rdma_cm,iw_cm,ib_iser,ib_cm</span><br><span class="line">iscsi_tcp              20480  0</span><br><span class="line">libiscsi_tcp           20480  1 iscsi_tcp</span><br><span class="line">libiscsi               53248  3 libiscsi_tcp,iscsi_tcp,ib_iser</span><br><span class="line">scsi_transport_iscsi    98304  3 iscsi_tcp,ib_iser,libiscsi</span><br><span class="line">ip_tables              28672  0</span><br><span class="line">x_tables               40960  1 ip_tables</span><br><span class="line">autofs4                40960  2</span><br><span class="line">btrfs                1130496  0</span><br><span class="line">zstd_compress         163840  1 btrfs</span><br><span class="line">raid10                 53248  0</span><br><span class="line">raid456               143360  0</span><br><span class="line">async_raid6_recov      20480  1 raid456</span><br><span class="line">async_memcpy           16384  2 raid456,async_raid6_recov</span><br><span class="line">async_pq               16384  2 raid456,async_raid6_recov</span><br><span class="line">async_xor              16384  3 async_pq,raid456,async_raid6_recov</span><br><span class="line">async_tx               16384  5 async_pq,async_memcpy,async_xor,raid456,async_raid6_recov</span><br><span class="line">xor                    24576  2 async_xor,btrfs</span><br><span class="line">raid6_pq              114688  4 async_pq,btrfs,raid456,async_raid6_recov</span><br><span class="line">libcrc32c              16384  1 raid456</span><br><span class="line">raid1                  40960  0</span><br><span class="line">raid0                  20480  0</span><br><span class="line">multipath              16384  0</span><br><span class="line">linear                 16384  0</span><br><span class="line">crct10dif_pclmul       16384  0</span><br><span class="line">crc32_pclmul           16384  0</span><br><span class="line">ghash_clmulni_intel    16384  0</span><br><span class="line">pcbc                   16384  0</span><br><span class="line">vmwgfx                274432  1</span><br><span class="line">ttm                   106496  1 vmwgfx</span><br><span class="line">drm_kms_helper        172032  1 vmwgfx</span><br><span class="line">aesni_intel           188416  0</span><br><span class="line">syscopyarea            16384  1 drm_kms_helper</span><br><span class="line">aes_x86_64             20480  1 aesni_intel</span><br><span class="line">sysfillrect            16384  1 drm_kms_helper</span><br><span class="line">crypto_simd            16384  1 aesni_intel</span><br><span class="line">sysimgblt              16384  1 drm_kms_helper</span><br><span class="line">glue_helper            16384  1 aesni_intel</span><br><span class="line">fb_sys_fops            16384  1 drm_kms_helper</span><br><span class="line">cryptd                 24576  3 crypto_simd,ghash_clmulni_intel,aesni_intel</span><br><span class="line">psmouse               147456  0</span><br><span class="line">drm                   401408  4 vmwgfx,drm_kms_helper,ttm</span><br><span class="line">mptspi                 24576  2</span><br><span class="line">mptscsih               40960  1 mptspi</span><br><span class="line">mptbase               102400  2 mptspi,mptscsih</span><br><span class="line">ahci                   40960  0</span><br><span class="line">libahci                32768  1 ahci</span><br><span class="line">i2c_piix4              24576  0</span><br><span class="line">vmxnet3                57344  0</span><br><span class="line">scsi_transport_spi     32768  1 mptspi</span><br><span class="line">pata_acpi              16384  0</span><br></pre></td></tr></table></figure>
<h4 id="lsns-list-namespaces"><a href="#lsns-list-namespaces" class="headerlink" title="lsns - list namespaces"></a>lsns - list namespaces</h4><p>lsns  lists  information  about all the currently accessible namespaces or about the given namespace.  The namespace identifier is an inode number.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">╭─root@gitlab /opt</span><br><span class="line">╰─<span class="comment"># lsns</span></span><br><span class="line">		  NS TYPE   NPROCS   PID USER             COMMAND</span><br><span class="line">4026531835 cgroup    264     1 root             /lib/systemd/systemd --system --deserialize 39</span><br><span class="line">4026531836 pid       264     1 root             /lib/systemd/systemd --system --deserialize 39</span><br><span class="line">4026531837 user      264     1 root             /lib/systemd/systemd --system --deserialize 39</span><br><span class="line">4026531838 uts       264     1 root             /lib/systemd/systemd --system --deserialize 39</span><br><span class="line">4026531839 ipc       264     1 root             /lib/systemd/systemd --system --deserialize 39</span><br><span class="line">4026531840 mnt       259     1 root             /lib/systemd/systemd --system --deserialize 39</span><br><span class="line">4026531861 mnt         1    31 root             kdevtmpfs</span><br><span class="line">4026531993 net       264     1 root             /lib/systemd/systemd --system --deserialize 39</span><br><span class="line">4026532531 mnt         1 37609 root             /lib/systemd/systemd-udevd</span><br><span class="line">4026532556 mnt         1 42954 systemd-timesync /lib/systemd/systemd-timesyncd</span><br><span class="line">4026532557 mnt         1 42900 systemd-network  /lib/systemd/systemd-networkd</span><br><span class="line">4026532603 mnt         1 42924 systemd-resolve  /lib/systemd/systemd-resolved</span><br></pre></td></tr></table></figure>
<h4 id="lsof-list-open-files"><a href="#lsof-list-open-files" class="headerlink" title="lsof - list open files"></a>lsof - list open files</h4><p>lsof 列出打开的文件。绝对是个排查故障的利器，在一切皆文件的 Linux 世界里，lsof 可以查看打开的文件是：</p>
<ul>
<li>普通文件</li>
<li>目录</li>
<li>网络文件系统的文件</li>
<li>字符或设备文件</li>
<li>(函数)共享库</li>
<li>管道、命名管道</li>
<li>符号链接</li>
<li>网络文件（例如：NFS file、网络socket，unix域名socket）</li>
<li>还有其它类型的文件，等等</li>
</ul>
<p>另外 lsof 命令也是有着最多选项的Linux/Unix命令之一，另一个 nc 命令也是如此😂。</p>
<ul>
<li>列出端口号占用的进程</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">╭─root@blog &#x2F;opt&#x2F;shell</span><br><span class="line">╰─# lsof -i :53      ↵</span><br><span class="line">COMMAND   PID            USER   FD   TYPE DEVICE SIZE&#x2F;OFF NODE NAME</span><br><span class="line">systemd-r 538 systemd-resolve   12u  IPv4  13925      0t0  UDP localhost:domain</span><br><span class="line">systemd-r 538 systemd-resolve   13u  IPv4  13926      0t0  TCP localhost:domain (LISTEN)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>PS：最近面试的时候被问到过</p>
<p>Q： Linux 下查看端口占用的命令？</p>
<p>A：<code>netstat -tunlp</code> 、<code>ss -tua</code>、<code>lsof -i</code> 😂</p>
</blockquote>
<h4 id="lspci-list-all-PCI-devices"><a href="#lspci-list-all-PCI-devices" class="headerlink" title="lspci - list all PCI devices"></a>lspci - list all PCI devices</h4><p>列出 PCI 设备，比如显卡</p>
<blockquote>
<p>lspci is a utility for displaying information about PCI buses in the system and devices connected to them.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">╭─root@gitlab /opt</span><br><span class="line">╰─<span class="comment"># lspci</span></span><br><span class="line">00:00.0 Host bridge: Intel Corporation 440BX/ZX/DX - 82443BX/ZX/DX Host bridge (rev 01)</span><br><span class="line">00:01.0 PCI bridge: Intel Corporation 440BX/ZX/DX - 82443BX/ZX/DX AGP bridge (rev 01)</span><br><span class="line">00:07.0 ISA bridge: Intel Corporation 82371AB/EB/MB PIIX4 ISA (rev 08)</span><br><span class="line">00:07.1 IDE interface: Intel Corporation 82371AB/EB/MB PIIX4 IDE (rev 01)</span><br><span class="line">00:07.3 Bridge: Intel Corporation 82371AB/EB/MB PIIX4 ACPI (rev 08)</span><br><span class="line">00:07.7 System peripheral: VMware Virtual Machine Communication Interface (rev 10)</span><br><span class="line">00:0f.0 VGA compatible controller: VMware SVGA II Adapter</span><br><span class="line">00:10.0 SCSI storage controller: LSI Logic / Symbios Logic 53c1030 PCI-X Fusion-MPT Dual Ultra320 SCSI (rev 01)</span><br><span class="line">00:11.0 PCI bridge: VMware PCI bridge (rev 02)</span><br></pre></td></tr></table></figure>
<h3 id="proc"><a href="#proc" class="headerlink" title="proc"></a>proc</h3><p>确切来说这并不是一个工具，而是 Linux 的内存文件系统，它可以帮助我们了解一些系统信息，方便排查一些故障等。</p>
<h4 id="CPU"><a href="#CPU" class="headerlink" title="CPU"></a>CPU</h4><p><code>cat /proc/cpuinfo</code> 和 <code>lscpu</code> 二者输出类似</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">[root@k8s-master-01</span> <span class="string">~]#</span> <span class="string">cat</span> <span class="string">/proc/cpuinfo</span></span><br><span class="line"><span class="attr">processor       :</span> <span class="number">0</span></span><br><span class="line"><span class="attr">vendor_id       :</span> <span class="string">GenuineIntel</span></span><br><span class="line"><span class="attr">cpu family      :</span> <span class="number">6</span></span><br><span class="line"><span class="attr">model           :</span> <span class="number">60</span></span><br><span class="line"><span class="attr">model name      :</span> <span class="string">Intel(R)</span> <span class="string">Xeon(R)</span> <span class="string">CPU</span> <span class="string">E3-1271</span> <span class="string">v3</span> <span class="string">@</span> <span class="number">3.</span><span class="string">60GHz</span></span><br><span class="line"><span class="attr">stepping        :</span> <span class="number">3</span></span><br><span class="line"><span class="attr">microcode       :</span> <span class="number">0x1c</span></span><br><span class="line"><span class="attr">cpu MHz         :</span> <span class="number">3591.683</span></span><br><span class="line"><span class="attr">cache size      :</span> <span class="number">8192</span> <span class="string">KB</span></span><br><span class="line"><span class="attr">physical id     :</span> <span class="number">0</span></span><br><span class="line"><span class="attr">siblings        :</span> <span class="number">1</span></span><br><span class="line"><span class="attr">core id         :</span> <span class="number">0</span></span><br><span class="line"><span class="attr">cpu cores       :</span> <span class="number">1</span></span><br><span class="line"><span class="attr">apicid          :</span> <span class="number">0</span></span><br><span class="line"><span class="attr">initial apicid  :</span> <span class="number">0</span></span><br><span class="line"><span class="attr">fpu             :</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">fpu_exception   :</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">cpuid level     :</span> <span class="number">13</span></span><br><span class="line"><span class="attr">wp              :</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">flags           :</span> <span class="string">fpu</span> <span class="string">vme</span> <span class="string">de</span> <span class="string">pse</span> <span class="string">tsc</span> <span class="string">msr</span> <span class="string">pae</span> <span class="string">mce</span> <span class="string">cx8</span> <span class="string">apic</span> <span class="string">sep</span> <span class="string">mtrr</span> <span class="string">pge</span> <span class="string">mca</span> <span class="string">cmov</span> <span class="string">pat</span> <span class="string">pse36</span> <span class="string">clflush</span> <span class="string">dts</span> <span class="string">mmx</span> <span class="string">fxsr</span> <span class="string">sse</span> <span class="string">sse2</span> <span class="string">ss</span> <span class="string">syscall</span> <span class="string">nx</span> <span class="string">pdpe1gb</span> <span class="string">rdtscp</span> <span class="string">lm</span> <span class="string">constant_tsc</span> <span class="string">arch_perfmon</span> <span class="string">pebs</span> <span class="string">bts</span> <span class="string">nopl</span> <span class="string">xtopology</span> <span class="string">tsc_reliable</span> <span class="string">nonstop_tsc</span> <span class="string">aperfmperf</span> <span class="string">eagerfpu</span> <span class="string">pni</span> <span class="string">pclmulqdq</span> <span class="string">ssse3</span> <span class="string">fma</span> <span class="string">cx16</span> <span class="string">pcid</span> <span class="string">sse4_1</span> <span class="string">sse4_2</span> <span class="string">x2apic</span> <span class="string">movbe</span> <span class="string">popcnt</span> <span class="string">tsc_deadline_timer</span> <span class="string">aes</span> <span class="string">xsave</span> <span class="string">avx</span> <span class="string">f16c</span> <span class="string">rdrand</span> <span class="string">hypervisor</span> <span class="string">lahf_lm</span> <span class="string">abm</span> <span class="string">epb</span> <span class="string">fsgsbase</span> <span class="string">tsc_adjust</span> <span class="string">bmi1</span> <span class="string">avx2</span> <span class="string">smep</span> <span class="string">bmi2</span> <span class="string">invpcid</span> <span class="string">xsaveopt</span> <span class="string">dtherm</span> <span class="string">ida</span> <span class="string">arat</span> <span class="string">pln</span> <span class="string">pts</span></span><br><span class="line"><span class="attr">bogomips        :</span> <span class="number">7183.36</span></span><br><span class="line"><span class="attr">clflush size    :</span> <span class="number">64</span></span><br><span class="line"><span class="attr">cache_alignment :</span> <span class="number">64</span></span><br><span class="line"><span class="attr">address sizes   :</span> <span class="number">42</span> <span class="string">bits</span> <span class="string">physical,</span> <span class="number">48</span> <span class="string">bits</span> <span class="string">virtual</span></span><br><span class="line"><span class="attr">power management:</span></span><br></pre></td></tr></table></figure>
<h4 id="RAM"><a href="#RAM" class="headerlink" title="RAM"></a>RAM</h4><p>用来查看一下系统内存的信息，另外 free 命令是从 /proc/meminfo 中读取信息的，跟我们直接读到的结果一样。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">[root@k8s-master-01</span> <span class="string">proc]#</span> <span class="string">cat</span> <span class="string">meminfo</span></span><br><span class="line"><span class="attr">MemTotal:</span>        <span class="number">3863636</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">MemFree:</span>          <span class="number">247016</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">MemAvailable:</span>    <span class="number">2096628</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">Buffers:</span>           <span class="number">85612</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">Cached:</span>          <span class="number">1952072</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">SwapCached:</span>            <span class="number">0</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">Active:</span>          <span class="number">2250028</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">Inactive:</span>        <span class="number">1003588</span> <span class="string">kB</span></span><br><span class="line"><span class="string">Active(anon):</span>    <span class="number">1224120</span> <span class="string">kB</span></span><br><span class="line"><span class="string">Inactive(anon):</span>    <span class="number">21344</span> <span class="string">kB</span></span><br><span class="line"><span class="string">Active(file):</span>    <span class="number">1025908</span> <span class="string">kB</span></span><br><span class="line"><span class="string">Inactive(file):</span>   <span class="number">982244</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">Unevictable:</span>           <span class="number">0</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">Mlocked:</span>               <span class="number">0</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">SwapTotal:</span>             <span class="number">0</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">SwapFree:</span>              <span class="number">0</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">Dirty:</span>               <span class="number">128</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">Writeback:</span>             <span class="number">0</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">AnonPages:</span>       <span class="number">1215816</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">Mapped:</span>           <span class="number">196080</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">Shmem:</span>             <span class="number">29532</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">Slab:</span>             <span class="number">222544</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">SReclaimable:</span>      <span class="number">92156</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">SUnreclaim:</span>       <span class="number">130388</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">KernelStack:</span>       <span class="number">15904</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">PageTables:</span>        <span class="number">13024</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">NFS_Unstable:</span>          <span class="number">0</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">Bounce:</span>                <span class="number">0</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">WritebackTmp:</span>          <span class="number">0</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">CommitLimit:</span>     <span class="number">1931816</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">Committed_AS:</span>    <span class="number">7402668</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">VmallocTotal:</span>   <span class="number">34359738367</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">VmallocUsed:</span>      <span class="number">187276</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">VmallocChunk:</span>   <span class="number">34359310332</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">HardwareCorrupted:</span>     <span class="number">0</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">AnonHugePages:</span>    <span class="number">264192</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">CmaTotal:</span>              <span class="number">0</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">CmaFree:</span>               <span class="number">0</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">HugePages_Total:</span>       <span class="number">0</span></span><br><span class="line"><span class="attr">HugePages_Free:</span>        <span class="number">0</span></span><br><span class="line"><span class="attr">HugePages_Rsvd:</span>        <span class="number">0</span></span><br><span class="line"><span class="attr">HugePages_Surp:</span>        <span class="number">0</span></span><br><span class="line"><span class="attr">Hugepagesize:</span>       <span class="number">2048</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">DirectMap4k:</span>      <span class="number">206720</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">DirectMap2M:</span>     <span class="number">3987456</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">DirectMap1G:</span>     <span class="number">2097152</span> <span class="string">kB</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>buffer：表示块设备(block device)所占用的缓存页，包括：直接读写块设备、以及文件系统元数据(metadata)比如SuperBlock所使用的缓存页；</p>
</li>
<li><p>cache：表示普通文件数据所占用的缓存页。</p>
</li>
</ul>
<p>二者的区别推荐阅读 <a href="http://linuxperf.com/?p=32" target="_blank" rel="noopener">FREE命令显示的BUFFERS与CACHED的区别</a>，从 Linux 内核源码来区分。</p>
<h4 id="net"><a href="#net" class="headerlink" title="net"></a>net</h4><ul>
<li>arp</li>
</ul>
<p>用来查看系统 arp 缓存的映射表。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">╭─root@k8s-node-3 /proc/net</span><br><span class="line">╰─# cat arp</span><br><span class="line">IP address       HW type     Flags       HW address            Mask     Device</span><br><span class="line">169.254.169.254  0x1         0x0         00:00:00:00:00:00     *        ens160</span><br><span class="line">100.78.36.67     0x1         0x2         ee:25:17:a5:e9:3b     *        cali35f7ecfd8a4</span><br><span class="line">10.20.172.212    0x1         0x2         00:0c:29:16:f5:1f     *        ens160</span><br><span class="line">100.78.36.65     0x1         0x2         d6:80:af:8a:22:c7     *        calid838acfbeda</span><br><span class="line">10.20.172.1      0x1         0x2         00:00:5e:00:01:3a     *        ens160</span><br><span class="line">10.20.172.102    0x1         0x2         00:21:91:53:e8:a3     *        ens160</span><br><span class="line">10.20.172.254    0x1         0x2         5c:dd:70:05:e8:53     *        ens160</span><br><span class="line">10.20.172.106    0x1         0x2         98:90:96:d0:86:8a     *        ens160</span><br></pre></td></tr></table></figure>
<ul>
<li>route</li>
</ul>
<p>以树级结构列出系统的路由表信息</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">╭─root@k8s-node-3 ~</span><br><span class="line">╰─# cat /proc/net/fib_trie</span><br><span class="line">Main:</span><br><span class="line">  +-- 0.0.0.0/0 3 1 5</span><br><span class="line">	  +-- 0.0.0.0/4 2 0 2</span><br><span class="line">		  |-- 0.0.0.0</span><br><span class="line">			  /0 universe UNICAST</span><br><span class="line">		  +-- 10.0.0.0/9 2 0 2</span><br><span class="line">			  +-- 10.20.172.0/24 2 1 2</span><br><span class="line">				  |-- 10.20.172.0</span><br><span class="line">					  /32 link BROADCAST</span><br><span class="line">					  /24 link UNICAST</span><br><span class="line">				  +-- 10.20.172.192/26 2 0 2</span><br><span class="line">					  |-- 10.20.172.211</span><br><span class="line">						  /32 host LOCAL</span><br><span class="line">					  |-- 10.20.172.255</span><br><span class="line">						  /32 link BROADCAST</span><br><span class="line">			  +-- 10.96.0.0/12 4 1 7</span><br><span class="line">				  +-- 10.96.0.0/16 2 0 1</span><br><span class="line">					  +-- 10.96.0.0/28 2 0 2</span><br><span class="line">						  |-- 10.96.0.1</span><br><span class="line">							  /32 host LOCAL</span><br><span class="line">						  |-- 10.96.0.10</span><br><span class="line">							  /32 host LOCAL</span><br><span class="line">					  |-- 10.96.94.140</span><br><span class="line">						  /32 host LOCAL</span><br><span class="line">					  |-- 10.96.130.114</span><br><span class="line">						  /32 host LOCAL</span><br><span class="line">				  |-- 10.99.89.188</span><br><span class="line">					  /32 host LOCAL</span><br><span class="line">				  |-- 10.101.71.131</span><br><span class="line">					  /32 host LOCAL</span><br><span class="line">				  |-- 10.104.241.211</span><br><span class="line">					  /32 host LOCAL</span><br><span class="line">				  |-- 10.107.246.53</span><br><span class="line">					  /32 host LOCAL</span><br><span class="line">				  |-- 10.108.171.54</span><br><span class="line">					  /32 host LOCAL</span><br><span class="line">				  |-- 10.109.20.145</span><br><span class="line">					  /32 host LOCAL</span><br><span class="line">				  |-- 10.110.206.28</span><br><span class="line">					  /32 host LOCAL</span><br><span class="line">				  |-- 10.111.25.53</span><br><span class="line">					  /32 host LOCAL</span><br><span class="line">	  +-- 96.0.0.0/3 2 0 2</span><br><span class="line">		  +-- 100.64.0.0/10 3 0 3</span><br><span class="line">			  +-- 100.78.36.64/26 3 0 6</span><br><span class="line">				  +-- 100.78.36.64/30 2 0 0</span><br><span class="line">					  |-- 100.78.36.64</span><br><span class="line">						  /32 host LOCAL</span><br><span class="line">						  /32 link BROADCAST</span><br><span class="line">						  /26 universe BLACKHOLE</span><br><span class="line">					  |-- 100.78.36.65</span><br><span class="line">						  /32 link UNICAST</span><br><span class="line">					  |-- 100.78.36.66</span><br><span class="line">						  /32 link UNICAST</span><br><span class="line">					  |-- 100.78.36.67</span><br><span class="line">						  /32 link UNICAST</span><br><span class="line">				  |-- 100.78.36.105</span><br><span class="line">					  /32 link UNICAST</span><br><span class="line">			  |-- 100.87.114.192</span><br><span class="line">				  /26 universe UNICAST</span><br><span class="line">			  |-- 100.107.127.64</span><br><span class="line">				  /26 universe UNICAST</span><br><span class="line">			  |-- 100.112.151.128</span><br><span class="line">				  /26 universe UNICAST</span><br><span class="line">			  |-- 100.123.190.192</span><br><span class="line">				  /26 universe UNICAST</span><br><span class="line">		  +-- 127.0.0.0/8 2 0 2</span><br><span class="line">			  +-- 127.0.0.0/31 1 0 0</span><br><span class="line">				  |-- 127.0.0.0</span><br><span class="line">					  /32 link BROADCAST</span><br><span class="line">					  /8 host LOCAL</span><br><span class="line">				  |-- 127.0.0.1</span><br><span class="line">					  /32 host LOCAL</span><br><span class="line">			  |-- 127.255.255.255</span><br><span class="line">				  /32 link BROADCAST</span><br><span class="line">	  +-- 168.0.0.0/5 2 0 2</span><br><span class="line">		  |-- 169.254.0.0</span><br><span class="line">			  /16 link UNICAST</span><br><span class="line">		  +-- 172.16.0.0/14 3 0 6</span><br><span class="line">			  +-- 172.17.0.0/31 1 0 0</span><br><span class="line">				  |-- 172.17.0.0</span><br><span class="line">					  /32 link BROADCAST</span><br><span class="line">					  /16 link UNICAST</span><br><span class="line">				  |-- 172.17.0.1</span><br><span class="line">					  /32 host LOCAL</span><br><span class="line">			  |-- 172.17.255.255</span><br><span class="line">				  /32 link BROADCAST</span><br></pre></td></tr></table></figure>
<ul>
<li>nf_conntrack</li>
</ul>
<blockquote>
<p>nf_conntrack(在老版本的 Linux 内核中叫 ip_conntrack)是一个内核模块,用于跟踪一个连接的状态的。连接状态跟踪可以供其他模块使用,最常见的两个使用场景是 iptables 的 nat 的 state 模块。 iptables 的 nat 通过规则来修改目的/源地址,但光修改地址不行,我们还需要能让回来的包能路由到最初的来源主机。这就需要借助 nf_conntrack 来找到原来那个连接的记录才行。而 state 模块则是直接使用 nf_conntrack 里记录的连接的状态来匹配用户定义的相关规则。例如下面这条 INPUT 规则用于放行 80 端口上的状态为 NEW 的连接上的包。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">╭─root@k8s-node-3 /proc/net</span><br><span class="line">╰─# cat nf_conntrack | head -n 4</span><br><span class="line">ipv4     2 tcp      6 102 SYN_SENT src=10.20.172.211 dst=10.10.107.214 sport=42562 dport=179 [UNREPLIED] src=10.10.107.214 dst=10.20.172.211 sport=179 dport=42562 mark=0 secctx=system_u:object_r:unlabeled_t:s0 zone=0 use=2</span><br><span class="line">ipv4     2 tcp      6 79 SYN_SENT src=10.20.172.211 dst=10.10.107.214 sport=60579 dport=179 [UNREPLIED] src=10.10.107.214 dst=10.20.172.211 sport=179 dport=60579 mark=0 secctx=system_u:object_r:unlabeled_t:s0 zone=0 use=2</span><br><span class="line">ipv4     2 tcp      6 86366 ESTABLISHED src=10.20.172.211 dst=10.10.107.121 sport=58589 dport=179 src=10.10.107.121 dst=10.20.172.211 sport=179 dport=58589 [ASSURED] mark=0 secctx=system_u:object_r:unlabeled_t:s0 zone=0 use=2</span><br><span class="line">ipv4     2 tcp      6 62 SYN_SENT src=10.20.172.211 dst=10.10.107.214 sport=37531 dport=179 [UNREPLIED] src=10.10.107.214 dst=10.20.172.211 sport=179 dport=37531 mark=0 secctx=system_u:object_r:unlabeled_t:s0 zone=0 use=2</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="http://www.linvon.cn/post/%E8%BF%9E%E6%8E%A5%E8%B7%9F%E8%B8%AAnf_conntrack%E4%B8%8Enat%E5%92%8C%E7%8A%B6%E6%80%81iptables/" target="_blank" rel="noopener">连接跟踪nf_conntrack与NAT和状态防火墙</a></li>
<li><a href="https://www.cnblogs.com/liushaodong/archive/2013/02/26/2933593.html" target="_blank" rel="noopener">netfilter 链接跟踪机制与NAT原理</a></li>
<li><a href="http://blog.chinaunix.net/uid-23069658-id-3169450.html" target="_blank" rel="noopener">(五)洞悉linux下的Netfilter&amp;iptables：如何理解连接跟踪机制？</a></li>
<li><a href="https://clodfisher.github.io/2018/09/nf_conntrack/" target="_blank" rel="noopener">Iptables之nf_conntrack模块</a></li>
</ul>
<h4 id="kernel"><a href="#kernel" class="headerlink" title="kernel"></a>kernel</h4><p>可以用来查看一下系统内核版本信息</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master-01 proc]# uname -a</span><br><span class="line">Linux k8s-master-01 3.10.0-862.el7.x86_64 #1 SMP Fri Apr 20 16:44:24 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span><br><span class="line">[root@k8s-master-01 proc]# cat version</span><br><span class="line">Linux version 3.10.0-862.el7.x86_64 (builder@kbuilder.dev.centos.org) (gcc version 4.8.5 20150623 (Red Hat 4.8.5-28) (GCC) ) #1 SMP Fri Apr 20 16:44:24 UTC 2018</span><br></pre></td></tr></table></figure>
<h3 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h3><h4 id="nc-netcat"><a href="#nc-netcat" class="headerlink" title="nc netcat"></a>nc netcat</h4><p>nc 是个瑞士军刀啊，你能想到的你想不到的都能做，在这里仅仅列出几个常用常用的命令，咱平时主要用来判断主机端口是否正常，想要完整地了解推荐阅读下面提到的文章。之前编程随想大佬也写过 nc 命令的使用详解。</p>
<ul>
<li>install</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> RHEL/CentOS</span></span><br><span class="line">yum install netcat</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Debian/Ubuntu</span></span><br><span class="line">apt install netcat</span><br></pre></td></tr></table></figure>
<ul>
<li>查看主机端口是否打开</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看远程主机端口是否打开</span></span><br><span class="line">╭─root@blog /opt/shell</span><br><span class="line">╰─# nc -vz bing.com 443</span><br><span class="line">DNS fwd/rev mismatch: bing.com != a-0001.a-msedge.net</span><br><span class="line">Warning: inverse host lookup failed for 13.107.21.200: Unknown host</span><br><span class="line">bing.com [204.79.197.200] 443 (https) open</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看本机端口是否被占用</span></span><br><span class="line">╭─root@blog /opt/shell</span><br><span class="line">╰─# nc -lp 80 -v                                                                    1 ↵</span><br><span class="line">retrying local 0.0.0.0:80 : Address already in use</span><br></pre></td></tr></table></figure>
<ul>
<li>用 nc 传输文件</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 接收端】（B 主机）运行如下命令（其中的 xxx 是端口号）</span></span><br><span class="line">nc -l -p xxx &gt; file2</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 然后在【发送端】（A 主机）运行如下命令</span></span><br><span class="line">nc x.x.x.x xxx &lt; file1</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://program-think.blogspot.com/2019/09/Netcat-Tricks.html" target="_blank" rel="noopener">扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵”</a></li>
</ul>
<h4 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h4><p>nmap 命令用的最多的就是端口扫描，在渗透领域多用来扫描内网机器。</p>
<ul>
<li>install</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> RHEL/CentOS</span></span><br><span class="line">yum install nmap</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Debian/Ubuntu</span></span><br><span class="line">apt install nmap</span><br></pre></td></tr></table></figure>
<ul>
<li>扫描类型</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-sT    TCP connect() 扫描，这是最基本的 TCP 扫描方式。这种扫描很容易被检测到，在目标主机的日志中会记录大批的连接请求以及错误信息。</span><br><span class="line">-sS    TCP 同步扫描 (TCP SYN)，因为不必全部打开一个 TCP 连接，所以这项技术通常称为半开扫描 (half-open)。这项技术最大的好处是，很少有系统能够把这记入系统日志。不过，你需要 root 权限来定制 SYN 数据包。</span><br><span class="line">-sF,-sX,-sN    秘密 FIN 数据包扫描、圣诞树 (Xmas Tree)、空 (Null) 扫描模式。这些扫描方式的理论依据是：关闭的端口需要对你的探测包回应 RST 包，而打开的端口必需忽略有问题的包（参考 RFC 793 第 64 页）。</span><br><span class="line">-sP    ping 扫描，用 ping 方式检查网络上哪些主机正在运行。当主机阻塞 ICMP echo 请求包是 ping 扫描是无效的。nmap 在任何情况下都会进行 ping 扫描，只有目标主机处于运行状态，才会进行后续的扫描。</span><br><span class="line">-sU    UDP 的数据包进行扫描，如果你想知道在某台主机上提供哪些 UDP（用户数据报协议，RFC768) 服务，可以使用此选项。</span><br><span class="line">-sA    ACK 扫描，这项高级的扫描方法通常可以用来穿过防火墙。</span><br><span class="line">-sW    滑动窗口扫描，非常类似于 ACK 的扫描。</span><br><span class="line">-sR    RPC 扫描，和其它不同的端口扫描方法结合使用。</span><br><span class="line">-b    FTP 反弹攻击 (bounce attack)，连接到防火墙后面的一台 FTP 服务器做代理，接着进行端口扫描。</span><br></pre></td></tr></table></figure>
<ul>
<li>扫描参数</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-P0    在扫描之前，不 ping 主机。</span><br><span class="line">-PT    扫描之前，使用 TCP ping 确定哪些主机正在运行。</span><br><span class="line">-PS    对于 root 用户，这个选项让 nmap 使用 SYN 包而不是 ACK 包来对目标主机进行扫描。</span><br><span class="line">-PI    设置这个选项，让 nmap 使用真正的 ping(ICMP echo 请求）来扫描目标主机是否正在运行。</span><br><span class="line">-PB    这是默认的 ping 扫描选项。它使用 ACK(-PT) 和 ICMP(-PI) 两种扫描类型并行扫描。如果防火墙能够过滤其中一种包，使用这种方法，你就能够穿过防火墙。</span><br><span class="line">-O    这个选项激活对 TCP/IP 指纹特征 (fingerprinting) 的扫描，获得远程主机的标志，也就是操作系统类型。</span><br><span class="line">-I    打开 nmap 的反向标志扫描功能。</span><br><span class="line">-f    使用碎片 IP 数据包发送 SYN、FIN、XMAS、NULL。包增加包过滤、入侵检测系统的难度，使其无法知道你的企图。</span><br><span class="line">-v    冗余模式。强烈推荐使用这个选项，它会给出扫描过程中的详细信息。</span><br><span class="line">-S &lt;IP&gt;    在一些情况下，nmap 可能无法确定你的源地址 (nmap 会告诉你）。在这种情况使用这个选项给出你的 IP 地址。</span><br><span class="line">-g port    设置扫描的源端口。一些天真的防火墙和包过滤器的规则集允许源端口为 DNS(53) 或者 FTP-DATA(20) 的包通过和实现连接。显然，如果攻击者把源端口修改为 20 或者 53，就可以摧毁防火墙的防护。</span><br><span class="line">-oN    把扫描结果重定向到一个可读的文件 logfilename 中。</span><br><span class="line">-oS    扫描结果输出到标准输出。</span><br><span class="line">--host_timeout    设置扫描一台主机的时间，以毫秒为单位。默认的情况下，没有超时限制。</span><br><span class="line">--max_rtt_timeout    设置对每次探测的等待时间，以毫秒为单位。如果超过这个时间限制就重传或者超时。默认值是大约 9000 毫秒。</span><br><span class="line">--min_rtt_timeout    设置 nmap 对每次探测至少等待你指定的时间，以毫秒为单位。</span><br><span class="line">-M count    置进行 TCP connect() 扫描时，最多使用多少个套接字进行并行的扫描。</span><br></pre></td></tr></table></figure>
<ul>
<li>获取远程主机系统类型和开放端口</li>
</ul>
<p>粗暴点就 <code>nmap -A IP</code>，或者 <code>nmap -sS -P0 -sV -O</code></p>
<ul>
<li>探测内网在线主机</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sP 192.168.0.0/24</span><br></pre></td></tr></table></figure>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><h4 id="fio"><a href="#fio" class="headerlink" title="fio"></a><a href="https://github.com/axboe/fio" target="_blank" rel="noopener">fio</a></h4><p>用来做磁盘性能测试，十分强大的磁盘性能测试工具，可配置项和参数也很丰富。</p>
<ul>
<li>install</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> RHEL/CentOS</span></span><br><span class="line">yum install fio</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Debian/Ubuntu</span></span><br><span class="line">apt install fio</span><br></pre></td></tr></table></figure>
<ul>
<li>usage</li>
</ul>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">filename</span>=/tmp        <span class="comment"># 测试文件名称，通常选择需要测试的盘的 data 目录</span></span><br><span class="line"><span class="attr">direct</span>=<span class="number">1</span>             <span class="comment"># 测试过程绕过机器自带的 buffer。使测试结果更真实</span></span><br><span class="line"><span class="attr">rw</span>=randwrite         <span class="comment"># 测试随机写的 I/O</span></span><br><span class="line"><span class="attr">rw</span>=randrw            <span class="comment"># 测试随机写和读的 I/O</span></span><br><span class="line"><span class="attr">bs</span>=<span class="number">16</span>k               <span class="comment"># 单次 io 的块文件大小为 16k</span></span><br><span class="line"><span class="attr">bsrange</span>=<span class="number">512</span>-<span class="number">2048</span>     <span class="comment"># 同上，提定数据块的大小范围</span></span><br><span class="line"><span class="attr">size</span>=<span class="number">5</span>G              <span class="comment"># 本次的测试文件大小为 5g，以每次 4k 的 io 进行测试</span></span><br><span class="line"><span class="attr">numjobs</span>=<span class="number">30</span>           <span class="comment"># 本次的测试线程为 30 个</span></span><br><span class="line"><span class="attr">runtime</span>=<span class="number">1000</span>         <span class="comment"># 测试时间 1000 秒，如果不写则一直将 5g 文件分 4k 每次写完为止</span></span><br><span class="line"><span class="attr">ioengine</span>=psync       <span class="comment">#io 引擎使用 psync 方式</span></span><br><span class="line"><span class="attr">rwmixwrite</span>=<span class="number">30</span>        <span class="comment"># 在混合读写的模式下，写占 30%</span></span><br><span class="line">group_reporting      # 关于显示结果的，汇总每个进程的信息</span><br><span class="line"></span><br><span class="line"><span class="attr">lockmem</span>=<span class="number">1</span>G           <span class="comment"># 只使用 1g 内存进行测试s</span></span><br><span class="line">zero_buffers         # 用 0 初始化系统 buffer</span><br><span class="line"><span class="attr">nrfiles</span>=<span class="number">8</span>            <span class="comment"># 每个进程生成文件的数量</span></span><br></pre></td></tr></table></figure>
<p><code>注意：</code> 只要不是测试空盘，<code>filename</code> 参数千万不要使用类似 <code>/dev/sda</code> 这无异于删库跑路😂。所以推荐使用路径而不是设备。</p>
<ul>
<li>output example</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">╭─root@nfs ~</span><br><span class="line">╰─# fio -filename=/tmp/test.file -direct=1 -iodepth 1 -thread -rw=randrw -rwmixread=70 -ioengine=psync -bs=16k -size=1G -numjobs=30 -runtime=100 -group_reporting -name=mytest1</span><br><span class="line">mytest1: (g=0): rw=randrw, bs=(R) 16.0KiB-16.0KiB, (W) 16.0KiB-16.0KiB, (T) 16.0KiB-16.0KiB, ioengine=psync, iodepth=1</span><br><span class="line">...</span><br><span class="line">fio-3.7</span><br><span class="line">Starting 30 threads</span><br><span class="line">mytest1: Laying out IO file (1 file / 1024MiB)</span><br><span class="line">Jobs: 30 (f=30): [m(30)][100.0%][r=1265KiB/s,w=560KiB/s][r=79,w=35 IOPS][eta 00m:00s]</span><br><span class="line">mytest1: (groupid=0, jobs=30): err= 0: pid=45930: Mon Apr 27 23:09:21 2020</span><br><span class="line">	read: IOPS=71, BW=1149KiB/s (1177kB/s)(113MiB/100321msec)</span><br><span class="line">	 clat (usec): min=349, max=999812, avg=292473.60, stdev=188905.70</span><br><span class="line">	  lat (usec): min=349, max=999813, avg=292473.83, stdev=188905.69</span><br><span class="line">	 clat percentiles (msec):</span><br><span class="line">	  |  1.00th=[    5],  5.00th=[    8], 10.00th=[   11], 20.00th=[   24],</span><br><span class="line">	  | 30.00th=[  247], 40.00th=[  313], 50.00th=[  342], 60.00th=[  372],</span><br><span class="line">	  | 70.00th=[  401], 80.00th=[  430], 90.00th=[  481], 95.00th=[  542],</span><br><span class="line">	  | 99.00th=[  751], 99.50th=[  818], 99.90th=[  894], 99.95th=[  936],</span><br><span class="line">	  | 99.99th=[ 1003]</span><br><span class="line">	bw (  KiB/s): min=   31, max=   96, per=3.53%, avg=40.55, stdev=14.30, samples=5661</span><br><span class="line">	iops        : min=    1, max=    6, avg= 2.48, stdev= 0.93, samples=5661</span><br><span class="line">  write: IOPS=30, BW=483KiB/s (494kB/s)(47.3MiB/100321msec)</span><br><span class="line">	 clat (msec): min=2, max=937, avg=297.02, stdev=194.75</span><br><span class="line">	  lat (msec): min=2, max=937, avg=297.02, stdev=194.75</span><br><span class="line">	 clat percentiles (msec):</span><br><span class="line">	  |  1.00th=[    5],  5.00th=[    9], 10.00th=[   11], 20.00th=[   16],</span><br><span class="line">	  | 30.00th=[  266], 40.00th=[  326], 50.00th=[  355], 60.00th=[  380],</span><br><span class="line">	  | 70.00th=[  405], 80.00th=[  435], 90.00th=[  481], 95.00th=[  550],</span><br><span class="line">	  | 99.00th=[  760], 99.50th=[  810], 99.90th=[  902], 99.95th=[  927],</span><br><span class="line">	  | 99.99th=[  936]</span><br><span class="line">	bw (  KiB/s): min=   31, max=  256, per=9.65%, avg=46.52, stdev=25.43, samples=2071</span><br><span class="line">	iops        : min=    1, max=   16, avg= 2.85, stdev= 1.61, samples=2071</span><br><span class="line">  lat (usec)   : 500=0.02%, 750=0.02%</span><br><span class="line">  lat (msec)   : 4=0.28%, 10=8.53%, 20=10.86%, 50=6.42%, 100=0.90%</span><br><span class="line">  lat (msec)   : 250=2.90%, 500=62.21%, 750=6.79%, 1000=1.06%</span><br><span class="line">  cpu          : usr=0.00%, sys=0.01%, ctx=19413, majf=0, minf=7</span><br><span class="line">  IO depths    : 1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, &gt;=64=0.0%</span><br><span class="line">	  submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%</span><br><span class="line">	  complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%</span><br><span class="line">	  issued rwts: total=7204,3026,0,0 short=0,0,0,0 dropped=0,0,0,0</span><br><span class="line">	  latency   : target=0, window=0, percentile=100.00%, depth=1</span><br><span class="line"></span><br><span class="line">Run status group 0 (all jobs):</span><br><span class="line">	READ: bw=1149KiB/s (1177kB/s), 1149KiB/s-1149KiB/s (1177kB/s-1177kB/s), io=113MiB (118MB), run=100321-100321msec</span><br><span class="line">  WRITE: bw=483KiB/s (494kB/s), 483KiB/s-483KiB/s (494kB/s-494kB/s), io=47.3MiB (49.6MB), run=100321-100321msec</span><br><span class="line"></span><br><span class="line">Disk stats (read/write):</span><br><span class="line">	 dm-0: ios=7750/3320, merge=0/0, ticks=200950/123253, in_queue=324237, util=99.83%, aggrios=7765/3135, aggrmerge=0/192, aggrticks=201237/111717, aggrin_queue=312951, aggrutil=99.81%</span><br><span class="line">  sda: ios=7765/3135, merge=0/192, ticks=201237/111717, in_queue=312951, util=99.81%</span><br></pre></td></tr></table></figure>
<h4 id="qperf"><a href="#qperf" class="headerlink" title="qperf"></a>qperf</h4><ul>
<li>install</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install qperf</span><br><span class="line">apt install qperf</span><br></pre></td></tr></table></figure>
<ul>
<li>usage</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">╭─root@debian /opt/trojan</span><br><span class="line">╰─# qperf --help examples</span><br><span class="line">In these examples, we first run qperf on a node called myserver in server</span><br><span class="line">mode by invoking it with no arguments.  In all the subsequent examples, we</span><br><span class="line">run qperf on another node and connect to the server which we assume has a</span><br><span class="line">hostname of myserver.</span><br><span class="line">	 * To run a TCP bandwidth and latency test:</span><br><span class="line">		  qperf myserver tcp_bw tcp_lat</span><br><span class="line">	 * To run a SDP bandwidth test for 10 seconds:</span><br><span class="line">		  qperf myserver -t 10 sdp_bw</span><br><span class="line">	 * To run a UDP latency test and then cause the server to terminate:</span><br><span class="line">		  qperf myserver udp_lat quit</span><br><span class="line">	 * To measure the RDMA UD latency and bandwidth:</span><br><span class="line">		  qperf myserver ud_lat ud_bw</span><br><span class="line">	 * To measure RDMA UC bi-directional bandwidth:</span><br><span class="line">		  qperf myserver rc_bi_bw</span><br><span class="line">	 * To get a range of TCP latencies with a message size from 1 to 64K</span><br><span class="line">		  qperf myserver -oo msg_size:1:64K:*2 -vu tcp_lat</span><br></pre></td></tr></table></figure>
<ul>
<li>output example</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">root@debian-node-02-656868cc46-72lc9:/# qperf  -t 30 100.107.127.100 -v tcp_bw udp_bw tcp_lat udp_lat conf</span><br><span class="line">tcp_bw:</span><br><span class="line">	 bw              =  3.24 GB/sec</span><br><span class="line">	 msg_rate        =  49.4 K/sec</span><br><span class="line">	 time            =    30 sec</span><br><span class="line">	 send_cost       =   542 ms/GB</span><br><span class="line">	 recv_cost       =   542 ms/GB</span><br><span class="line">	 send_cpus_used  =   176 % cpus</span><br><span class="line">	 recv_cpus_used  =   176 % cpus</span><br><span class="line">udp_bw:</span><br><span class="line">	 send_bw         =  2.62 GB/sec</span><br><span class="line">	 recv_bw         =  2.37 GB/sec</span><br><span class="line">	 msg_rate        =  72.3 K/sec</span><br><span class="line">	 time            =    30 sec</span><br><span class="line">	 send_cost       =   542 ms/GB</span><br><span class="line">	 recv_cost       =   598 ms/GB</span><br><span class="line">	 send_cpus_used  =   142 % cpus</span><br><span class="line">	 recv_cpus_used  =   142 % cpus</span><br><span class="line">tcp_lat:</span><br><span class="line">	 latency        =  17.3 us</span><br><span class="line">	 msg_rate       =  57.7 K/sec</span><br><span class="line">	 time           =    30 sec</span><br><span class="line">	 loc_cpus_used  =   110 % cpus</span><br><span class="line">	 rem_cpus_used  =   110 % cpus</span><br><span class="line">udp_lat:</span><br><span class="line">	 latency        =  15.4 us</span><br><span class="line">	 msg_rate       =  64.8 K/sec</span><br><span class="line">	 time           =    30 sec</span><br><span class="line">	 loc_cpus_used  =   111 % cpus</span><br><span class="line">	 rem_cpus_used  =   111 % cpus</span><br><span class="line">conf:</span><br><span class="line">	 loc_node   =  debian-node-02-656868cc46-72lc9</span><br><span class="line">	 loc_cpu    =  8 Cores: Intel Xeon E3-1271 v3 @ 3.60GHz</span><br><span class="line">	 loc_os     =  Linux 3.10.0-862.el7.x86_64</span><br><span class="line">	 loc_qperf  =  0.4.11</span><br><span class="line">	 rem_node   =  debian-node-02-656868cc46-xftvq</span><br><span class="line">	 rem_cpu    =  8 Cores: Intel Xeon E3-1271 v3 @ 3.60GHz</span><br><span class="line">	 rem_os     =  Linux 3.10.0-862.el7.x86_64</span><br><span class="line">	 rem_qperf  =  0.4.11</span><br></pre></td></tr></table></figure>
<h4 id="iperf"><a href="#iperf" class="headerlink" title="iperf"></a>iperf</h4><ul>
<li><p>install</p>
</li>
<li><p>usage</p>
</li>
<li><p>output example</p>
</li>
</ul>
<h4 id="wrk"><a href="#wrk" class="headerlink" title="wrk"></a><a href="https://github.com/wg/wrk/" target="_blank" rel="noopener">wrk</a></h4><ul>
<li>install</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/wg/wrk.git --depth=1</span><br><span class="line">cd wrk</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<ul>
<li>usage</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">./wrk</span><br><span class="line">Usage: wrk &lt;options&gt; &lt;url&gt;</span><br><span class="line">  Options:</span><br><span class="line">	 -c, --connections &lt;N&gt;  Connections to keep open 需要模拟的个并发请求连接数量</span><br><span class="line">	 -d, --duration    &lt;T&gt;  Duration of test 测试的测试时长</span><br><span class="line">	 -t, --threads     &lt;N&gt;  Number of threads to use 并发线程数量</span><br><span class="line">	 -s, --script      &lt;S&gt;  Load Lua script file  指定 Lua 脚本的路径</span><br><span class="line">	 -H, --header      &lt;H&gt;  Add header to request 指定请求带的 Header 参数</span><br><span class="line">		  --latency          Print latency statistics 是否打印请求延迟统计</span><br><span class="line">		  --timeout     &lt;T&gt;  Socket/request timeout 设置请求超时时间</span><br></pre></td></tr></table></figure>
<ul>
<li>output example</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 对 10.20.172.196 nginx 服务器进行测试</span></span><br><span class="line">╭─root@test ~/wrk ‹master›</span><br><span class="line">╰─# ./wrk -t100 -c512 -d30s http://10.20.172.196</span><br><span class="line">Running 30s test @ http://10.20.172.196</span><br><span class="line">  100 threads and 512 connections</span><br><span class="line">  Thread Stats   Avg      Stdev     Max   +/- Stdev</span><br><span class="line">	 Latency    44.71ms  108.75ms   1.99s    89.05%</span><br><span class="line">	 Req/Sec   369.78    207.57     1.68k    71.50%</span><br><span class="line">  987158 requests in 30.10s, 840.66MB read</span><br><span class="line">  Socket errors: connect 0, read 0, write 0, timeout 22</span><br><span class="line">Requests/sec:  32797.65</span><br><span class="line">Transfer/sec:     27.93MB</span><br><span class="line"><span class="meta">#</span><span class="bash"> 测试结果，基本能达到 3W+ 的 QPS 的性能</span></span><br></pre></td></tr></table></figure>
<h4 id="httperf"><a href="#httperf" class="headerlink" title="httperf"></a>httperf</h4><ul>
<li><p>install</p>
</li>
<li><p>usage</p>
</li>
<li><p>output example</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">╭─root@ubuntu-238 ~</span><br><span class="line">╰─# httperf --server 10.20.172.196 --port 80 --num-conns 100 --rate 10 --timeout 1</span><br><span class="line">httperf --timeout=1 --client=0/1 --server=10.20.172.196 --port=80 --uri=/ --rate=10 --send-buffer=4096 --recv-buffer=16384 --num-conns=100 --num-calls=1</span><br><span class="line">httperf: warning: open file limit &gt; FD_SETSIZE; limiting max. # of open files to FD_SETSIZE</span><br><span class="line">Maximum connect burst length: 1</span><br><span class="line"><span class="meta">#</span><span class="bash"> 响应速率</span></span><br><span class="line">Total: connections 100 requests 100 replies 100 test-duration 9.900 s</span><br><span class="line">Connection rate: 10.1 conn/s (99.0 ms/conn, &lt;=1 concurrent connections)</span><br><span class="line">Connection time [ms]: min 0.1 avg 0.1 max 0.2 median 0.5 stddev 0.0</span><br><span class="line">Connection time [ms]: connect 0.0</span><br><span class="line">Connection length [replies/conn]: 1.000</span><br><span class="line">Request rate: 10.1 req/s (99.0 ms/req)</span><br><span class="line">Request size [B]: 66.0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 服务器从请求中接收到第一个字节开始，到连接收到第一个字节所消耗的时间</span></span><br><span class="line">Reply rate [replies/s]: min 10.0 avg 10.0 max 10.0 stddev 0.0 (1 samples)</span><br><span class="line">Reply time [ms]: response 0.1 transfer 0.0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 统计每个回复的大小，每个维度的单位都是字节(bytes),且都是平均数</span></span><br><span class="line">Reply size [B]: header 244.0 content 649.0 footer 0.0 (total 893.0)</span><br><span class="line">Reply status: 1xx=0 2xx=100 3xx=0 4xx=0 5xx=0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 客户端CPU使用率的统计，User用户模式，System模式</span></span><br><span class="line">CPU time [s]: user 3.85 system 6.05 (user 38.9% system 61.1% total 100.0%)</span><br><span class="line"><span class="meta">#</span><span class="bash"> 网络的吞吐量</span></span><br><span class="line">Net I/O: 9.5 KB/s (0.1*10^6 bps)</span><br><span class="line"><span class="meta">#</span><span class="bash"> 发生错误的总数,客户端超时计数，每次从生成请求开始，如果没有响应即超时,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> TCP连接失败</span></span><br><span class="line">Errors: total 0 client-timo 0 socket-timo 0 connrefused 0 connreset 0</span><br><span class="line">Errors: fd-unavail 0 addrunavail 0 ftab-full 0 other 0</span><br></pre></td></tr></table></figure>
<h4 id="ab"><a href="#ab" class="headerlink" title="ab"></a><a href="">ab</a></h4><ul>
<li><p>install</p>
</li>
<li><p>usage</p>
</li>
<li><p>output example</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">╭─root@test ~</span><br><span class="line">╰─# ab -n 1000 -c 1000 http://10.20.172.196/</span><br><span class="line">This is ApacheBench, Version 2.3 &lt;$Revision: 1430300 $&gt;</span><br><span class="line">Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/</span><br><span class="line">Licensed to The Apache Software Foundation, http://www.apache.org/</span><br><span class="line">Benchmarking 10.20.172.196 (be patient)</span><br><span class="line">Completed 100 requests</span><br><span class="line">Completed 200 requests</span><br><span class="line">Completed 300 requests</span><br><span class="line">Completed 400 requests</span><br><span class="line">Completed 500 requests</span><br><span class="line">Completed 600 requests</span><br><span class="line">Completed 700 requests</span><br><span class="line">Completed 800 requests</span><br><span class="line">Completed 900 requests</span><br><span class="line">Completed 1000 requests</span><br><span class="line">Finished 1000 requests</span><br><span class="line">Server Software:        nginx/1.15.8.1</span><br><span class="line">Server Hostname:        10.20.172.196</span><br><span class="line">Server Port:            80</span><br><span class="line">Document Path:          /</span><br><span class="line">Document Length:        649 bytes</span><br><span class="line">Concurrency Level:      1000</span><br><span class="line">Time taken for tests:   0.107 seconds</span><br><span class="line">Complete requests:      1000</span><br><span class="line">Failed requests:        0</span><br><span class="line">Write errors:           0</span><br><span class="line">Total transferred:      888000 bytes</span><br><span class="line">HTML transferred:       649000 bytes</span><br><span class="line">Requests per second:    9313.50 [#/sec] (mean)</span><br><span class="line">Time per request:       107.371 [ms] (mean)</span><br><span class="line">Time per request:       0.107 [ms] (mean, across all concurrent requests)</span><br><span class="line">Transfer rate:          8076.55 [Kbytes/sec] received</span><br><span class="line"></span><br><span class="line">Connection Times (ms)</span><br><span class="line">				  min  mean[+/-sd] median   max</span><br><span class="line">Connect:        0   29   8.1     29      42</span><br><span class="line">Processing:    17   36  14.3     45      51</span><br><span class="line">Waiting:        0   35  14.3     44      50</span><br><span class="line">Total:         42   65   9.0     64      87</span><br><span class="line"></span><br><span class="line">Percentage of the requests served within a certain time (ms)</span><br><span class="line"><span class="meta">  50%</span><span class="bash">     64</span></span><br><span class="line"><span class="meta">  66%</span><span class="bash">     69</span></span><br><span class="line"><span class="meta">  75%</span><span class="bash">     71</span></span><br><span class="line"><span class="meta">  80%</span><span class="bash">     73</span></span><br><span class="line"><span class="meta">  90%</span><span class="bash">     78</span></span><br><span class="line"><span class="meta">  95%</span><span class="bash">     81</span></span><br><span class="line"><span class="meta">  98%</span><span class="bash">     84</span></span><br><span class="line"><span class="meta">  99%</span><span class="bash">     86</span></span><br><span class="line"><span class="meta"> 100%</span><span class="bash">     87 (longest request)</span></span><br></pre></td></tr></table></figure>
<h4 id="stress"><a href="#stress" class="headerlink" title="stress"></a>stress</h4><blockquote>
<p><a href="https://www.tecmint.com/linux-cpu-load-stress-test-with-stress-ng-tool/" target="_blank" rel="noopener">Stress/Stress-NG</a>是Linux下两个常用的系统级压力测试工具，<strong>stress</strong>命令简单易用，<strong>stress-ng</strong>是stress的升级版，支持<strong>数百个参数定制各种压CPU、内存、IO、网络</strong>的姿势。在系统过载的场景下，应用服务可能会出现意想不到的错误或异常，在测试<strong>负载均衡和熔断降级</strong>时非常有用。这里只列举了几个常用的命令，详细使用参考”stress-ng –help”或”man stress-ng”。另外，这些“烤机”命令来测试服务器性能也是不错的。</p>
</blockquote>
<ul>
<li>install</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> RHRL/CentOS</span></span><br><span class="line">yum install epel-release</span><br><span class="line">yum install stress stress-ng</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Debian/Ubuntu</span></span><br><span class="line">apt install stress stress-ng</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> stress-ng 基本用法与stress完全兼容，但有更多的参数可选，并且可以查看统计信息</span></span><br></pre></td></tr></table></figure>
<ul>
<li>usage</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 在两个CPU核心上跑开方运算，并且启动一个不断分配释放1G内存的线程，运行10秒后停止</span></span><br><span class="line">stress --cpu 2 --vm 1 --vm-bytes 1G  -v --timeout 10</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动一个线程不断执行sync系统调用回写磁盘缓存，并且启动一个线程不停地写入删除512MB数据，运行10秒停止</span></span><br><span class="line">stress --io 1 --hdd 1 --hdd-bytes 512M -v --timeout 10</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> --sock 可以模拟大量的socket连接断开以及数据的发送接收等等</span></span><br><span class="line">stress-ng --sock 2 -v --timeout 10 --metrics-brief</span><br></pre></td></tr></table></figure>
<ul>
<li>output example</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">╭─root@debian /bashtop  ‹master›</span><br><span class="line">╰─# stress --cpu 4 --vm 1 --vm-bytes 1G  -v --timeout 3</span><br><span class="line">stress: info: [18174] dispatching hogs: 4 cpu, 0 io, 1 vm, 0 hdd</span><br><span class="line">stress: dbug: [18174] using backoff sleep of 3000us</span><br><span class="line">stress: dbug: [18174] setting timeout to 3s</span><br><span class="line">stress: dbug: [18174] --&gt; hogcpu worker 1 [18179] forked</span><br><span class="line">stress: dbug: [18176] allocating 1073741824 bytes ...</span><br><span class="line">stress: dbug: [18176] allocating 1073741824 bytes ...</span><br><span class="line">stress: dbug: [18176] touching bytes in strides of 4096 bytes ...</span><br><span class="line">stress: dbug: [18174] &lt;-- worker 18175 signalled normally</span><br><span class="line">stress: dbug: [18174] &lt;-- worker 18177 signalled normally</span><br><span class="line">stress: dbug: [18174] &lt;-- worker 18178 signalled normally</span><br><span class="line">stress: dbug: [18174] &lt;-- worker 18179 signalled normally</span><br><span class="line">stress: dbug: [18174] &lt;-- worker 18176 signalled normally</span><br><span class="line">stress: info: [18174] successful run completed in 3s</span><br></pre></td></tr></table></figure>
<p><img src="https://p.k8s.li/20200506154459952.png" alt=""></p>
<h3 id="小工具"><a href="#小工具" class="headerlink" title="小工具"></a>小工具</h3><h3 id="镜像源"><a href="#镜像源" class="headerlink" title="镜像源"></a>镜像源</h3><h2 id="发行版-1"><a href="#发行版-1" class="headerlink" title="发行版"></a>发行版</h2><h3 id="pxder"><a href="#pxder" class="headerlink" title="pxder"></a>pxder</h3><p>下班之后回到小窝之后就开始一天中最最愉悦的时刻，在 pixiv.net 上刷图。收藏喜欢的<del>老婆</del>插画。为了管理和下载自己收藏的插画作品，当然还是选择食用工具来下载啦😂。</p>
<p>在二月份的时候帮小土豆和 nova 同学测试 webp server go 的 benchmark ，这个 pxder 帮了咱很大的忙，下载了 3W 多张图片做测试样本，最终使用脚本筛选出合适的文件大小来进行 prefetc 测试。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">╭─debian@debian /mnt/f/illustrations</span><br><span class="line">╰─$ du -sh</span><br><span class="line">50G     .</span><br><span class="line">╭─debian@debian /mnt/f/illustrations</span><br><span class="line">╰─$ tree</span><br><span class="line">203 directories, 31831 files</span><br></pre></td></tr></table></figure>
<h3 id="杂七杂八的"><a href="#杂七杂八的" class="headerlink" title="杂七杂八的"></a>杂七杂八的</h3><h4 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h4><p>nginx，除了建站當 Web 服務器，是咱在 openwrt 上裝的，目的是為了擺脫 ip 的辦定限制。因為有些設備通過域名來訪問，更換網絡環境，比如搬家之後只需要維修改一下域名解析即可。比如咱使用 X.lo.502.li 作為三級子域名分配給本地內網機器用。</p>
<h4 id="ffmpeg"><a href="#ffmpeg" class="headerlink" title="ffmpeg"></a>ffmpeg</h4><p>ffmpeg 能干的事情太多了，咱使用最多的还是合并视频转码视频，比如咱的 <a href="">mbcf</a> ，全称 Merge bilibili cilent file</p>
<h4 id="pandoc"><a href="#pandoc" class="headerlink" title="pandoc"></a><a href="https://github.com/jgm/pandoc" target="_blank" rel="noopener">pandoc</a></h4><h4 id="rsync"><a href="#rsync" class="headerlink" title="rsync"></a>rsync</h4><h4 id="resilio-sync"><a href="#resilio-sync" class="headerlink" title="resilio sync"></a>resilio sync</h4><p>resilio sync ，是咱最重要的數據備份工具，比如咱使用 pxder 下載好收藏的老婆們，為了在手機上仔細欣賞老婆們，咱就用。resilio sync 將目錄同步到手機上，並且使用它來與 PC，iPhone ，Android ，Linux 三者無縫同步。簡直好用極了。</p>
<p>需要注意的是，如果跨公網同步，在一些網絡環境下因為 GFW 的緣故，無法建立起鏈接，這時候需要使用到預定義主機。其中有兩種比較好的方案，一是在公網 VPS 機器上安裝 resilio sync 並且加入到同步主機當中。這點缺點也明顯，需要佔用磁盤空間，如果同步大量文件以及幾十幾百GB級別的話，小盤機是扛不住的，需要另外添加磁盤。方法二是咱想到的，屢試不爽，就是將本機的 resilio sync 監聽端口 11354 使用 frp 內網穿透到公網服務器，然後在另一台機器上添加上預定義主機，IP 就是 frp 服務器的 IP，端口就是 frp 內網穿透的 remote port。這樣添加好預訂與主機之後，不到一分鐘就能發現主機並建立起連接。</p>
<h4 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h4><h4 id="wget"><a href="#wget" class="headerlink" title="wget"></a>wget</h4><h4 id="oh-my-zsh"><a href="#oh-my-zsh" class="headerlink" title="oh-my-zsh"></a>oh-my-zsh</h4><h4 id="zsh"><a href="#zsh" class="headerlink" title="zsh"></a>zsh</h4><h4 id="frp"><a href="#frp" class="headerlink" title="frp"></a>frp</h4><h4 id="openwrt"><a href="#openwrt" class="headerlink" title="openwrt"></a>openwrt</h4><h4 id="Trojan"><a href="#Trojan" class="headerlink" title="Trojan"></a>Trojan</h4><h3 id="shell-常用脚本"><a href="#shell-常用脚本" class="headerlink" title="shell 常用脚本"></a>shell 常用脚本</h3><h4 id="VPS-init"><a href="#VPS-init" class="headerlink" title="VPS init"></a>VPS init</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br><span class="line">apt install nload ncdu zsh git wget curl htop sysstat psmisc nginx-full fail2ban</span><br><span class="line">curl  https://get.acme.sh | sh</span><br><span class="line">sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"</span><br><span class="line">sed -i 's/ZSH_THEME="robbyrussell"/ZSH_THEME="bira"/g' ~/.zshrc</span><br></pre></td></tr></table></figure>
<h4 id="rawg"><a href="#rawg" class="headerlink" title="rawg"></a>rawg</h4><p>raw wget 的缩写</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> data: 2020-03-31</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> author: muzi502</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">for</span>: Fuck GFW and download some raw file form github without proxy using jsDelivr CDN</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> usage: save the .she to your <span class="built_in">local</span> such as /usr/bin/rawg, and chmod +x /usr/bin/rawg</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> use rawg https://github.com/ohmyzsh/ohmyzsh/blob/master/tools/install.sh to download</span></span><br><span class="line"></span><br><span class="line">set -xue</span><br><span class="line"><span class="meta">#</span><span class="bash"> GitHub rul: https://github.com/ohmyzsh/ohmyzsh/blob/master/tools/install.sh</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> jsDelivr url: https://cdn.jsdelivr.net/gh/ohmyzsh/ohmyzsh/tools/install.sh</span></span><br><span class="line"></span><br><span class="line">wget $(echo $1 | sed 's/raw.githubusercontent.com/cdn.jsdelivr.net\/gh/' \</span><br><span class="line">                | sed 's/github.com/cdn.jsdelivr.net\/gh/' \</span><br><span class="line">                | sed 's/\/master//' | sed 's/\/blob//' )</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> curl $(<span class="built_in">echo</span> <span class="variable">$1</span> | sed <span class="string">'s/raw.githubusercontent.com/cdn.jsdelivr.net\/gh/'</span> \</span></span><br><span class="line"><span class="meta">#</span><span class="bash">                | sed <span class="string">'s/github.com/cdn.jsdelivr.net\/gh/'</span> \</span></span><br><span class="line"><span class="meta">#</span><span class="bash">                | sed <span class="string">'s/\/master//'</span> | sed <span class="string">'s/\/blob//'</span> )</span></span><br></pre></td></tr></table></figure>
<h4 id="kubeadm-pull-images"><a href="#kubeadm-pull-images" class="headerlink" title="kubeadm pull images"></a>kubeadm pull images</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">for</span>: pull kubeamd images and get kubeadm kubectl kubelet binary</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> date: 2020-04-29</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> author: muzi502</span></span><br><span class="line"></span><br><span class="line">set -xue</span><br><span class="line">apt-get update &amp;&amp; apt-get install -y apt-transport-https curl</span><br><span class="line">curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -</span><br><span class="line">cat &lt;&lt;EOF &gt;/etc/apt/sources.list.d/kubernetes.list</span><br><span class="line">deb https://apt.kubernetes.io/ kubernetes-xenial main</span><br><span class="line">EOF</span><br><span class="line">apt-get update</span><br><span class="line"></span><br><span class="line">for version in 1.17.5</span><br><span class="line">do</span><br><span class="line">    apt purge -y kubeadm kubelet kubectl</span><br><span class="line">    apt install -y kubeadm=$&#123;version&#125;-00 kubelet=$&#123;version&#125;-00 kubectl=$&#123;version&#125;-00</span><br><span class="line">    mkdir -p $&#123;version&#125;/bin</span><br><span class="line">    rm -rf $&#123;version&#125;/bin/*</span><br><span class="line">    cp -a $(whereis kubelet | awk -F ":" '&#123;print $2&#125;') $&#123;version&#125;/bin/</span><br><span class="line">    cp -a $(whereis kubeadm | awk -F ":" '&#123;print $2&#125;') $&#123;version&#125;/bin/</span><br><span class="line">    cp -a $(whereis kubectl | awk -F ":" '&#123;print $2&#125;') $&#123;version&#125;/bin/</span><br><span class="line">    kubeadm config images pull --kubernetes-version=$&#123;version&#125;</span><br><span class="line">    docker save -o kubeadm_v$&#123;version&#125;.tar `kubeadm config images list --kubernetes-version=$&#123;version&#125;`</span><br><span class="line">    mv kubeadm_v$&#123;version&#125;.tar $&#123;version&#125;</span><br><span class="line">    tar -czvf $&#123;version&#125;&#123;.tar.gz,&#125;</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<h4 id="ss-obfs"><a href="#ss-obfs" class="headerlink" title="ss-obfs"></a>ss-obfs</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">for</span>: install shadowsocks-libev and obfs</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> date: 2019-03-11</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> by: muzi502</span></span><br><span class="line">apt-get update</span><br><span class="line">apt-get -y  install shadowsocks-libev simple-obfs rng-tools</span><br><span class="line">rngd -r /dev/urandom</span><br><span class="line">mkdir -p /etc/shadowsocks-libev/</span><br><span class="line"></span><br><span class="line">cat &gt; /etc/shadowsocks-libev/config.json &lt;&lt;EOF</span><br><span class="line">&#123;</span><br><span class="line">    "server":"0.0.0.0",</span><br><span class="line">    "server_port":8964,</span><br><span class="line">    "local_port":1080,</span><br><span class="line">    "password":"1984fuckGFW",</span><br><span class="line">    "timeout":60,</span><br><span class="line">    "method":"chacha20",</span><br><span class="line">    "plugin":"obfs-server",</span><br><span class="line">    "plugin_opts":"obfs=http"</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">systemctl restart shadowsocks-libev.service</span><br><span class="line">modprobe tcp_bbr</span><br><span class="line">echo "tcp_bbr" &gt;&gt; /etc/modules-load.d/modules.conf</span><br><span class="line">echo "net.core.default_qdisc=fq" &gt;&gt; /etc/sysctl.conf</span><br><span class="line">echo "net.ipv4.tcp_congestion_control=bbr" &gt;&gt; /etc/sysctl.conf</span><br><span class="line">sysctl -p</span><br><span class="line">sysctl net.ipv4.tcp_available_congestion_control</span><br><span class="line">sysctl net.ipv4.tcp_congestion_control</span><br><span class="line">touch /etc/sysctl.d/local.conf</span><br><span class="line">echo "net.core.wmem_max = 67108864" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">echo "net.core.rmem_default = 65536" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">echo "net.core.wmem_default = 65536" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">echo "net.core.netdev_max_backlog = 4096" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">echo "net.core.somaxconn = 4096" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">echo "net.ipv4.tcp_syncookies = 1" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">echo "net.ipv4.tcp_tw_reuse = 1" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">echo "net.ipv4.tcp_tw_recycle = 0" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">echo "net.ipv4.tcp_fin_timeout = 30" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">echo "net.ipv4.tcp_keepalive_time = 1200" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">echo "net.ipv4.ip_local_port_range = 10000 65000" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">echo "net.ipv4.tcp_max_syn_backlog = 4096" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">echo "net.ipv4.tcp_max_tw_buckets = 5000" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">echo "net.ipv4.tcp_fastopen = 3" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">echo "net.ipv4.tcp_rmem = 4096 87380 67108864" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">echo "net.ipv4.tcp_wmem = 4096 65536 67108864" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">echo "net.ipv4.tcp_mtu_probing = 1" &gt;&gt;/etc/sysctl.d/local.conf</span><br><span class="line">sysctl --system</span><br><span class="line">lsmod | grep bbr</span><br></pre></td></tr></table></figure>
<h4 id="mcbf"><a href="#mcbf" class="headerlink" title="mcbf"></a>mcbf</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">for</span>: bulk merge bilibili UWP download file *.flv</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> by: blog.502.li</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> date: 2019-01-12</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 将该脚放到 UWP 客户端下载缓存主目录下执行，安装 ffmpeg、jq</span></span><br><span class="line"></span><br><span class="line">set -xu</span><br><span class="line">download_dir=$(pwd)</span><br><span class="line">mp4_dir=$&#123;download_dir&#125;/mp4</span><br><span class="line">mkdir -p $&#123;mp4_dir&#125;</span><br><span class="line"></span><br><span class="line">for video_dir in $(ls | sort -n | grep -E -v "\.|mp4")</span><br><span class="line">do</span><br><span class="line">  cd $&#123;download_dir&#125;/$&#123;video_dir&#125;</span><br><span class="line">  up_name=$(jq ".Uploader" *.dvi | tr -d "[:punct:]\040\011\012\015")</span><br><span class="line">  mkdir -p $&#123;mp4_dir&#125;/$&#123;up_name&#125;</span><br><span class="line">  for p_dir in $(ls | sort -n | grep -v "\.")</span><br><span class="line">  do</span><br><span class="line">    cd $&#123;download_dir&#125;/$&#123;video_dir&#125;/$&#123;p_dir&#125;</span><br><span class="line">    video_name=$(jq ".Title" *.info | tr -d "[:punct:]\040\011\012\015")</span><br><span class="line">    part_name=$(jq ".PartName" *.info | tr -d "[:punct:]\040\011\012\015")</span><br><span class="line">    upload_time=$(grep -Eo "20[0-9][0-9]-[0-9][0-9]-[0-9][0-9]" *.info)</span><br><span class="line">    Uploader=$(jq ".Uploader" *.info | tr -d "[:punct:]\040\011\012\015")</span><br><span class="line">    mp4_audio=$(jq ".VideoDashInfo" *.info | tr -d "[:punct:]\040\011\012\015")</span><br><span class="line"></span><br><span class="line">    if [ "null" = "$&#123;part_name&#125;" ];then</span><br><span class="line">    mp4_file_name=$&#123;video_name&#125;.mp4</span><br><span class="line">    else</span><br><span class="line">    mp4_file_name=$&#123;video_name&#125;_$&#123;p_dir&#125;_$&#123;part_name&#125;.mp4</span><br><span class="line">    fi</span><br><span class="line"></span><br><span class="line">    if [ "null" = "$&#123;mp4_audio&#125;" ];then</span><br><span class="line">    ls *.flv | sort -n &gt; ff.txt</span><br><span class="line">    sed -i 's/^/file /g' ff.txt</span><br><span class="line">    ffmpeg -f concat -i ff.txt -c copy $&#123;mp4_dir&#125;/$&#123;up_name&#125;/"$&#123;mp4_file_name&#125;";rm -rf ff.txt</span><br><span class="line">    else</span><br><span class="line">    ffmpeg  -i video.mp4 -i audio1.mp4 -c:v copy -c:a copy $&#123;mp4_dir&#125;/$&#123;up_name&#125;/"$&#123;mp4_file_name&#125;"</span><br><span class="line">    fi</span><br><span class="line">    cd $&#123;download_dir&#125;/$&#123;video_dir&#125;</span><br><span class="line">  cd $&#123;download_dir&#125;</span><br><span class="line">  done</span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果需要保留原视频请注释掉下面这一行</span></span><br><span class="line"><span class="meta">#</span><span class="bash">rm -rf <span class="variable">$&#123;download_dir&#125;</span>/<span class="variable">$&#123;video_dir&#125;</span></span></span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<h4 id="conoha-wallpaper-download"><a href="#conoha-wallpaper-download" class="headerlink" title="conoha wallpaper download"></a>conoha wallpaper download</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">for</span>: download conoha wallpaper</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> by: muzi502</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> date: 2020-02-11</span></span><br><span class="line">set -xue</span><br><span class="line"></span><br><span class="line">p=$(curl https://conoha.mikumo.com/wallpaper/ \</span><br><span class="line">| grep li | grep data-wallpaper-design= \</span><br><span class="line">| sed -e 's/&lt;li//g' | sed -e 's/"&gt;//g' | sed -e 's/^[ \t]*//g' \</span><br><span class="line">| sed -e 's/data-wallpaper-design="//g' \</span><br><span class="line">| sed 's/^/https:\/\/conoha.mikumo.com\/wp-content\/themes\/conohamikumo\/images\/wallpaper\//')</span><br><span class="line"></span><br><span class="line">for pic in $&#123;p&#125;</span><br><span class="line">do</span><br><span class="line">    file_name=$(echo $&#123;pic&#125; | awk -F "/" '&#123;print $9&#125;')</span><br><span class="line">    wget $&#123;pic&#125;/1080_1920.jpg -O $&#123;file_name&#125;_1080.jpg</span><br><span class="line">    wget $&#123;pic&#125;/2560_1440.jpg -O $&#123;file_name&#125;_1440.jpg</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="http://code2life.top/2019/05/02/0035-fault-injection/" target="_blank" rel="noopener">[DevOps] Linux操作系统层的故障注入</a></li>
</ul>
    </div>
      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Linux/" rel="tag"><i class="fa fa-tag"></i> Linux</a>
              <a href="/tags/%E6%90%AC%E7%A0%96/" rel="tag"><i class="fa fa-tag"></i> 搬砖</a>
              <a href="/tags/%E5%B7%A5%E5%85%B7/" rel="tag"><i class="fa fa-tag"></i> 工具</a>
              <a href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/" rel="tag"><i class="fa fa-tag"></i> 命令行</a>
          </div>
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/Brick-removal-note.html" rel="prev" title="无砖可搬的日子|换厂记">
      <i class="fa fa-chevron-left"></i> 无砖可搬的日子|换厂记
    </a></div>
      <div class="post-nav-item">
    <a href="/skopeo.html" rel="next" title="镜像搬运工 skopeo 初体验">
      镜像搬运工 skopeo 初体验 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
  </article>
  </div>
          </div>
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
        </div>
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>
  <aside class="sidebar">
    <div class="sidebar-inner">
      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>
      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#咕咕咕"><span class="nav-number">1.</span> <span class="nav-text">咕咕咕</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux"><span class="nav-number">2.</span> <span class="nav-text">Linux</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#入门"><span class="nav-number">2.1.</span> <span class="nav-text">入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#放弃"><span class="nav-number">2.2.</span> <span class="nav-text">放弃</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#发行版"><span class="nav-number">2.3.</span> <span class="nav-text">发行版</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#命令行工具"><span class="nav-number">3.</span> <span class="nav-text">命令行工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#文本处理"><span class="nav-number">3.1.</span> <span class="nav-text">文本处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#系统信息"><span class="nav-number">3.2.</span> <span class="nav-text">系统信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#bashtop"><span class="nav-number">3.3.</span> <span class="nav-text">bashtop</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ls-兄弟们"><span class="nav-number">3.4.</span> <span class="nav-text">ls 兄弟们</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#proc"><span class="nav-number">3.5.</span> <span class="nav-text">proc</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#网络"><span class="nav-number">3.6.</span> <span class="nav-text">网络</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#测试"><span class="nav-number">3.7.</span> <span class="nav-text">测试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小工具"><span class="nav-number">3.8.</span> <span class="nav-text">小工具</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#镜像源"><span class="nav-number">3.9.</span> <span class="nav-text">镜像源</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#发行版-1"><span class="nav-number">4.</span> <span class="nav-text">发行版</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#pxder"><span class="nav-number">4.1.</span> <span class="nav-text">pxder</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#杂七杂八的"><span class="nav-number">4.2.</span> <span class="nav-text">杂七杂八的</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#shell-常用脚本"><span class="nav-number">4.3.</span> <span class="nav-text">shell 常用脚本</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考"><span class="nav-number">5.</span> <span class="nav-text">参考</span></a></li></ol></div>
      </div>
      <!--/noindex-->
      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="木子"
      src="https://blog.k8s.li/avatar.png">
  <p class="site-author-name" itemprop="name">木子</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">98</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">120</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/muzi502" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;muzi502" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:blog@502.li" title="E-Mail → mailto:blog@502.li" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/muzi_ii" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;muzi_ii" rel="noopener" target="_blank"><i class="fa fa-fw fa-twitter"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://t.me/muzi_ii" title="Telegram → https:&#x2F;&#x2F;t.me&#x2F;muzi_ii" rel="noopener" target="_blank"><i class="fa fa-fw fa-telegram"></i>Telegram</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://kindle.502.li/" title="Kindle → https:&#x2F;&#x2F;kindle.502.li" rel="noopener" target="_blank"><i class="fa fa-fw fa-book"></i>Kindle</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tg.k8s.li/" title="Channel → https:&#x2F;&#x2F;tg.k8s.li" rel="noopener" target="_blank"><i class="fa fa-fw fa-telegram"></i>Channel</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-fw fa-rss"></i>RSS</a>
      </span>
  </div>
      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>
      </div>
    </main>
    <footer class="footer">
      <div class="footer-inner">
<div class="copyright">
  &copy; 2018 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">木子</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">1.4m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">39:50</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>
      </div>
    </footer>
  </div>
  <script src="/lib/anime.min.js"></script>
<script src="/js/utils.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>
<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://muzi.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: {page: {
            url: "https://blog.k8s.li/My-brick-lifting-tools.html",
            identifier: "My-brick-lifting-tools.html",
            title: "木子的搬砖工具😂"
          }
        }
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://muzi.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>
</body>
</html>
