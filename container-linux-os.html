<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
  <link rel="mask-icon" href="/favicon.ico" color="#222">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="//fonts.loli.net/css?family=Lato:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://blog.k8s.li').hostname,
    root: '/',
    scheme: 'Gemini',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"always","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":true,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"buttons","active":null,"storage":true,"lazyload":true,"nav":{"disqus":{"text":"Load Disqus","order":-1}}},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":false,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>
  <meta name="description" content="æ›´æ–°æ—¥å¿— 2019-12-31 åˆç¨¿ï¼Œå¯èƒ½å®Œæˆä¸äº†ï¼Œç­‰åˆ°æ¥å¹´äº†ğŸ˜‚ 2020-01-01  å®¹å™¨ä¼˜åŒ–å‹æ“ä½œç³»ç»Ÿï¼ŸGKE çš„  Container-Optimized OSGoogle å®¶çš„  GKE  ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä½¿ç”¨ Container-Optimized OS æ¥è¿è¡Œå·¥ä½œè´Ÿè½½ï¼Œä¸è¿‡ä»…ä»…æ˜¯é’ˆå¯¹ GCE æ¥è¿›è¡Œä¼˜åŒ–çš„ï¼Œå¯èƒ½åœ¨ OpenStack æˆ–è€… vSphere ä¸Šè¿è¡Œä¸èµ·æ¥ï¼Œ(ççŒœğŸ˜‚">
<meta property="og:type" content="article">
<meta property="og:title" content="Container Linux OS ä»å…¥å‘åˆ°çˆ¬å‡ºæ¥ğŸ˜‚">
<meta property="og:url" content="https://blog.k8s.li/container-linux-os.html">
<meta property="og:site_name" content="æœ¨å­">
<meta property="og:description" content="æ›´æ–°æ—¥å¿— 2019-12-31 åˆç¨¿ï¼Œå¯èƒ½å®Œæˆä¸äº†ï¼Œç­‰åˆ°æ¥å¹´äº†ğŸ˜‚ 2020-01-01  å®¹å™¨ä¼˜åŒ–å‹æ“ä½œç³»ç»Ÿï¼ŸGKE çš„  Container-Optimized OSGoogle å®¶çš„  GKE  ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä½¿ç”¨ Container-Optimized OS æ¥è¿è¡Œå·¥ä½œè´Ÿè½½ï¼Œä¸è¿‡ä»…ä»…æ˜¯é’ˆå¯¹ GCE æ¥è¿›è¡Œä¼˜åŒ–çš„ï¼Œå¯èƒ½åœ¨ OpenStack æˆ–è€… vSphere ä¸Šè¿è¡Œä¸èµ·æ¥ï¼Œ(ççŒœğŸ˜‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://p.k8s.li/20191231163325900.png">
<meta property="og:image" content="https://p.k8s.li/20191231163400135.png">
<meta property="og:image" content="https://p.k8s.li/rancheroshowitworks.png">
<meta property="og:image" content="https://p.k8s.li/20191231105906355.png">
<meta property="og:image" content="https://p.k8s.li/20191231110111943.png">
<meta property="og:image" content="https://p.k8s.li/20191231110153113.png">
<meta property="og:image" content="https://p.k8s.li/20191231110231422.png">
<meta property="og:image" content="https://p.k8s.li/20191231110339494.png">
<meta property="og:image" content="https://p.k8s.li/20191231110531238.png">
<meta property="og:image" content="https://p.k8s.li/20191231111131193.png">
<meta property="og:image" content="https://p.k8s.li/20191231113306435.png">
<meta property="og:image" content="https://p.k8s.li/20191231125441199.png">
<meta property="og:image" content="https://p.k8s.li/20191231133509428.png">
<meta property="og:image" content="https://p.k8s.li/20191231135348120.png">
<meta property="og:image" content="https://p.k8s.li/20191231142454934.png">
<meta property="og:image" content="https://p.k8s.li/20191231143958024.png">
<meta property="article:published_time" content="2019-12-30T16:00:00.000Z">
<meta property="article:modified_time" content="2021-05-30T14:38:18.408Z">
<meta property="article:author" content="æœ¨å­">
<meta property="article:tag" content="å®¹å™¨">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="docker">
<meta property="article:tag" content="kubernees">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://p.k8s.li/20191231163325900.png">
<link rel="canonical" href="https://blog.k8s.li/container-linux-os.html">
<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>
  <title>Container Linux OS ä»å…¥å‘åˆ°çˆ¬å‡ºæ¥ğŸ˜‚ | æœ¨å­</title>
  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }
  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>
<link rel="alternate" href="/atom.xml" title="æœ¨å­" type="application/atom+xml">
</head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">
    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">æœ¨å­</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>
<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">
    <a href="/" rel="section"><i class="fa fa-fw fa-desktop"></i>Home</a>
  </li>
        <li class="menu-item menu-item-books">
    <a href="/booklist.html" rel="section"><i class="fa fa-fw fa-book"></i>Books</a>
  </li>
        <li class="menu-item menu-item-kindle">
    <a href="https://kindle.502.li/" rel="noopener" target="_blank"><i class="fa fa-fw fa-book"></i>Kindle</a>
  </li>
        <li class="menu-item menu-item-friend">
    <a href="/link/" rel="section"><i class="fa fa-fw fa-link"></i>Friend</a>
  </li>
        <li class="menu-item menu-item-about">
    <a href="/about.html" rel="section"><i class="fa fa-fw fa-user-circle-o"></i>About</a>
  </li>
  </ul>
</nav>
</div>
    </header>
  <div class="reading-progress-bar"></div>
    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div class="content">
  <div class="posts-expand">
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.k8s.li/container-linux-os.html">
    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blog.k8s.li/avatar.png">
      <meta itemprop="name" content="æœ¨å­">
      <meta itemprop="description" content="">
    </span>
    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æœ¨å­">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          Container Linux OS ä»å…¥å‘åˆ°çˆ¬å‡ºæ¥ğŸ˜‚
        </h2>
        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-12-31 2019-12-31T00:00:00+08:00" itemprop="dateCreated datePublished" datetime="2019-12-31T00:00:00+08:00">2019-12-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-05-30 2021-05-30T22:38:18+08:00" itemprop="dateModified" datetime="2021-05-30T22:38:18+08:00">2021-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index">
                    <span itemprop="name">æŠ€æœ¯</span>
                  </a>
                </span>
            </span>
  <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    <a title="disqus" href="/container-linux-os.html#comments" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="container-linux-os.html" itemprop="commentCount"></span>
    </a>
  </span>
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>38k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>1:03</span>
            </span>
        </div>
      </header>
    <div class="post-body" itemprop="articleBody">
        <h2 id="æ›´æ–°æ—¥å¿—"><a href="#æ›´æ–°æ—¥å¿—" class="headerlink" title="æ›´æ–°æ—¥å¿—"></a>æ›´æ–°æ—¥å¿—</h2><ul>
<li>2019-12-31 åˆç¨¿ï¼Œå¯èƒ½å®Œæˆä¸äº†ï¼Œç­‰åˆ°æ¥å¹´äº†ğŸ˜‚</li>
<li>2020-01-01</li>
</ul>
<h2 id="å®¹å™¨ä¼˜åŒ–å‹æ“ä½œç³»ç»Ÿï¼Ÿ"><a href="#å®¹å™¨ä¼˜åŒ–å‹æ“ä½œç³»ç»Ÿï¼Ÿ" class="headerlink" title="å®¹å™¨ä¼˜åŒ–å‹æ“ä½œç³»ç»Ÿï¼Ÿ"></a>å®¹å™¨ä¼˜åŒ–å‹æ“ä½œç³»ç»Ÿï¼Ÿ</h2><h3 id="GKE-çš„-Container-Optimized-OS"><a href="#GKE-çš„-Container-Optimized-OS" class="headerlink" title="GKE çš„  Container-Optimized OS"></a>GKE çš„  <a href="https://cloud.google.com/container-optimized-os/docs/" target="_blank" rel="noopener">Container-Optimized OS</a></h3><p>Google å®¶çš„  GKE  ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä½¿ç”¨ <a href="https://cloud.google.com/container-optimized-os/docs/" target="_blank" rel="noopener">Container-Optimized OS</a> æ¥è¿è¡Œå·¥ä½œè´Ÿè½½ï¼Œä¸è¿‡ä»…ä»…æ˜¯é’ˆå¯¹ GCE æ¥è¿›è¡Œä¼˜åŒ–çš„ï¼Œå¯èƒ½åœ¨ OpenStack æˆ–è€… vSphere ä¸Šè¿è¡Œä¸èµ·æ¥ï¼Œ(ççŒœğŸ˜‚</p>
<blockquote>
<p>Container-Optimized OS æ˜¯é€‚ç”¨äº <a href="https://cloud.google.com/compute" target="_blank" rel="noopener">Compute Engine</a> è™šæ‹Ÿæœºçš„æ“ä½œç³»ç»Ÿæ˜ åƒï¼Œä¸“ä¸ºè¿è¡Œ Docker å®¹å™¨è€Œä¼˜åŒ–ã€‚å€ŸåŠ© Container-Optimized OSï¼Œæ‚¨å¯ä»¥å¿«é€Ÿã€é«˜æ•ˆã€å®‰å…¨åœ°åœ¨  Google Cloud Platform ä¸Šå¯åŠ¨ Docker å®¹å™¨ã€‚Container-Optimized OS ç”± Google  ç»´æŠ¤ï¼ŒåŸºäº <a href="https://www.chromium.org/chromium-os" target="_blank" rel="noopener">Chromium OS</a> å¼€æ”¾æºä»£ç é¡¹ç›®ã€‚</p>
</blockquote>
<h3 id="CoreOS-Container-Linux"><a href="#CoreOS-Container-Linux" class="headerlink" title="CoreOS Container Linux"></a>CoreOS Container Linux</h3><p>ä¸ªäººè®¤ä¸º CoreOS çš„ CoreOS Container Linux è¦æ¯” Container-Optimized OS å’Œ Photon OS è¦æ›´åŠ ä¸“ä¸šï¼Œå°¤å…¶æ˜¯é’ˆå¯¹å®¹å™¨æ¥è®²ï¼Œ CoreOS å°±æ˜¯ä¸“é—¨ç”¨æ¥è¿è¡Œå®¹å™¨çš„ï¼Œå®ƒæ²¡æœ‰åƒ yum æˆ– apt è¿™æ ·çš„åŒ…ç®¡ç†å™¨æ¥å®‰è£…è½¯ä»¶ï¼Œåœ¨ CoreOS ä¸­ä½ ä¸éœ€è¦å®‰è£…è½¯ä»¶ï¼Œå› ä¸ºæ‰€æœ‰çš„åº”ç”¨ç¨‹åºéƒ½è¦ä½¿ç”¨ docker æ¥æ‰“åŒ…ã€‚</p>
<blockquote>
<p>é¢å¤–æä¸€å¥ï¼ŒCoreOS æ˜¯ä¸€ä¸ªå›¢é˜Ÿï¼Œç°å¦‚ä»Šå·²ç»è¢« Red HatÂ® æ”¶è´­äº†ï¼Œè€Œ Red HatÂ® å·²ç»è¢« IBM æ”¶è´­äº†ï¼ŒæŒ‰ç…§å…³ç³»æ¥è®²è€Œ CoreOS åº”è¯¥æ˜¯ IBM çš„å­™å­å§ğŸ™ƒã€‚è€Œ CoreOS Container Linux ä»…ä»…æ˜¯ä»–ä»¬ç»´æŠ¤é¡¹ç›®çš„å…¶ä¸­ä¸€ä¸ªï¼ŒCoreOS å¼€æºçš„é¡¹ç›®è¿˜æœ‰ï¼š</p>
<ul>
<li>etcdï¼š</li>
<li>Clair:</li>
<li>dexï¼š</li>
<li>Prometheusï¼š</li>
<li>flannelï¼š</li>
</ul>
</blockquote>
<p>åœ¨ Linux ä¸–ç•Œé‡Œæœ‰å¤§é‡çš„å‘è¡Œç‰ˆå¯ä»¥åšä¸ºæœåŠ¡å™¨ç³»ç»Ÿä½¿ç”¨, ä½†æ˜¯è¿™äº›ç³»ç»Ÿå¤§å¤šéƒ¨ç½²å¤æ‚, æ›´æ–°ç³»ç»Ÿæ›´æ˜¯å›°éš¾é‡é‡. è¿™äº›éƒ½æ˜¯ CoreOS è¯•å›¾è§£å†³çš„é—®é¢˜ã€‚</p>
<h4 id="ç‰¹ç‚¹å¦‚ä¸‹"><a href="#ç‰¹ç‚¹å¦‚ä¸‹" class="headerlink" title="ç‰¹ç‚¹å¦‚ä¸‹"></a>ç‰¹ç‚¹å¦‚ä¸‹</h4><ul>
<li>æœ€å°åŒ–çš„æ“ä½œç³»ç»Ÿï¼š å ç”¨å†…å­˜å¾ˆå°‘ï¼Œæ¯”å…¸å‹çš„æœåŠ¡å™¨ç‰ˆæœ¬ Linux å°‘å  40%çš„å†…å­˜ã€‚</li>
<li>æ˜“äºå‡çº§ï¼š CoreOS é‡‡ç”¨åŒç³»ç»Ÿåˆ†åŒºï¼ˆä¸»åŠ¨åˆ†åŒº/è¢«åŠ¨åˆ†åŒºï¼‰è®¾è®¡è€Œä¸æ˜¯é‡‡ç”¨ä¼ ç»Ÿçš„é€šè¿‡å‡çº§åŒ…æ¥å‡çº§ç³»ç»Ÿï¼Œè¿™ä½¿å¾—æ¯æ¬¡å‡çº§æ›´åŠ å¿«é€Ÿï¼Œå¯é å’Œæ˜“äºå›æ»šã€‚</li>
<li>é›†æˆ Dockerï¼š CoreOS é»˜è®¤é›†æˆ Docker å¹¶ä½œäº†å¾ˆå¥½çš„æ”¯æŒå’Œä¼˜åŒ–ï¼Œçœå»ç”¨æˆ·å®‰è£…ï¼Œé…ç½®ï¼Œä¼˜åŒ– Docker çš„æ—¶é—´ï¼Œæå¤§åœ°æ–¹ä¾¿äº†ç”¨æˆ·ã€‚</li>
<li>æ˜“äºé›†ç¾¤åŒ–ï¼š CoreOS æœ¬èº«æä¾›äº†å¤§å‹ Docker å®¹å™¨é›†ç¾¤çš„æ•´ä½“è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡å†…ç½®çš„ fleet å·¥å…·åœ¨å¤šå°ç³»ç»Ÿä¸­éƒ¨ç½²å®¹å™¨å¹¶è¿›è¡Œé›†ç¾¤åŒ–ç®¡ç†ã€‚åŒæ—¶é€šè¿‡æä¾› Discovery Serviceï¼Œä¾¿äºåŠ¨æ€éƒ¨ç½²å’Œç®¡ç†é›†ç¾¤ï¼Œè§£å†³æ–¹æ¡ˆæ¯”è¾ƒæˆç†Ÿã€‚</li>
<li>è‡ªåŠ¨åŒ–çš„å¤§è§„æ¨¡éƒ¨ç½²ï¼š CoreOS è‡ªèº«æä¾›çš„è§£å†³æ–¹æ¡ˆèƒ½å¤Ÿè‡ªåŠ¨åœ°å¤§è§„æ¨¡æ‰¹é‡éƒ¨ç½²å¹¶æ“ä½œç³»ç»Ÿï¼Œæå¤§åœ°å‡å°‘ç”¨æˆ·å·¥ä½œé‡ã€‚</li>
<li>ä½¿ç”¨ systemd åšä¸ºç³»ç»ŸæœåŠ¡ç®¡ç†å·¥å…·ï¼Œæ€§èƒ½æ¯”è¾ƒå¥½ï¼Œsystemd æœ‰ç°ä»£åŒ–çš„æ—¥å¿—åŠŸèƒ½ï¼ŒåŒæ—¶é‡‡ç”¨ socket å¼ä¸ D-Bus æ€»çº¿å¼æ¿€æ´»æœåŠ¡.</li>
</ul>
<h3 id="Photon-OS"><a href="#Photon-OS" class="headerlink" title="Photon OS"></a>Photon OS</h3><h4 id="å®˜æ–¹å®£ä¼ å†Œ"><a href="#å®˜æ–¹å®£ä¼ å†Œ" class="headerlink" title="å®˜æ–¹å®£ä¼ å†Œ"></a>å®˜æ–¹å®£ä¼ å†Œ</h4><p>PPT åšçš„ä¸é”™å‘¦ğŸ˜‚</p>
<p><img src="https://p.k8s.li/20191231163325900.png" alt=""></p>
<p><img src="https://p.k8s.li/20191231163400135.png" alt=""></p>
<p>å‰½çªƒä¸€æ®µ VMware å®˜æ–¹çš„<a href="https://vmware.github.io/photon/" target="_blank" rel="noopener">æ–‡æ¡£</a>ä»‹ç»ï¼š</p>
<blockquote>
<p>Project Photon OSâ„¢ is an open source, minimal Linux container host  that is optimized for cloud-native applications, cloud platforms, and  VMware infrastructure. Photon OS 3.0 introduces ARM64 support, installer improvements and updated packages. We invite partners, customers, and  community members to collaborate on using Photon OS to run  high-performance virtual machines and containerized applications.</p>
<ul>
<li><strong>Optimized for VMware vSphereÂ®</strong>: The Linux kernel is tuned for performance when Photon OS runs on vSphere.</li>
<li><strong>Support for containers</strong>: Photon OS includes the Docker daemon and works with container orchestration frameworks, such as Mesos and Kubernetes.</li>
<li><strong>Efficient lifecycle management</strong>: Photon OS is easy to manage, patch, and update.</li>
<li><strong>Security hardened</strong>: The kernel and other aspects of the operating system are built with an emphasis on security.</li>
</ul>
<p>For more information, see the <a href="https://vmware.github.io/photon/assets/files/photon-os-datasheet.pdf" target="_blank" rel="noopener">datasheet</a>.</p>
<p>Track our progress in earning the Linux Foundationâ€™s Core Infrastructure Initiativeâ€™s Best Practices Badge.</p>
</blockquote>
<p>å¯ä»¥çœ‹å‡º Photon OSâ„¢ æ˜¯é’ˆå¯¹ VMware vSphereÂ® è™šæ‹ŸåŒ–å¹³å°è¿›è¡Œå†…æ ¸ä¼˜åŒ–çš„å®¹å™¨ä¸“ç”¨æ“ä½œç³»ç»Ÿï¼Œå°±å’Œ CoreOS ä¸€æ ·ã€‚ååˆ†é€‚åˆä¸“é—¨ç”¨æ¥è¿è¡Œå®¹å™¨ï¼Œå½“ä½œ Kubernetes é›†ç¾¤ä¸­çš„å·¥ä½œè´Ÿè½½æ¥ä½¿ç”¨ã€‚</p>
<h3 id="RancherOS"><a href="#RancherOS" class="headerlink" title="RancherOS"></a>RancherOS</h3><p>å‰½çªƒä¸€æ®µå®˜æ–¹çš„<a href="https://rancher.com/docs/os/v1.x/en/" target="_blank" rel="noopener">ä»‹ç»</a>ï¼š</p>
<blockquote>
<p>RancherOS is the smallest, easiest way to run Docker in production. Every process in RancherOS is a container managed by Docker. This includes system services such as <code>udev</code> and <code>syslog</code>. Because it only includes the services necessary to run Docker, RancherOS is significantly smaller than most traditional operating systems. By removing unnecessary libraries and services, requirements for security patches and other maintenance are also reduced. This is possible because, with Docker, users typically package all necessary libraries into their containers.</p>
<p>Another way in which RancherOS is designed specifically for running Docker is that it always runs the latest version of Docker. This allows users to take advantage of the latest Docker capabilities and bug fixes.</p>
<p>Like other minimalist Linux distributions, RancherOS boots incredibly quickly. Starting Docker containers is nearly instant, similar to starting any other process. This speed is ideal for organizations adopting microservices and autoscaling.</p>
<p>Docker is an open-source platform designed for developers, system admins, and DevOps. It is used to build, ship, and run containers, using a simple and powerful command line interface (CLI). To get started with Docker, please visit the <a href="https://docs.docker.com/engine/userguide/" target="_blank" rel="noopener">Docker user guide</a>.</p>
</blockquote>
<p>RancherOS æ˜¯ Rancher å›¢é˜Ÿæ‰€ç»´æŠ¤çš„å¼€æºé¡¹ç›®ï¼Œä¹Ÿæ˜¯å¯¹æ ‡ CoreOS ä¸€æ ·ï¼Œä¸“é—¨ç”¨æ¥è¿è¡Œå®¹å™¨ï¼Œå¹¶ä¸”å¯ä»¥è¿è¡Œåœ¨ç”Ÿäº§ç¯å¢ƒï¼ˆè‡³å°‘å®˜æ–¹åšäº†è¿™ä¹ˆæ ·çš„æ‰¿è¯ºï¼Œå’±ä¹Ÿæ²¡åœ¨ç”Ÿäº§ç”¨è¿‡ï¼Œä¸å¥½è¯´ã€‚åœ¨ RancherOS ä¸­æ‰€æœ‰çš„è¿›ç¨‹ï¼ˆåŒ…æ‹¬ç³»ç»Ÿæ‰€æœ‰çš„æœåŠ¡ï¼Œæ¯”å¦‚ udev å’Œ syslogï¼‰éƒ½æ˜¯ç”¨ docker æ¥ç®¡ç†ï¼Œè¿™ä¸€ç‚¹è¦æ¯” CoreOS æ›´åŠ æ¿€è¿›ä¸€äº›ï¼Œè€Œ CoreOS è¿˜æ˜¯ä½¿ç”¨ä¼ ç»Ÿ Linux å‘è¡Œç‰ˆä¸­çš„ systemd æ¥ç®¡ç†ç³»ç»Ÿä¸­çš„æœåŠ¡ã€‚é€šè¿‡ç§»é™¤ä¼ ç»Ÿ Linux å‘è¡Œç‰ˆä¸­ä¸å¿…è¦çš„æœåŠ¡å’Œåº“æ¥æœ€å°åŒ–ç³»ç»Ÿï¼Œä½¿ä»–ä¸“æ³¨å•ä¸€çš„åŠŸèƒ½ï¼Œå³è¿è¡Œ docker å®¹å™¨ã€‚</p>
<blockquote>
<p>Everything in RancherOS is a Docker container. We accomplish this by launching two instances of Docker. One is what we call <strong>System Docker</strong> and is the first process on the system. All other system services, like <code>ntpd</code>, <code>syslog</code>, and <code>console</code>, are running in Docker containers. System Docker replaces traditional init systems like <code>systemd</code> and is used to launch <a href="https://rancher.com/docs/os/v1.x/en/installation/system-services/adding-system-services/" target="_blank" rel="noopener">additional system services</a>.</p>
<p>System Docker runs a special container called <strong>Docker</strong>, which is another Docker daemon responsible for managing all of the userâ€™s containers. Any containers that you launch as a user from the console will run inside this Docker. This creates isolation from the System Docker containers and ensures that normal user commands donâ€™t impact system services.</p>
<p>We created this separation not only for the security benefits, but also to make sure that commands like <code>docker rm -f $(docker ps -qa)</code> donâ€™t delete the entire OS.</p>
</blockquote>
<p><code>Everything in RancherOS is a Docker container.</code> æ„Ÿè§‰è¿™ä¸ªè¦æ¯” CoreOS æ›´åŠ å®¹å™¨åŒ–ï¼Œç”šè‡³ä½¿ç”¨ docker å–ä»£äº† systemd æ¥ç®¡ç†ç³»ç»Ÿçš„å„ç§æœåŠ¡ã€‚ç³»ç»Ÿå¯åŠ¨åè¿è¡Œä¸¤ä¸ª docker æœåŠ¡è¿›ç¨‹ï¼Œä¸€ä¸ªæ˜¯ç³»ç»Ÿ docker ï¼Œåœ¨æ­¤ä¹‹ä¸Šåœ¨è¿è¡Œç³»ç»ŸæœåŠ¡å®¹å™¨ï¼Œå’Œç”¨æˆ·å±‚é¢çš„ docker ã€‚ä¸è¿‡çœ‹ä¸€ä¸‹ä¸‹é¢çš„è¿™å¼ å›¾ä½ å°±ä¼šæ˜ç™½ã€‚æ€»çš„æ¥è®² RancherOS æ˜¯ä½¿ç”¨ docker æ¥ç®¡ç†æ•´ä¸ªç³»ç»Ÿçš„æœåŠ¡çš„ï¼ŒåŒ…æ‹¬ç”¨æˆ·å±‚é¢çš„ docker ã€‚</p>
<p><img src="https://p.k8s.li/rancheroshowitworks.png" alt=""></p>
<h2 id="å®‰è£…ä½“éªŒ"><a href="#å®‰è£…ä½“éªŒ" class="headerlink" title="å®‰è£…ä½“éªŒ"></a>å®‰è£…ä½“éªŒ</h2><p>å’±çš„è™šæ‹ŸåŒ–å¹³å°æ˜¯ VMware vSphere ï¼Œå› ä¸ºç¡¬ä»¶æœåŠ¡å™¨å¤§å¤šæ•°éƒ½æ˜¯ Dell çš„ï¼Œè€Œ  Dell  æ˜¯ VMware æ¯å…¬å¸ï¼Œå¯¹äºæˆ‘å¸è¿™ç§ä¼ ç»Ÿä¼ä¸šæ¥è®²ä½¿ç”¨ VMware vSphere è¿™ç§ç”¨æˆ· UI å‹å¥½çš„è™šæ‹ŸåŒ–æ— ç–‘æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œå“ˆå“ˆğŸ˜‚ã€‚å…¶ä»–è™šæ‹ŸåŒ–å¹³å°æ¯”å¦‚ OpenStack å®‰è£…æ­¥éª¤ä¼šæœ‰æ‰€ä¸åŒã€‚</p>
<h3 id="Container-Optimized-OS"><a href="#Container-Optimized-OS" class="headerlink" title="Container-Optimized OS"></a>Container-Optimized OS</h3><p>å› ä¸ºä»…ä»…æ˜¯é’ˆå¯¹ GCE è¿›è¡Œä¼˜åŒ–çš„ç³»ç»Ÿï¼Œä¼ ç»Ÿçš„è™šæ‹ŸåŒ–æ¯”å¦‚ KVM ã€ ESXi å¯èƒ½ç”¨ä¸äº†ã€‚å¦å¤–è¿˜éœ€è¦æ‹¿ <a href="https://www.chromium.org/chromium-os" target="_blank" rel="noopener">Chromium OS</a>  çš„æºç æ¥ç¼–è¯‘é•œåƒï¼Œæ²¡æœ‰ç°æˆçš„  ISO æˆ–è€… OVA è™šæ‹Ÿæœºæ¨¡æ¿å¯ç”¨ï¼Œå’±å°±ä¸æŠ˜è…¾äº†ã€‚æ¯•ç«Ÿç¡¬ä»¶èµ„æºæœ‰é™ï¼Œç°åœºç¼–è¯‘ä¸€ä¸ª <a href="https://www.chromium.org/chromium-os" target="_blank" rel="noopener">Chromium OS</a>  ä¹Ÿéœ€è¦åå‡ ä¸ªå°æ—¶ğŸ˜¥</p>
<h2 id="Photon-OS-1"><a href="#Photon-OS-1" class="headerlink" title="Photon OS"></a>Photon OS</h2><p>å¯ä»¥ç°æˆç¼–è¯‘ä¸€ä¸ª ISO é•œåƒï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å®˜æ–¹å·²ç»ç¼–è¯‘å¥½çš„ ISO é•œåƒæˆ–è€… OVA è™šæ‹Ÿæœºæ¨¡æ¿ã€‚ä¸è¿‡ä¹Ÿæ”¯æŒå¸¸è§çš„å…¬æœ‰äº‘ï¼Œæ¯”å¦‚ Amazon AMI ã€Google GCE Imageã€Azure VHDã€‚ç”šè‡³è¿˜æœ‰ Raspberry Pi3 Image æ ‘è“æ´¾3ğŸ˜‚</p>
<h3 id="å®˜æ–¹æ–‡æ¡£"><a href="#å®˜æ–¹æ–‡æ¡£" class="headerlink" title="å®˜æ–¹æ–‡æ¡£"></a><a href="https://vmware.github.io/photon/assets/files/html/3.0/photon_installation/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></h3><p>å®˜æ–¹çš„å®‰è£…æ–‡æ¡£ä¸­éƒ½ç»™å‡ºäº†å„ç§ç¯å¢ƒçš„å®‰è£…æ–¹å¼ï¼Œé€‰æ‹©è‡ªå·±çš„ç¯å¢ƒæŒ‰ç…§æ–‡æ¡£ä¸€æ­¥ä¸€æ­¥æ¥å°±è¡Œï¼Œä¸è¿‡åœ¨æ­¤æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ã€‚</p>
<h3 id="å®‰è£…é•œåƒ"><a href="#å®‰è£…é•œåƒ" class="headerlink" title="å®‰è£…é•œåƒ"></a>å®‰è£…é•œåƒ</h3><ul>
<li><h4 id="ISO"><a href="#ISO" class="headerlink" title="ISO"></a><a href="https://github.com/vmware/photon/wiki/Downloading-Photon-OS" target="_blank" rel="noopener">ISO</a></h4></li>
</ul>
<p>é€šç”¨çš„æ–¹æ¡ˆï¼Œé€‚ç”¨äºå„ç§ç¯å¢ƒï¼Œæ— è®ºæ˜¯è™šæ‹Ÿæœºè¿˜æ˜¯ç‰©ç†æœºï¼Œç”±äºå’±ä½¿ç”¨çš„æ˜¯ VMware vSphere è™šæ‹ŸåŒ–ï¼Œå’±å°±ä½¿ç”¨ OVA æ ¼å¼ï¼Œå› ä¸ºåè€…å¯¹ vSphere è¿›è¡Œäº†ä¼˜åŒ–ã€‚å¯¹äº VMware ç”¨æˆ·æ¥è®²æœ€å¥½ä½¿ç”¨ OVA æ ¼å¼æ¥è¿›è¡Œå®‰è£…ã€‚</p>
<ul>
<li><h4 id="OVA"><a href="#OVA" class="headerlink" title="OVA"></a><a href="https://github.com/vmware/photon/wiki/Downloading-Photon-OS" target="_blank" rel="noopener">OVA</a></h4></li>
</ul>
<blockquote>
<p>Pre-installed minimal environment, customized for VMware hypervisor  environments. These customizations include a highly sanitized and  optimized kernel to give improved boot and runtime performance for  containers and Linux applications. Since an OVA is a complete virtual  machine definition, weâ€™ve made available a Photon OS OVA that has  virtual hardware version 11; this will allow for compatibility with  several versions of VMware platforms or allow for the latest and  greatest virtual hardware enhancements.</p>
</blockquote>
<p>æ ¹æ®å®˜æ–¹æ–‡æ¡£æ‰€æè¿°çš„ OVA è™šæ‹Ÿæœºæ¨¡æ¿æ˜¯é’ˆå¯¹  VMware hypervisor  è™šæ‹ŸåŒ–ç¯å¢ƒè¿›è¡Œä¼˜åŒ–å®šåˆ¶çš„ã€‚</p>
<ul>
<li><h5 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h5></li>
<li><p><a href="https://github.com/vmware/photon/wiki/Downloading-Photon-OS" target="_blank" rel="noopener">Amazon Machine Image</a></p>
</li>
<li><p><a href="https://github.com/vmware/photon/wiki/Downloading-Photon-OS" target="_blank" rel="noopener">Google Compute Engine image</a></p>
</li>
<li><p><a href="https://github.com/vmware/photon/wiki/Downloading-Photon-OS" target="_blank" rel="noopener">Azure VHD</a></p>
</li>
<li><p><a href="https://github.com/vmware/photon/wiki/Downloading-Photon-OS" target="_blank" rel="noopener">Raspberry Pi3</a></p>
</li>
</ul>
<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>ä¸‹è½½å¥½ OVA è™šæ‹Ÿæœºæ¨¡æ¿åï¼Œç™»å½•åˆ° ESXi æˆ–è€… vCenter ä¸­ç›´æ¥ä½¿ç”¨ OVA åˆ›å»ºè™šæ‹Ÿæœºæ¨¡æ¿å³å¯ï¼Œå¯¹äº <code>VMwareÂ® Workstation 1x Pro</code>  å¯ä»¥ç›´æ¥å°† OVA å¯¼å…¥æˆä¸ºè™šæ‹Ÿæœºæ¥è¿è¡Œã€‚</p>
<h4 id="1-å¯¼å…¥-OVA-è™šæ‹Ÿæœºæ¨¡æ¿"><a href="#1-å¯¼å…¥-OVA-è™šæ‹Ÿæœºæ¨¡æ¿" class="headerlink" title="1. å¯¼å…¥ OVA è™šæ‹Ÿæœºæ¨¡æ¿"></a>1. å¯¼å…¥ OVA è™šæ‹Ÿæœºæ¨¡æ¿</h4><p><img src="https://p.k8s.li/20191231105906355.png" alt=""></p>
<h4 id="2-æ·»åŠ -OVA-è™šæ‹Ÿæœºæ¨¡æ¿"><a href="#2-æ·»åŠ -OVA-è™šæ‹Ÿæœºæ¨¡æ¿" class="headerlink" title="2.æ·»åŠ  OVA è™šæ‹Ÿæœºæ¨¡æ¿"></a>2.æ·»åŠ  OVA è™šæ‹Ÿæœºæ¨¡æ¿</h4><p><img src="https://p.k8s.li/20191231110111943.png" alt=""></p>
<h4 id="3-é€‰æ‹©å­˜å‚¨"><a href="#3-é€‰æ‹©å­˜å‚¨" class="headerlink" title="3. é€‰æ‹©å­˜å‚¨"></a>3. é€‰æ‹©å­˜å‚¨</h4><p><img src="https://p.k8s.li/20191231110153113.png" alt=""></p>
<h4 id="4-åŒæ„è®¸å¯åè®®"><a href="#4-åŒæ„è®¸å¯åè®®" class="headerlink" title="4. åŒæ„è®¸å¯åè®®"></a>4. åŒæ„è®¸å¯åè®®</h4><p><img src="https://p.k8s.li/20191231110231422.png" alt=""></p>
<h4 id="5-éƒ¨ç½²é€‰é¡¹"><a href="#5-éƒ¨ç½²é€‰é¡¹" class="headerlink" title="5.éƒ¨ç½²é€‰é¡¹"></a>5.éƒ¨ç½²é€‰é¡¹</h4><ul>
<li>é€‰æ‹©å¥½ç½‘ç»œ</li>
<li>ç£ç›˜ç½®å¤‡çš„æ–¹å¼ï¼šç²¾ç®€å°±æ˜¯ä½¿ç”¨åˆ°çš„æ—¶å€™å†å¯¹ç£ç›˜è¿›è¡Œåˆ¶ä»¤ã€‚åšç½®å¤‡å°±æ˜¯åˆ›å»ºè™šæ‹Ÿæœºçš„æ—¶å€™å¯¹ç£ç›˜è¿›è¡Œç½®é›¶ï¼Œæ€§èƒ½ä¼šå¥½ä¸€äº›ã€‚</li>
</ul>
<p><img src="https://p.k8s.li/20191231110339494.png" alt=""></p>
<h4 id="6-å³å°†å®Œæˆ"><a href="#6-å³å°†å®Œæˆ" class="headerlink" title="6. å³å°†å®Œæˆ"></a>6. å³å°†å®Œæˆ</h4><p><img src="https://p.k8s.li/20191231110531238.png" alt=""></p>
<h3 id="ç³»ç»Ÿå¯åŠ¨"><a href="#ç³»ç»Ÿå¯åŠ¨" class="headerlink" title="ç³»ç»Ÿå¯åŠ¨"></a>ç³»ç»Ÿå¯åŠ¨</h3><p><img src="https://p.k8s.li/20191231111131193.png" alt=""></p>
<p>åˆå§‹ç”¨æˆ·åæ˜¯ <code>root</code> ï¼Œå¯†ç æ˜¯ <code>changeme</code> ï¼Œè¾“å…¥å®Œå¯†ç ä¹‹åä¼šå¼ºåˆ¶è¦æ±‚ä½ æ›´æ”¹å¯†ç ï¼Œåœ¨è¾“å…¥ä¸€æ¬¡ <code>changeme</code> ä¹‹åè¾“å…¥ä¸¤æ¬¡ä¿®æ”¹çš„å¯†ç å³å¯ã€‚</p>
<p>ç™»å½•åˆ°ç³»ç»Ÿä¹‹åä½¿ç”¨ <code>ip addr</code> å‘½ä»¤æŸ¥çœ‹ç”±é»˜è®¤çš„ DHCP è·å–åˆ°çš„æ–¹å¼æ¥æŸ¥çœ‹ IPï¼Œç„¶åç¼–è¾‘ sshd_config é…ç½®æ–‡ä»¶å…è®¸ root ç™»å½•ã€‚ä¸å¾—ä¸è¯´ ESXi çš„ Web æ§åˆ¶å°å®åœ¨æ˜¯å¤ªéš¾ç”¨äº†ï¼Œè¿˜æ˜¯ ssh ä¸Šå»ä½¿ç”¨å§ã€‚</p>
<ul>
<li><code>vi /etc/ssh/sshd_config</code> æŠŠ <code>PermitRootLogin</code> é…ç½®é¡¹ä¿®æ”¹ä¸º <code>yes</code> å³å¯</li>
<li>é‡å¯ sshd æœåŠ¡ <code>systemctl restart sshd</code></li>
</ul>
<h3 id="å†…æ ¸"><a href="#å†…æ ¸" class="headerlink" title="å†…æ ¸"></a>å†…æ ¸</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Linux  4.19.79-1.ph3-esx <span class="comment">#1-photon SMP Tue Oct 22 23:53:27 UTC 2019 x86_64 GNU/Linux</span></span><br><span class="line"></span><br><span class="line">root@photon-machine [ ~ ]<span class="comment"># cat /etc/os-release</span></span><br><span class="line">NAME=<span class="string">"VMware Photon OS"</span></span><br><span class="line">VERSION=<span class="string">"3.0"</span></span><br><span class="line">ID=photon</span><br><span class="line">VERSION_ID=3.0</span><br><span class="line">PRETTY_NAME=<span class="string">"VMware Photon OS/Linux"</span></span><br><span class="line">ANSI_COLOR=<span class="string">"1;34"</span></span><br><span class="line">HOME_URL=<span class="string">"https://vmware.github.io/photon/"</span></span><br><span class="line">BUG_REPORT_URL=<span class="string">"https://github.com/vmware/photon/issues"</span></span><br></pre></td></tr></table></figure>
<p>ç›®å‰çš„å†…æ ¸ç‰ˆæœ¬æ˜¯ 4.19.79 ï¼Œæ¯” CentOS 7 ç³»é‚£ç§äº”å¹´å‰çš„ 3.18 å†…æ ¸é«˜åˆ°ä¸çŸ¥é“å“ªé‡Œå»äº†ã€‚ä¸è¿‡ä¸ªäººè®¤ä¸ºï¼Œå¯¹äºå®¹å™¨è™šæ‹ŸåŒ–è¿™ç§ä¾èµ–äºå†…æ ¸ç‰¹æ€§çš„æŠ€æœ¯æ¥è®²è¿˜æ˜¯è¦é€‰æ‹©é«˜ä¸€ç‚¹çš„ç‰ˆæœ¬æ¯”è¾ƒå¥½ã€‚åƒ CentOS é‚£ç§äº”å¹´å‰çš„ 3.18 ç‰ˆæœ¬ï¼Œé‚£æ—¶å€™å®¹å™¨æ‰€ä¾èµ–çš„å¾ˆå¤šå†…æ ¸ç‰¹æ€§åœ¨è¿™äº›ç‰ˆæœ¬ä¸Šè¿˜ä¸å¤Ÿæˆç†Ÿã€‚ä»ä½¿ç”¨æ¥è®²ï¼Œæˆ–å¤–çš„å…¬æœ‰äº‘åƒ GKE ã€AKSã€AKE ç­‰éƒ½æ˜¯ä½¿ç”¨çš„ 4.14 å†…æ ¸ç‰ˆæœ¬ä»¥ä¸Šã€‚</p>
<p>4.19 ç‰ˆæœ¬æœ‰ä¸ªå°é—®é¢˜ï¼Œå°±æ˜¯å¦‚æœ kube-proxy ä½¿ç”¨ IPVS çš„è¯ï¼Œéœ€è¦å¼€å¯ç›¸åº”çš„å†…æ ¸æ¨¡å—ï¼Œä¸»è¦ä¾èµ–çš„å†…æ ¸æ¨¡å—æœ‰ä»¥ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">modprobe -- ip_vs</span><br><span class="line">modprobe -- ip_vs_rr</span><br><span class="line">modprobe -- ip_vs_wrr</span><br><span class="line">modprobe -- ip_vs_sh</span><br><span class="line">modprobe -- nf_conntrack_ipv4</span><br></pre></td></tr></table></figure>
<p>åœ¨ 4.19 ç‰ˆæœ¬ä¹‹å nf_conntrack_ipv4 å†…æ ¸æ¨¡å—æ›¿æ¢æˆäº† nf_conntrack ï¼Œå‚çœ‹ <a href="https://github.com/coreos/bugs/issues/2518" target="_blank" rel="noopener">coreos/bugs#2518</a></p>
<h3 id="èµ„æºå ç”¨æƒ…å†µ"><a href="#èµ„æºå ç”¨æƒ…å†µ" class="headerlink" title="èµ„æºå ç”¨æƒ…å†µ"></a>èµ„æºå ç”¨æƒ…å†µ</h3><h4 id="å†…å­˜"><a href="#å†…å­˜" class="headerlink" title="å†…å­˜"></a>å†…å­˜</h4><ul>
<li>ç³»ç»Ÿåˆå§‹åŒ–å¯åŠ¨ä¹‹åå†…å­˜ä»…ä»…ä½¿ç”¨äº† 45Mi</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@photon-machine [ ~ ]<span class="comment"># free -h</span></span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:          2.0Gi        45Mi       1.8Gi       0.0Ki        93Mi       1.8Gi</span><br><span class="line">Swap:            0B          0B          0B</span><br></pre></td></tr></table></figure>
<ul>
<li>å¯åŠ¨ docker è¿›ç¨‹ä¹‹åçš„å ç”¨æƒ…å†µï¼Œä¹Ÿä»…ä»… 109Mi</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@photon-machine [ ~ ]<span class="comment"># free -h</span></span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:          2.0Gi       109Mi       1.6Gi       0.0Ki       238Mi       1.8Gi</span><br><span class="line">Swap:            0B          0B          0B</span><br></pre></td></tr></table></figure>
<h4 id="ç£ç›˜"><a href="#ç£ç›˜" class="headerlink" title="ç£ç›˜"></a>ç£ç›˜</h4><p>ä½¿ç”¨ OVA è™šæ‹Ÿæœºæ¨¡æ¿å¯åŠ¨åçš„è™šæ‹Ÿæœºï¼Œç£ç›˜ä»…ä»…å ç”¨äº† 515MB ï¼Œç¡®å®æ˜¯ç›¸å½“è½»é‡åŒ–ï¼Œè¿™è¿˜æ˜¯åŒ…å«äº† dockerã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@photon-machine [ ~ ]<span class="comment"># df -h</span></span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">/dev/root        16G  515M   15G   4% /</span><br><span class="line">devtmpfs        998M     0  998M   0% /dev</span><br><span class="line">tmpfs          1000M     0 1000M   0% /dev/shm</span><br><span class="line">tmpfs          1000M  532K  999M   1% /run</span><br><span class="line">tmpfs          1000M     0 1000M   0% /sys/fs/cgroup</span><br><span class="line">tmpfs          1000M     0 1000M   0% /tmp</span><br><span class="line">/dev/sda2        10M  2.2M  7.9M  22% /boot/efi</span><br><span class="line">tmpfs           200M     0  200M   0% /run/user/0</span><br></pre></td></tr></table></figure>
<h4 id="è´Ÿè½½"><a href="#è´Ÿè½½" class="headerlink" title="è´Ÿè½½"></a>è´Ÿè½½</h4><p><img src="https://p.k8s.li/20191231113306435.png" alt=""></p>
<h3 id="è¿›ç¨‹å’ŒæœåŠ¡"><a href="#è¿›ç¨‹å’ŒæœåŠ¡" class="headerlink" title="è¿›ç¨‹å’ŒæœåŠ¡"></a>è¿›ç¨‹å’ŒæœåŠ¡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">â— photon-machine</span><br><span class="line">    State: running</span><br><span class="line">     Jobs: 0 queued</span><br><span class="line">   Failed: 0 units</span><br><span class="line">    Since: Tue 2019-12-31 13:53:18 UTC; 11min ago</span><br><span class="line">   CGroup: /</span><br><span class="line">           â”œâ”€user.slice</span><br><span class="line">           â”‚ â””â”€user-0.slice</span><br><span class="line">           â”‚   â”œâ”€session-c1.scope</span><br><span class="line">           â”‚   â”‚ â”œâ”€363 /bin/login -p --</span><br><span class="line">           â”‚   â”‚ â””â”€396 -bash</span><br><span class="line">           â”‚   â”œâ”€session-c2.scope</span><br><span class="line">           â”‚   â”‚ â”œâ”€408 sshd: root@pts/0</span><br><span class="line">           â”‚   â”‚ â”œâ”€415 -bash</span><br><span class="line">           â”‚   â”‚ â””â”€560 systemctl status</span><br><span class="line">           â”‚   â””â”€user@0.service</span><br><span class="line">           â”‚     â””â”€init.scope</span><br><span class="line">           â”‚       â”œâ”€388 /lib/systemd/systemd --user</span><br><span class="line">           â”‚       â””â”€389 (sd-pam)</span><br><span class="line">           â”œâ”€init.scope</span><br><span class="line">           â”‚ â””â”€1 /lib/systemd/systemd</span><br><span class="line">           â””â”€system.slice</span><br><span class="line">             â”œâ”€systemd-networkd.service</span><br><span class="line">             â”‚ â””â”€255 /lib/systemd/systemd-networkd</span><br><span class="line">             â”œâ”€systemd-udevd.service</span><br><span class="line">             â”‚ â””â”€125 /lib/systemd/systemd-udevd</span><br><span class="line">             â”œâ”€vgauthd.service</span><br><span class="line">             â”‚ â””â”€197 /usr/bin/VGAuthService -s</span><br><span class="line">             â”œâ”€docker.service</span><br><span class="line">             â”‚ â”œâ”€430 /usr/bin/dockerd</span><br><span class="line">             â”‚ â””â”€437 docker-containerd --config /var/run/docker/containerd/containerd.toml</span><br><span class="line">             â”œâ”€systemd-journald.service</span><br><span class="line">             â”‚ â””â”€100 /lib/systemd/systemd-journald</span><br><span class="line">             â”œâ”€sshd.service</span><br><span class="line">             â”‚ â””â”€361 /usr/sbin/sshd -D</span><br><span class="line">             â”œâ”€vmtoolsd.service</span><br><span class="line">             â”‚ â””â”€94 /usr/bin/vmtoolsd</span><br><span class="line">             â”œâ”€systemd-resolved.service</span><br><span class="line">             â”‚ â””â”€257 /lib/systemd/systemd-resolved</span><br><span class="line">             â”œâ”€dbus.service</span><br><span class="line">             â”‚ â””â”€198 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only</span><br><span class="line">             â”œâ”€systemd-timesyncd.service</span><br><span class="line">             â”‚ â””â”€167 /lib/systemd/systemd-timesyncd</span><br><span class="line">             â””â”€systemd-logind.service</span><br><span class="line">               â””â”€195 /lib/systemd/systemd-logind</span><br></pre></td></tr></table></figure>
<h3 id="åŒ…ç®¡ç†å·¥å…·"><a href="#åŒ…ç®¡ç†å·¥å…·" class="headerlink" title="åŒ…ç®¡ç†å·¥å…·"></a>åŒ…ç®¡ç†å·¥å…·</h3><p>Photon OS é»˜è®¤çš„åŒ…ç®¡ç†å·¥å…·æ˜¯ tdnf ï¼Œä¸è¿‡ä¹Ÿæ”¯æŒ yum ï¼Œä¸¤è€…ä½¿ç”¨æ–¹å¼æœ‰ç»†å¾®çš„å·®åˆ«ï¼Œä½¿ç”¨çš„ä¹Ÿæ˜¯ç›¸åŒçš„è½¯ä»¶åŒ…æºï¼Œè€Œä¸”å¯¹äºå›½å†…ç”¨æˆ·æ¥è®²ï¼Œè½¯ä»¶åŒ…æºåœ¨å›½å¤–æœåŠ¡å™¨ä¸Šï¼ˆ<a href="https://dl.bintray.com/vmware/ï¼‰ï¼Œé€Ÿåº¦æ„Ÿäººï¼Œè‚‰çœ¼å¯è§" target="_blank" rel="noopener">https://dl.bintray.com/vmware/ï¼‰ï¼Œé€Ÿåº¦æ„Ÿäººï¼Œè‚‰çœ¼å¯è§</a> KB/s çº§åˆ«çš„é€Ÿåº¦ã€‚ä½ æ‡‚çš„ï¼Œæ“ä»–å¥¶å¥¶çš„ GFWï¼Œå°¼ç›æ­»äº†ğŸ˜¡ï¼Œæç½‘ç»œå°é”è€½è¯¯è¿™äººæ¬ç –ã€‚å®‰è£…é€Ÿåº¦æ…¢å¾—ä¸€æ‰¹ï¼Œå•å•ä¸‹è½½ 50 MB çš„è½¯ä»¶åŒ…å°±ä¸‹ä¸ä¸‹æ¥ï¼Œä¸å¾—ä¸ç”¨ä¸Šæˆ‘é‚£å°é€æ˜ä»£ç†çš„æ—è·¯ç½‘å…³ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">root@photon-OS [ ~ ]<span class="comment"># tdnf upgrade</span></span><br><span class="line"></span><br><span class="line">Installing:</span><br><span class="line">runc                x86_64  1.0.0.rc9-1.ph3   photon-updates     10.24M 10736757</span><br><span class="line">containerd          x86_64  1.2.10-1.ph3      photon-updates     76.25M 79950751</span><br><span class="line">docker-engine       x86_64  18.09.9-1.ph3     photon-updates     91.29M 95721322</span><br><span class="line">docker-cli          x86_64  18.09.9-1.ph3     photon-updates     72.76M 76299393</span><br><span class="line"></span><br><span class="line">Total installed size: 250.54M 262708223</span><br><span class="line"></span><br><span class="line">Upgrading:</span><br><span class="line">sqlite-libs         x86_64  3.27.2-6.ph3      photon-updates      1.08M 1129424</span><br><span class="line">python3-setuptools  noarch  3.7.5-1.ph3       photon-updates      1.61M 1692186</span><br><span class="line">python3-xml         x86_64  3.7.5-1.ph3       photon-updates    333.69k 341698</span><br><span class="line">python3-libs        x86_64  3.7.5-1.ph3       photon-updates     22.88M 23990697</span><br><span class="line">python3             x86_64  3.7.5-1.ph3       photon-updates      2.90M 3044206</span><br><span class="line">openssl             x86_64  1.0.2t-2.ph3      photon-updates      4.53M 4750710</span><br><span class="line">openssh-server      x86_64  7.8p1-6.ph3       photon-updates    904.54k 926254</span><br><span class="line">openssh-clients     x86_64  7.8p1-6.ph3       photon-updates      3.65M 3831266</span><br><span class="line">openssh             x86_64  7.8p1-6.ph3       photon-updates        0.00b 0</span><br><span class="line">linux-esx           x86_64  4.19.87-1.ph3     photon-updates     12.67M 13284780</span><br><span class="line">libarchive          x86_64  3.3.3-4.ph3       photon-updates    804.34k 823648</span><br><span class="line">e2fsprogs-libs      x86_64  1.44.3-4.ph3      photon-updates     74.62k 76416</span><br><span class="line">e2fsprogs           x86_64  1.44.3-4.ph3      photon-updates      1.88M 1972142</span><br><span class="line">docker              x86_64  18.09.9-1.ph3     photon-updates        0.00b 0</span><br><span class="line">dhcp-libs           x86_64  4.3.5-7.ph3       photon-updates    264.25k 270588</span><br><span class="line">dhcp-client         x86_64  4.3.5-7.ph3       photon-updates      2.52M 2642853</span><br><span class="line"></span><br><span class="line">Total installed size:  56.05M 58776868</span><br><span class="line">Is this ok [y/N]:y</span><br><span class="line"></span><br><span class="line">Downloading:</span><br><span class="line">docker-engine                           302192      1%</span><br><span class="line"></span><br><span class="line">docker-engine                           515184      2%</span><br><span class="line">docker-engine                           523376      2%</span><br><span class="line">docker-engine                          4234352     15%</span><br><span class="line">docker-engine                         23477360     84%</span><br><span class="line"></span><br><span class="line">docker-engine                         23477360     84%</span><br></pre></td></tr></table></figure>
<ul>
<li>56.05M / 58776868B å¤§å°çš„æ–‡ä»¶ï¼Œä¸‹è½½äº†ä¸€ä¸Šåˆéƒ½æ²¡æå®Œâ€¦â€¦æ°”çš„æˆ‘æƒ³æ€æ¡Œå­ã€ç ¸é”®ç›˜ã€æ‘”é¼ æ ‡ğŸ˜‘</li>
</ul>
<p>ä¸è¿‡å¯ä»¥æ ¹æ®å®˜æ–¹çš„ç¼–è¯‘æ–‡æ¡£ï¼ŒæŠŠæ•´ä¸ªè½¯ä»¶åŒ…æºç¼–è¯‘å‡ºæ¥ ï¼Œæ”¾åœ¨æœ¬åœ°ä½¿ç”¨ï¼Œç„¶åæ·»åŠ æœ¬çš„ yum æºç å³å¯ã€‚</p>
<h3 id="docker-å®¹å™¨å¼•æ“"><a href="#docker-å®¹å™¨å¼•æ“" class="headerlink" title="docker å®¹å™¨å¼•æ“"></a>docker å®¹å™¨å¼•æ“</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">root@photon-machine [ ~ ]# docker info</span><br><span class="line">Containers: 0</span><br><span class="line"> Running: 0</span><br><span class="line"> Paused: 0</span><br><span class="line"> Stopped: 0</span><br><span class="line">Images: 0</span><br><span class="line">Server Version: 18.06.2-ce</span><br><span class="line">Storage Driver: overlay2</span><br><span class="line"> Backing Filesystem: extfs</span><br><span class="line"> Supports d_type: true</span><br><span class="line"> Native Overlay Diff: true</span><br><span class="line">Logging Driver: json-file</span><br><span class="line">Cgroup Driver: cgroupfs</span><br><span class="line">Plugins:</span><br><span class="line"> Volume: local</span><br><span class="line"> Network: bridge host macvlan null overlay</span><br><span class="line"> Log: awslogs fluentd gcplogs gelf journald json-file logentries splunk syslog</span><br><span class="line">Swarm: inactive</span><br><span class="line">Runtimes: runc</span><br><span class="line">Default Runtime: runc</span><br><span class="line">Init Binary: docker-init</span><br><span class="line">containerd version: 468a545b9edcd5932818eb9de8e72413e616e86e</span><br><span class="line">runc version: a592beb5bc4c4092b1b1bac971afed27687340c5 (expected: 69663f0bd4b60df09991c08812a60108003fa340)</span><br><span class="line">init version: fec3683</span><br><span class="line">Security Options:</span><br><span class="line"> apparmor</span><br><span class="line"> seccomp</span><br><span class="line">  Profile: default</span><br><span class="line">Kernel Version: 4.19.79-1.ph3-esx</span><br><span class="line">Operating System: VMware Photon OS/Linux</span><br><span class="line">OSType: linux</span><br><span class="line">Architecture: x86_64</span><br><span class="line">CPUs: 1</span><br><span class="line">Total Memory: 1.951GiB</span><br><span class="line">Name: photon-machine</span><br><span class="line">ID: N53E:2APV:XYZX:QFPE:GGZU:7567:XBFB:M4VQ:F5HZ:XPRK:W33H:QYMI</span><br><span class="line">Docker Root Dir: /var/lib/docker</span><br><span class="line">Debug Mode (client): false</span><br><span class="line">Debug Mode (server): false</span><br><span class="line">Registry: https://index.docker.io/v1/</span><br><span class="line">Labels:</span><br><span class="line">Experimental: false</span><br><span class="line">Insecure Registries:</span><br><span class="line"> 127.0.0.0/8</span><br><span class="line">Live Restore Enabled: false</span><br></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨ä½“éªŒ"><a href="#ä½¿ç”¨ä½“éªŒ" class="headerlink" title="ä½¿ç”¨ä½“éªŒ"></a>ä½¿ç”¨ä½“éªŒ</h3><p>æ€»ä½“æ¥è®²ï¼Œé™¤äº†å®‰è£…è½¯ä»¶é€Ÿåº¦ææ…¢ä¹‹å¤–ï¼Œä½¿ç”¨èµ·æ¥å’Œæ™®é€šçš„ Linux å‘è¡Œç‰ˆæ— å¤šå¤§å·®åˆ«ï¼Œç³»ç»Ÿèµ„æºå ç”¨æ¯”ä¼ ç»Ÿçš„ Linux å‘è¡Œç‰ˆè¦ä½çš„å¤šã€‚å³ä¾¿æ˜¯è¿è¡Œäº† docker è¿›ç¨‹åç³»ç»Ÿå†…å­˜ä¹Ÿä»…ä»…å ç”¨ 100 Mb å·¦å³ï¼Œè€Œç£ç›˜å ç”¨æ‰ 500MB ç®—æ˜¯æ¯”è¾ƒè½»é‡åŒ–çš„ã€‚è‡³äºæ€§èƒ½æ–¹é¢ï¼Œç›®å‰æˆ‘è¿˜æ˜¯æ‰¾ä¸åˆ°å¯ä»¥æµ‹è¯•å¯¹æ¯”çš„æ–¹æ¡ˆã€‚</p>
<p>è¾ƒä¼ ç»Ÿçš„ Linux å‘è¡Œç‰ˆï¼Œç²¾ç®€äº†å¤§é‡ä¸å¿…è¦çš„æœåŠ¡å’Œè½¯ä»¶ï¼Œç”šè‡³è¿ tar å‘½ä»¤éƒ½æ²¡æœ‰â€¦â€¦ã€‚å¦‚æœæŠŠå®ƒå½“ä½œ kubenetes å·¥ä½œè´Ÿè½½ Node èŠ‚ç‚¹æ¥ä½¿ç”¨ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œkube-proxy ä¾èµ–çš„ä¸€äº›å·¥å…·å¹¶æ²¡æœ‰å®‰è£…ä¸Šã€‚æˆ‘ä½¿ç”¨ kubeadm å°†è¯¥èŠ‚ç‚¹åŠ å…¥åˆ°é›†ç¾¤å½“ä¸­çš„æ—¶å€™å°±æç¤ºç¼ºå°‘ä»¥ä¸‹å‡ ä¸ªå·¥å…·ï¼š <code>ipset socat ethtool ebtables</code> ï¼Œè¿™äº›å¯¹äº IPVS éƒ½æ˜¯éœ€è¦çš„ã€‚æœ€å¥½ä½¿ç”¨ tdnf ä¸€å¹¶å®‰è£…ä¸Šï¼Œå¹¶ä¸”å¼€å¯ç›¸åº”çš„ IPVS å†…æ ¸æ¨¡å—ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tdnf install ipset socat ethtool ebtables tar -y</span><br><span class="line">modprobe -- ip_vs</span><br><span class="line">modprobe -- ip_vs_rr</span><br><span class="line">modprobe -- ip_vs_wrr</span><br><span class="line">modprobe -- ip_vs_sh</span><br><span class="line">modprobe -- nf_conntrack</span><br></pre></td></tr></table></figure>
<p>è™½ç„¶ç»è¿‡äº† 3 ä¸ªç‰ˆæœ¬çš„æ›´æ–°è¿­ä»£ï¼Œä½† Photon OS ç”¨äºç”Ÿäº§ç¯å¢ƒè¿˜éœ€è¦è¿›è¡Œç¨³å®šæ€§æµ‹è¯•ï¼Œå®ƒä¸å¦‚ CoreOS é‚£æ ·å·²ç»åœ¨å¤§è§„æ¨¡é›†ç¾¤ä¸­å¾—åˆ°çš„å®è·µï¼Œç›®å‰ç”¨ Photon OS çš„ä¼ä¸šæˆ‘ç›®å‰è¿˜æœªè§åˆ°è¿‡ã€‚è€Œ CoreOS</p>
<blockquote>
<p>â€œä½œä¸º Linux ä»¥åŠå¼€æºè½¯ä»¶çš„æ”¯æŒè€…ï¼Œæˆ‘ä»¬ç›¸ä¿¡ä¸ CoreOS  è¿™æ ·çš„å¼€æºç¤¾åŒºåˆ›æ–°å…ˆé”‹åˆä½œæ˜¯éå¸¸é‡è¦çš„ã€‚æˆ‘ä»¬å¸Œæœ›é€šè¿‡è¿™æ ·çš„åˆä½œæ¥ä¸ºäº‘å¹³å°ç”¨æˆ·å¸¦æ¥æ›´å¤šã€æ›´çµæ´»çš„é€‰æ‹©ã€‚â€ å¾®è½¯ Azure çš„é¦–å¸­æŠ€æœ¯å®˜ Mark Russinovich æåˆ°ï¼Œ â€œCoreOS Linux  ä¸é«˜æ€§èƒ½ã€å¤§è§„æ¨¡çš„å¾®è½¯äº‘ç›¸ç»“åˆï¼Œæ— ç–‘å°†ä¼šä¿ƒè¿›å„ç§åº”ç”¨æœåŠ¡çš„åˆ›æ–°ã€ä»¥åŠå…¨çƒå›¢é˜Ÿçš„åä½œã€‚â€</p>
</blockquote>
<blockquote>
<p>â€œæˆ‘ä»¬å·²ç»åœ¨ä¸Šåƒå°ç‰©ç†æœºä¸ŠæˆåŠŸéƒ¨ç½²å¹¶è¿è¡Œäº† CoreOS  Linuxã€‚æ— è®ºä»æ“ä½œç³»ç»Ÿçš„å®‰è£…ã€å‡çº§ï¼Œè¿˜æ˜¯ä»å®¹å™¨çš„ç®¡ç†å’Œåº”ç”¨éƒ¨ç½²ä¸Šï¼Œå¥¹ç»™æˆ‘ä»¬å¸¦æ¥äº†å‰æ‰€æœªæœ‰çš„ä½“éªŒï¼å¯¹äºå…‰éŸ³ç½‘ç»œè¿™ç§é£é€Ÿå‘å±•çš„äº’è”ç½‘å…¬å¸æ¥è¯´ï¼ŒCoreOS ä¸ºæˆ‘ä»¬å¹³å°çš„å»ºè®¾æä¾›äº†æœ‰åŠ›çš„æŠ€æœ¯ä¿éšœï¼åœ¨ä½¿ç”¨ CoreOS çš„è¿™ä¸¤å¹´ä¸­ï¼Œæˆ‘ä»¬ä¸å†å»æ‹…å¿ƒæ“ä½œç³»ç»Ÿã€Docker ä»¥åŠ Kubernetes  çš„å…¼å®¹æ€§ã€ç‰ˆæœ¬å‡çº§ä»¥åŠç¨³å®šæ€§ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ›´ä¸“æ³¨äºåº”ç”¨ã€ä¸šåŠ¡å±‚ä¸Šçš„ç®¡ç†å’Œç ”å‘ã€‚â€  å…‰éŸ³ç½‘ç»œæŠ€æœ¯è´Ÿè´£äººç‹é¹è¯´ï¼Œâ€œæˆ‘ä»¬çš„å¹³å°ä¸ä»…å¯ä»¥è·‘åœ¨è‡ªå·±çš„ç‰©ç†æœºä¸Šï¼Œè€Œä¸”è¿˜å¯ä»¥è½»æ¾åœ°éƒ¨ç½²åˆ° AWS åŠé˜¿é‡Œäº‘ä¸Šï¼ŒCoreOS  åœ¨è¿™æ–¹é¢åŠŸä¸å¯æ²¡ã€‚æˆ‘ä»¬ç°åœ¨å¾ˆé«˜å…´åœ°å¾—çŸ¥ CoreOS å°†å¼ºåŠ¿ç™»é™†ä¸­å›½å¸‚åœºï¼Œæˆ‘ä»¬å¯¹äºæ›´å¥½çš„æŠ€æœ¯æ”¯æŒå’ŒæœåŠ¡æ— æ¯”æœŸå¾…ï¼â€</p>
<p>æ­¤å¤„å¼•ç”¨ CoreOS <a href="https://coreos.com/blog/coreos-linux-available-in-china.html" target="_blank" rel="noopener">å®˜ç½‘åšå®¢</a></p>
</blockquote>
<p>CoreOS çš„ç¨³å®šæ€§ä»¥åŠç”Ÿäº§å®è·µå·²ç»ç›¸å½“æˆç†Ÿäº†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±ä»‹ç» CoreOS çš„ä½¿ç”¨ä½“éªŒã€‚</p>
<h2 id="CoreOS-Container-Linux-1"><a href="#CoreOS-Container-Linux-1" class="headerlink" title="CoreOS Container Linux"></a>CoreOS Container Linux</h2><p>CoreOS ä½¿ç”¨ç”¨æ¥åˆ›å»ºä¸€å¥—å¤§è§„æ¨¡çš„é›†ç¾¤ç¯å¢ƒï¼Œå•ç‹¬ä½¿ç”¨çš„æ„ä¹‰å¹¶ä¸å¤§ã€‚è€Œä¸”å¯¹äºæˆ‘å¸çš„ VMware vSphere å¹¶æ²¡æœ‰è¿›è¡Œä¼˜åŒ–ã€‚æ‰€ä»¥å°±æŒ‰ç…§è£¸é‡‘å±éƒ¨ç½²çš„æ–¹å¼æ¥å®‰è£…ä½“éªŒã€‚</p>
<h3 id="å®˜æ–¹æ–‡æ¡£-1"><a href="#å®˜æ–¹æ–‡æ¡£-1" class="headerlink" title="å®˜æ–¹æ–‡æ¡£"></a><a href="http://coreos.com/os/docs/latest/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></h3><h4 id="Cloud-Providers"><a href="#Cloud-Providers" class="headerlink" title="Cloud Providers"></a>Cloud Providers</h4><p>é€‚ç”¨äºå…¬æœ‰äº‘</p>
<ul>
<li><a href="http://coreos.com/os/docs/latest/booting-on-ec2.html" target="_blank" rel="noopener">Amazon EC2</a></li>
<li><a href="http://coreos.com/os/docs/latest/booting-on-digitalocean.html" target="_blank" rel="noopener">DigitalOcean</a></li>
<li><a href="http://coreos.com/os/docs/latest/booting-on-google-compute-engine.html" target="_blank" rel="noopener">Google Compute Engine</a></li>
<li><a href="http://coreos.com/os/docs/latest/booting-on-azure.html" target="_blank" rel="noopener">Microsoft Azure</a><a href="http://coreos.com/os/docs/latest/booting-with-qemu.html" target="_blank" rel="noopener">QEMU</a></li>
</ul>
<h4 id="Bare-Metal"><a href="#Bare-Metal" class="headerlink" title="Bare Metal"></a>Bare Metal</h4><p>é€‚ç”¨äºç‰©ç†æœº</p>
<ul>
<li><a href="http://coreos.com/matchbox/" target="_blank" rel="noopener">Using Matchbox</a></li>
<li><a href="http://coreos.com/os/docs/latest/booting-with-ipxe.html" target="_blank" rel="noopener">Booting with iPXE</a></li>
<li><a href="http://coreos.com/os/docs/latest/booting-with-pxe.html" target="_blank" rel="noopener">Booting with PXE</a></li>
<li><a href="http://coreos.com/os/docs/latest/installing-to-disk.html" target="_blank" rel="noopener">Installing to Disk</a></li>
<li><a href="http://coreos.com/os/docs/latest/booting-with-iso.html" target="_blank" rel="noopener">Booting from ISO</a></li>
<li><a href="http://coreos.com/os/docs/latest/root-filesystem-placement.html" target="_blank" rel="noopener">Root filesystem placement</a></li>
</ul>
<h4 id="Community-Platforms"><a href="#Community-Platforms" class="headerlink" title="Community Platforms"></a>Community Platforms</h4><p>ç¤¾åŒºæä¾›æ”¯æŒçš„</p>
<p>These <a href="http://coreos.com/os/docs/latest/community-platforms.html" target="_blank" rel="noopener">platforms and providers</a> offer support and documentation for running Container Linux.</p>
<ul>
<li><a href="http://coreos.com/os/docs/latest/booting-on-cloudstack.html" target="_blank" rel="noopener">CloudStack</a></li>
<li><a href="http://coreos.com/os/docs/latest/booting-on-eucalyptus.html" target="_blank" rel="noopener">Eucalyptus</a></li>
<li><a href="http://coreos.com/os/docs/latest/booting-with-libvirt.html" target="_blank" rel="noopener">libvirt</a></li>
<li><a href="http://coreos.com/os/docs/latest/booting-on-openstack.html" target="_blank" rel="noopener">OpenStack</a></li>
<li><a href="http://coreos.com/os/docs/latest/booting-on-vagrant.html" target="_blank" rel="noopener">Vagrant</a></li>
<li><a href="http://coreos.com/os/docs/latest/booting-on-virtualbox.html" target="_blank" rel="noopener">VirtualBox</a></li>
<li><a href="http://coreos.com/os/docs/latest/booting-on-vmware.html" target="_blank" rel="noopener">VMware</a></li>
</ul>
<h3 id="å®‰è£…é•œåƒ-OVA"><a href="#å®‰è£…é•œåƒ-OVA" class="headerlink" title="å®‰è£…é•œåƒ OVA"></a>å®‰è£…é•œåƒ <a href="https://stable.release.core-os.net/amd64-usr/current/coreos_production_vmware_ova.ova" target="_blank" rel="noopener">OVA</a></h3><p>ä¸‹è½½ä¸‹æ¥ OVA è™šæ‹Ÿæœºæ¨¡æ¿ <a href="https://stable.release.core-os.net/amd64-usr/current/coreos_production_vmware_ova.ova" target="_blank" rel="noopener">OVA</a></p>
<h3 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>å’Œ Photon OS å®‰è£…æ­¥éª¤ä¸€æ ·ï¼Œåœ¨ ESXi ä¸Šå¯¼å…¥ OVA è™šæ‹Ÿæœºæ¨¡æ¿å³å¯ï¼Œä¸è¿‡éœ€è¦åœ¨æœ€åä¸€æ­¥é…ç½®å¥½ OS ï¼ŒåŒ…æ‹¬ä¸»æœºåã€é…ç½®æ–‡ä»¶æ•°é…ç½®æ–‡ä»¶ urlã€åŠ å¯†çš„é…ç½®æ–‡ä»¶ç­‰ç­‰ï¼Œæ ¹æ®è‡ªèº«éœ€æ±‚é…å¥½å³å¯ã€‚å¯ä»¥å‚ç…§å®˜æ–¹<a href="https://coreos.com/os/docs/latest/clc-examples.html" target="_blank" rel="noopener">é…ç½®æ–‡ä»¶çš„æ–‡æ¡£</a> ã€‚è¿™ä¸€æ­¥æ˜¯å¿…é¡»è¦åšçš„ï¼Œä¸ç„¶æ²¡æœ‰ ssh å…¬é’¥å’Œå¯†ç ä½ æ˜¯æ— æ³•ç™»å½•åˆ°ç³»ç»Ÿä¸­çš„ã€‚</p>
<p>æ³¨æ„ï¼Œå®˜æ–¹ç»™äº†ä¸¤ç§é…ç½®æ–‡ä»¶åˆé€‚ï¼Œä¸€ä¸ªæ˜¯ yaml ä¸€ä¸ªæ˜¯ json ï¼Œä¸è¿‡åœ¨è¿™é‡Œè¦ä½¿ç”¨</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"ignition"</span>: &#123;</span><br><span class="line">    <span class="attr">"config"</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">"timeouts"</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">"version"</span>: <span class="string">"2.1.0"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"networkd"</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">"passwd"</span>: &#123;</span><br><span class="line">    <span class="attr">"users"</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">"name"</span>: <span class="string">"core"</span>,</span><br><span class="line">        <span class="attr">"passwordHash"</span>: <span class="string">"$6$43y3tkl..."</span>,</span><br><span class="line">        <span class="attr">"sshAuthorizedKeys"</span>: [</span><br><span class="line">          <span class="string">"key1"</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"storage"</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">"systemd"</span>: &#123;&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>password_hash</code> å¯ä»¥é€šè¿‡ openssl å‘½ä»¤æ¥ç”Ÿæˆï¼ŒæŠŠç”Ÿæˆçš„ä¸€æ•´ä¸²å†…å®¹å¡«å†™åˆ°ä¸Šé¢ï¼ŒåŒ…æ‹¬åé¢é‚£ä¸ªç‚¹<code>.</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€@debian ~</span><br><span class="line">â•°â”€$ openssl passwd -1</span><br><span class="line">Password:</span><br><span class="line">Verifying - Password:</span><br><span class="line"><span class="variable">$1</span><span class="variable">$nCzW8953</span><span class="variable">$un</span>/JUMJDE2588l7Y6KkP.</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ssh_authorized_keys</code> é€šè¿‡ ssh-keygen ç”Ÿæˆï¼Œç”Ÿæˆçš„å…¬é’¥å¡«å†™åœ¨ä¸Šé¢ã€‚</li>
</ul>
<p>é…ç½®å®Œæˆä¹‹åå°±æŠŠæ•´ä¸ªå†…å®¹å¤åˆ¶ç²˜è´´åˆ°ç¬¬äºŒä¸ªæ¡†æ¡† <code>CoreOS config data</code> é‡Œ</p>
<h4 id="å…¶ä»–è®¾ç½®"><a href="#å…¶ä»–è®¾ç½®" class="headerlink" title="å…¶ä»–è®¾ç½®"></a>å…¶ä»–è®¾ç½®</h4><p><img src="https://p.k8s.li/20191231125441199.png" alt=""></p>
<h3 id="ç³»ç»Ÿå¯åŠ¨-1"><a href="#ç³»ç»Ÿå¯åŠ¨-1" class="headerlink" title="ç³»ç»Ÿå¯åŠ¨"></a>ç³»ç»Ÿå¯åŠ¨</h3><p>å¯èƒ½æ˜¯ coreos config é…ç½®æ–‡ä»¶æ²¡æœ‰é…å¥½ï¼Œè€Œå¯¼è‡´å¯åŠ¨åè¾“å…¥è®¾ç½®çš„å¯†ç æç¤ºé”™è¯¯ğŸ˜¥ï¼Œåƒµç¡¬ï¼Œåªèƒ½é€šè¿‡ä¿®æ”¹ grub å¯åŠ¨å‚æ•°æ¥è·³è¿‡äº†ã€‚</p>
<ul>
<li>1.æ‰“å¼€ CoreOS è™šæ‹Ÿæœºç”µæºï¼Œå¹¶æ‰“å¼€æ§åˆ¶å°ã€‚</li>
<li>2.å½“ Boot Loader æç¤ºå‡ºç°çš„æ—¶å€™ï¼ŒæŒ‰ä¸‹ e é”®æ¥ç¼–è¾‘ GRUB èœå•ã€‚é€‰æ‹©ç¬¬ä¸€ä¸ª coreos default ç¼–è¾‘ã€‚</li>
<li>3.æ·»åŠ  <code>coreos.autologin</code> ä½œä¸ºå¯åŠ¨å‚æ•°ï¼Œå¹¶ Ctrl-x æˆ– F10 é‡å¯ã€‚è¿™å°†ä½¿æ§åˆ¶å°è·³è¿‡ç™»å½•æç¤ºå¹¶ç›´æ¥è¿›å…¥ç”¨æˆ· core çš„ shellã€‚</li>
<li><img src="https://p.k8s.li/20191231133509428.png" alt=""></li>
<li>å¯åŠ¨è¿›å…¥ç³»ç»Ÿä¹‹åè¾“å…¥ <code>sudo passwd</code> æ¥ä¿®æ”¹ root å¯†ç ã€‚ç„¶ååˆ‡æ¢åˆ° root ç”¨æˆ·ä¸‹ <code>passwd core</code> ä¿®æ”¹ core è¿™ä¸ªç”¨æˆ·çš„å¯†ç ã€‚ä¿®æ”¹ä¹‹åå°±å¯ä»¥é€šè¿‡ ssh ç™»å½•å•¦ğŸ˜‚ï¼Œæ¯” Photon OS è¦æŠ˜è…¾ä¸€ç•ªå‘€ã€‚ä¸è¿‡å•Šï¼Œä½¿ç”¨ OVA éƒ¨ç½²æœ€å¥½ç»“åˆ could-init æ¥è®¾ç½®è™šæ‹Ÿæœºçš„ ssh å¯†é’¥ï¼Œç½‘ç»œï¼Œä¸»æœºåç­‰å‚æ•°ã€‚</li>
</ul>
<h3 id="èµ„æºå ç”¨æƒ…å†µ-1"><a href="#èµ„æºå ç”¨æƒ…å†µ-1" class="headerlink" title="èµ„æºå ç”¨æƒ…å†µ"></a>èµ„æºå ç”¨æƒ…å†µ</h3><h5 id="å†…å­˜-1"><a href="#å†…å­˜-1" class="headerlink" title="å†…å­˜"></a>å†…å­˜</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">core@localhost ~ $ free -h</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:          961Mi       177Mi       398Mi       199Mi       385Mi       445Mi</span><br><span class="line">Swap:            0B          0B          0B</span><br></pre></td></tr></table></figure>
<h4 id="ç£ç›˜-1"><a href="#ç£ç›˜-1" class="headerlink" title="ç£ç›˜"></a>ç£ç›˜</h4><p>CoreOS çš„ç£ç›˜åˆ†åŒºå’Œ Photon OS ç•¥æœ‰ä¸åŒ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">core@localhost ~ $ df -h</span><br><span class="line">Filesystem       Size  Used Avail Use% Mounted on</span><br><span class="line">devtmpfs         460M     0  460M   0% /dev</span><br><span class="line">tmpfs            481M     0  481M   0% /dev/shm</span><br><span class="line">tmpfs            481M  484K  481M   1% /run</span><br><span class="line">tmpfs            481M     0  481M   0% /sys/fs/cgroup</span><br><span class="line">/dev/sda9        6.0G   60M  5.6G   2% /</span><br><span class="line">/dev/mapper/usr  985M  854M   80M  92% /usr</span><br><span class="line">none             481M  200M  282M  42% /run/torcx/unpack</span><br><span class="line">tmpfs            481M     0  481M   0% /media</span><br><span class="line">tmpfs            481M     0  481M   0% /tmp</span><br><span class="line">/dev/sda6        108M  7.9M   92M   8% /usr/share/oem</span><br><span class="line">/dev/sda1        127M   54M   73M  43% /boot</span><br><span class="line">tmpfs             97M     0   97M   0% /run/user/500</span><br></pre></td></tr></table></figure>
<h3 id="å†…æ ¸ä»¥åŠå‘è¡Œç‰ˆä¿¡æ¯"><a href="#å†…æ ¸ä»¥åŠå‘è¡Œç‰ˆä¿¡æ¯" class="headerlink" title="å†…æ ¸ä»¥åŠå‘è¡Œç‰ˆä¿¡æ¯"></a>å†…æ ¸ä»¥åŠå‘è¡Œç‰ˆä¿¡æ¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Linux localhost 4.19.86-coreos <span class="comment">#1 SMP Mon Dec 2 20:13:38 -00 2019 x86_64 Intel(R) Core(TM) i5-4590 CPU @ 3.30GHz GenuineIntel GNU/Linux</span></span><br><span class="line"></span><br><span class="line">core@localhost ~ $ cat /etc/os-release</span><br><span class="line">NAME=<span class="string">"Container Linux by CoreOS"</span></span><br><span class="line">ID=coreos</span><br><span class="line">VERSION=2303.3.0</span><br><span class="line">VERSION_ID=2303.3.0</span><br><span class="line">BUILD_ID=2019-12-02-2049</span><br><span class="line">PRETTY_NAME=<span class="string">"Container Linux by CoreOS 2303.3.0 (Rhyolite)"</span></span><br><span class="line">ANSI_COLOR=<span class="string">"38;5;75"</span></span><br><span class="line">HOME_URL=<span class="string">"https://coreos.com/"</span></span><br><span class="line">BUG_REPORT_URL=<span class="string">"https://issues.coreos.com"</span></span><br><span class="line">COREOS_BOARD=<span class="string">"amd64-usr"</span></span><br></pre></td></tr></table></figure>
<h3 id="docker-å®¹å™¨å¼•æ“-1"><a href="#docker-å®¹å™¨å¼•æ“-1" class="headerlink" title="docker å®¹å™¨å¼•æ“"></a>docker å®¹å™¨å¼•æ“</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">core@localhost ~ $ docker info</span><br><span class="line">Containers: 0</span><br><span class="line"> Running: 0</span><br><span class="line"> Paused: 0</span><br><span class="line"> Stopped: 0</span><br><span class="line">Images: 0</span><br><span class="line">Server Version: 18.06.3-ce</span><br><span class="line">Storage Driver: overlay2</span><br><span class="line"> Backing Filesystem: extfs</span><br><span class="line"> Supports d_type: true</span><br><span class="line"> Native Overlay Diff: true</span><br><span class="line">Logging Driver: json-file</span><br><span class="line">Cgroup Driver: cgroupfs</span><br><span class="line">Plugins:</span><br><span class="line"> Volume: local</span><br><span class="line"> Network: bridge host macvlan null overlay</span><br><span class="line"> Log: awslogs fluentd gcplogs gelf journald json-file logentries splunk syslog</span><br><span class="line">Swarm: inactive</span><br><span class="line">Runtimes: runc</span><br><span class="line">Default Runtime: runc</span><br><span class="line">Init Binary: docker-init</span><br><span class="line">containerd version: 468a545b9edcd5932818eb9de8e72413e616e86e</span><br><span class="line">runc version: a592beb5bc4c4092b1b1bac971afed27687340c5</span><br><span class="line">init version: fec3683b971d9c3ef73f284f176672c44b448662</span><br><span class="line">Security Options:</span><br><span class="line"> seccomp</span><br><span class="line">  Profile: default</span><br><span class="line"> selinux</span><br><span class="line">Kernel Version: 4.19.86-coreos</span><br><span class="line">Operating System: Container Linux by CoreOS 2303.3.0 (Rhyolite)</span><br><span class="line">OSType: linux</span><br><span class="line">Architecture: x86_64</span><br><span class="line">CPUs: 2</span><br><span class="line">Total Memory: 961.7MiB</span><br><span class="line">Name: localhost</span><br><span class="line">ID: VUKA:LDLW:WECP:IZKO:A6ED:IKIN:6C3V:VRIL:S4ND:SCII:66EH:GDYP</span><br><span class="line">Docker Root Dir: /var/lib/docker</span><br><span class="line">Debug Mode (client): false</span><br><span class="line">Debug Mode (server): false</span><br><span class="line">Registry: https://index.docker.io/v1/</span><br><span class="line">Labels:</span><br><span class="line">Experimental: false</span><br><span class="line">Insecure Registries:</span><br><span class="line"> 127.0.0.0/8</span><br><span class="line">Live Restore Enabled: false</span><br></pre></td></tr></table></figure>
<h3 id="è´Ÿè½½-1"><a href="#è´Ÿè½½-1" class="headerlink" title="è´Ÿè½½"></a>è´Ÿè½½</h3><p><img src="https://p.k8s.li/20191231135348120.png" alt=""></p>
<h3 id="è¿›ç¨‹å’ŒæœåŠ¡-1"><a href="#è¿›ç¨‹å’ŒæœåŠ¡-1" class="headerlink" title="è¿›ç¨‹å’ŒæœåŠ¡"></a>è¿›ç¨‹å’ŒæœåŠ¡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">â— localhost</span><br><span class="line">    State: running</span><br><span class="line">     Jobs: 0 queued</span><br><span class="line">   Failed: 0 units</span><br><span class="line">    Since: Tue 2019-12-31 13:38:05 UTC; 7h left</span><br><span class="line">   CGroup: /</span><br><span class="line">           â”œâ”€user.slice</span><br><span class="line">           â”‚ â””â”€user-500.slice</span><br><span class="line">           â”‚   â”œâ”€user@500.service</span><br><span class="line">           â”‚   â”‚ â””â”€init.scope</span><br><span class="line">           â”‚   â”‚   â”œâ”€725 /usr/lib/systemd/systemd --user</span><br><span class="line">           â”‚   â”‚   â””â”€726 (sd-pam)</span><br><span class="line">           â”‚   â”œâ”€session-2.scope</span><br><span class="line">           â”‚   â”‚ â”œâ”€768 sshd: core [priv]</span><br><span class="line">           â”‚   â”‚ â”œâ”€781 sshd: core@pts/0</span><br><span class="line">           â”‚   â”‚ â”œâ”€782 -bash</span><br><span class="line">           â”‚   â”‚ â””â”€978 systemctl status</span><br><span class="line">           â”‚   â””â”€session-1.scope</span><br><span class="line">           â”‚     â”œâ”€713 /bin/login -f</span><br><span class="line">           â”‚     â”œâ”€731 -bash</span><br><span class="line">           â”‚     â”œâ”€762 su</span><br><span class="line">           â”‚     â”œâ”€763 bash</span><br><span class="line">           â”‚     â”œâ”€770 su core</span><br><span class="line">           â”‚     â”œâ”€771 bash</span><br><span class="line">           â”‚     â”œâ”€775 su</span><br><span class="line">           â”‚     â””â”€776 bash</span><br><span class="line">           â”œâ”€init.scope</span><br><span class="line">           â”‚ â””â”€1 /usr/lib/systemd/systemd --switched-root --system --deserialize 16</span><br><span class="line">           â””â”€system.slice</span><br><span class="line">             â”œâ”€locksmithd.service</span><br><span class="line">             â”‚ â””â”€718 /usr/lib/locksmith/locksmithd</span><br><span class="line">             â”œâ”€containerd.service</span><br><span class="line">             â”‚ â””â”€800 /run/torcx/bin/containerd --config /run/torcx/unpack/docker/usr/share/containerd/config.toml</span><br><span class="line">             â”œâ”€systemd-networkd.service</span><br><span class="line">             â”‚ â””â”€584 /usr/lib/systemd/systemd-networkd</span><br><span class="line">             â”œâ”€systemd-udevd.service</span><br><span class="line">             â”‚ â””â”€583 /usr/lib/systemd/systemd-udevd</span><br><span class="line">             â”œâ”€docker.service</span><br><span class="line">             â”‚ â””â”€802 /run/torcx/bin/dockerd --host=fd:// --containerd=/var/run/docker/libcontainerd/docker-containerd.sock --selinux-enabled=<span class="literal">true</span></span><br><span class="line">             â”œâ”€update-engine.service</span><br><span class="line">             â”‚ â””â”€663 /usr/sbin/update_engine -foreground -logtostderr</span><br><span class="line">             â”œâ”€systemd-journald.service</span><br><span class="line">             â”‚ â””â”€553 /usr/lib/systemd/systemd-journald</span><br><span class="line">             â”œâ”€systemd-resolved.service</span><br><span class="line">             â”‚ â””â”€635 /usr/lib/systemd/systemd-resolved</span><br><span class="line">             â”œâ”€dbus.service</span><br><span class="line">             â”‚ â””â”€674 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation</span><br><span class="line">             â”œâ”€systemd-timesyncd.service</span><br><span class="line">             â”‚ â””â”€634 /usr/lib/systemd/systemd-timesyncd</span><br><span class="line">             â””â”€systemd-logind.service</span><br><span class="line">               â””â”€672 /usr/lib/systemd/systemd-logind</span><br></pre></td></tr></table></figure>
<h3 id="åŒ…ç®¡ç†å·¥å…·-1"><a href="#åŒ…ç®¡ç†å·¥å…·-1" class="headerlink" title="åŒ…ç®¡ç†å·¥å…·"></a>åŒ…ç®¡ç†å·¥å…·</h3><p><strong>æ²¡å¾—ğŸ˜‚</strong>ï¼Œä½ æ²¡çœ‹é”™ï¼Œç¡®å®å¦‚æ­¤ï¼Œåœ¨ CoreOS ä¸Šæ²¡æœ‰ä½ å¯ä»¥ç”¨çš„åŒ…ç®¡ç†å™¨ï¼Œä¸åƒ PhotonOS é‚£æ ·æœ‰ä¸ª tdnf/yum è®©ä½ çˆ½ä¸€æŠŠğŸ˜‚ã€‚åœ¨ CoreOS ä¸€åˆ‡çš†å®¹å™¨ã€‚å¯ä»¥çœ‹ä¸€ä¸‹ <code>stackexchange.com</code> è¿™ä¸ªç­”æ¡ˆğŸ˜‚ï¼š</p>
<blockquote>
<p>To do this on a CoreOS box, following the hints from the <a href="https://coreos.com/os/docs/latest/install-debugging-tools.html" target="_blank" rel="noopener">guide here</a>:</p>
<ol>
<li>Boot up the CoreOS box and connect as the <code>core</code> user</li>
<li>Run the <code>/bin/toolbox</code> command to enter the stock Fedora container.</li>
<li>Install any software you need. To install nano in this case, it would be as simple as doing a <code>dnf -y install nano</code> (dnf has replaced yum)</li>
<li>Use nano to edit files. â€œBut wait â€“ Iâ€™m in a container!â€ Donâ€™t worry â€“ the hostâ€™s file system is mounted at <code>/media/root</code> when inside the container. So just save a sample text file at <code>/media/root/home/core/test.txt</code>, then <code>exit</code> the container, and finally go list the files in <code>/home/core</code>. Notice your test.txt file?</li>
</ol>
<p>If any part of this is too cryptic or confusing, please ask follow up questions. :-)</p>
</blockquote>
<p>å®˜æ–¹æ¨èä½¿ç”¨ <a href="https://github.com/coreos" target="_blank" rel="noopener">coreos</a>/<strong><a href="https://github.com/coreos/toolbox" target="_blank" rel="noopener">toolbox</a></strong> æ¥å®‰è£…æ‰€éœ€è¦çš„è½¯ä»¶ï¼Œè¿™ä¸ªå·¥å…·ä»¥åå†è¯¦ç»†è®²è§£ä¸€ä¸‹å§ã€‚</p>
<h3 id="ä½¿ç”¨ä½“éªŒ-1"><a href="#ä½¿ç”¨ä½“éªŒ-1" class="headerlink" title="ä½¿ç”¨ä½“éªŒ"></a>ä½¿ç”¨ä½“éªŒ</h3><p>å®‰è£…è¿‡ç¨‹è¦å‡ºäºå®‰å…¨è€ƒè™‘æ¯” Photon OS å¤šäºä¸ªæ­¥éª¤æ¥ç™»å½•åˆ°ç³»ç»Ÿï¼Œç›®å‰æˆ‘è¿˜æ²¡æœ‰æ‰¾åˆ°å¯åŠ¨çš„æ—¶å€™æ·»åŠ  ssh å¯†é’¥çš„åŠæ³•ã€‚æ€»çš„æ¥è®²ï¼Œå† CoreOS é‡Œä¸€åˆ‡çš†å®¹å™¨è¿è¡Œæ‰€éœ€è¦çš„æœåŠ¡ï¼Œè¿™ç§é‡Œé¢è¦å…ˆè¿›çš„å¤šã€‚ä¸‹é¢çš„ RancherOS æ›´æ˜¯å°†ä¸€åˆ‡çš†å®¹å™¨è´¯å½»åˆ°åº•ï¼Œç”šè‡³å°† systemd å–ä»£æ‰ï¼Œä½¿ç”¨ docker æ¥ç®¡ç†ç³»ç»ŸæœåŠ¡ã€‚</p>
<h2 id="RancherOS-1"><a href="#RancherOS-1" class="headerlink" title="RancherOS"></a>RancherOS</h2><p>ç›®å‰ RancherOS çš„ç‰ˆæœ¬æ˜¯ v1.5.5</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Linux 4.14.138</span><br><span class="line">Buildroot: 2018.02.11</span><br><span class="line">Docker docker-19.03.5 by default</span><br><span class="line">RPi64: Linux 4.14.114</span><br><span class="line">Console:</span><br><span class="line">Alpine: 3.10</span><br><span class="line">CentOS: 7.7.1908</span><br><span class="line">Debian: stretch</span><br><span class="line">Fedora: 31</span><br><span class="line">Ubuntu: bionic</span><br></pre></td></tr></table></figure>
<h3 id="å®˜æ–¹æ–‡æ¡£-2"><a href="#å®˜æ–¹æ–‡æ¡£-2" class="headerlink" title="å®˜æ–¹æ–‡æ¡£"></a><a href="https://rancher.com/docs/os/v1.x/en/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></h3><p><a href="https://rancher.com/docs/os/v1.x/en/installation/running-rancheros/" target="_blank" rel="noopener">å®‰è£…æ–‡æ¡£</a></p>
<h4 id="Cloud-äº‘å¹³å°"><a href="#Cloud-äº‘å¹³å°" class="headerlink" title="Cloud äº‘å¹³å°"></a>Cloud äº‘å¹³å°</h4><p><a href="https://rancher.com/docs/os/v1.x/en/installation/running-rancheros/cloud/aws" target="_blank" rel="noopener">Amazon EC2</a></p>
<p><a href="https://rancher.com/docs/os/v1.x/en/installation/running-rancheros/cloud/gce" target="_blank" rel="noopener">Google Compute Engine</a></p>
<p><a href="https://rancher.com/docs/os/v1.x/en/installation/running-rancheros/cloud/do" target="_blank" rel="noopener">DigitalOcean</a></p>
<p><a href="https://rancher.com/docs/os/v1.x/en/installation/running-rancheros/cloud/azure" target="_blank" rel="noopener">Azure</a></p>
<p><a href="https://rancher.com/docs/os/v1.x/en/installation/running-rancheros/cloud/openstack" target="_blank" rel="noopener">OpenStack</a></p>
<p><a href="https://rancher.com/docs/os/v1.x/en/installation/running-rancheros/cloud/vmware-esxi" target="_blank" rel="noopener">VMware ESXi</a></p>
<p><a href="https://rancher.com/docs/os/v1.x/en/installation/running-rancheros/cloud/aliyun" target="_blank" rel="noopener">Aliyun</a></p>
<h4 id="Bare-Metal-amp-Virtual-Servers-è£¸é‡‘å±"><a href="#Bare-Metal-amp-Virtual-Servers-è£¸é‡‘å±" class="headerlink" title="Bare Metal &amp; Virtual Servers è£¸é‡‘å±"></a>Bare Metal &amp; Virtual Servers è£¸é‡‘å±</h4><p><a href="https://rancher.com/docs/os/v1.x/en/installation/running-rancheros/server/pxe" target="_blank" rel="noopener">PXE</a></p>
<p><a href="https://rancher.com/docs/os/v1.x/en/installation/running-rancheros/server/install-to-disk" target="_blank" rel="noopener">Install to Hard Disk</a></p>
<p><a href="https://rancher.com/docs/os/v1.x/en/installation/running-rancheros/server/raspberry-pi" target="_blank" rel="noopener">Raspberry Pi</a></p>
<h3 id="å®‰è£…é•œåƒ-1"><a href="#å®‰è£…é•œåƒ-1" class="headerlink" title="å®‰è£…é•œåƒ"></a><a href="https://github.com/rancher/os/releases/" target="_blank" rel="noopener">å®‰è£…é•œåƒ</a></h3><p>RancherOS å°†å„ä¸ªå¹³å°çš„å®‰è£…é•œåƒéƒ½æ”¾åœ¨äº† GitHub <a href="https://github.com/rancher/os/releases/" target="_blank" rel="noopener">release</a> é¡µé¢ä¸Šã€‚å¯¹äº VMware ç”¨æˆ·å°±ä½¿ç”¨ <a href="https://github.com/rancher/os/releases/download/v1.5.5/rancheros-vmware.iso" target="_blank" rel="noopener">rancheros-vmware.iso</a> è¿™ä¸ªé•œåƒå³å¯ã€‚æ²¡å¾— OVA è™šæ‹Ÿæœºæ¨¡æ¿åªèƒ½æ‰‹åŠ¨æ“ä¸€ä¸ªå•¦ã€‚ä¸‹è½½å®Œæˆä¹‹åå°†è¿™ä¸ªé•œåƒä¸Šä¼ åˆ° vSphere çš„æ•°æ®å­˜å‚¨ä¸­ï¼ŒæŒ‰ç…§åˆ›å»ºå¸¸è§„è™šæ‹Ÿæœºçš„æ–¹å¼æ¥åˆ›å»ºè™šæ‹Ÿæœºã€‚</p>
<h3 id="å®‰è£…-2"><a href="#å®‰è£…-2" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p><img src="https://p.k8s.li/20191231142454934.png" alt=""></p>
<p>ä½¿ç”¨ ISO å¯åŠ¨ä¹‹åè¿›å…¥å¾—æ˜¯ä¸€ä¸ª liveCD å‹å¾—ç³»ç»Ÿï¼Œå¹¶æ²¡æœ‰å®‰è£…è™šæ‹Ÿæœºå¾—ç£ç›˜å½“ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°† RancherOS å®‰è£…åˆ°ç£ç›˜ä¸Šã€‚æå‰å‡†å¤‡å¥½ cloud-init çš„é…ç½®æ–‡ä»¶ï¼Œåªéœ€è¦æ‰§è¡Œ <code>ros install -c cloud-config.yml -d /dev/sda</code> å‘½ä»¤å°±è¡Œå•¦ã€‚-d å‚æ•°åé¢è·Ÿç€å®‰è£…åˆ°çš„ç£ç›˜ã€‚</p>
<p>ä¸è¿‡éœ€è¦åƒ CoreOS é‚£æ ·å‡†å¤‡ç»™ä¸€ä¸ª <code>cloud-config.yml</code> é…ç½®æ–‡ä»¶ï¼Œå°†æˆ‘ä»¬å¾— ssh å…¬é’¥å’Œç”¨æˆ·å¯†ç å¡«å†™åˆ°é‡Œé¢ï¼Œä¸è¿‡ <code>cloud-config</code> èƒ½é…ç½®å¾—é€‰é¡¹éå¸¸å¤šï¼Œåœ¨æ­¤å°±ä¸èµ˜è¿°äº†ï¼Œç­‰æŠ½ç©ºä¸“é—¨å†™ä¸€ç¯‡åšå®¢æ¥è®²è®² cloud-init çš„ä½¿ç”¨ã€‚ï¼ˆåˆæŒ–å‘ğŸ˜‚ï¼Œä¸çŸ¥ä½•æ—¶èƒ½å¡«ä¸ŠğŸ™ƒ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">[root@rancher rancher]<span class="comment"># ros install -c cloud-config.yml -d /dev/sda</span></span><br><span class="line">INFO[0000] No install <span class="built_in">type</span> specified...defaulting to generic</span><br><span class="line">Installing from rancher/os:v1.5.5</span><br><span class="line">Continue [y/N]: y</span><br><span class="line">INFO[0002] start !isoinstallerloaded</span><br><span class="line">INFO[0002] trying to load /bootiso/rancheros/installer.tar.gz</span><br><span class="line">69b8396f5d61: Loading layer [==================================================&gt;]  11.89MB/11.89MB</span><br><span class="line">cae31a9aae74: Loading layer [==================================================&gt;]  1.645MB/1.645MB</span><br><span class="line">78885fd6d98c: Loading layer [==================================================&gt;]  1.536kB/1.536kB</span><br><span class="line">51228f31b9ce: Loading layer [==================================================&gt;]   2.56kB/2.56kB</span><br><span class="line">d8162179e708: Loading layer [==================================================&gt;]   2.56kB/2.56kB</span><br><span class="line">3ee208751cd2: Loading layer [==================================================&gt;]  3.072kB/3.072kB</span><br><span class="line">Loaded image: rancher/os-installer:latest</span><br><span class="line">INFO[0002] Loaded images from /bootiso/rancheros/installer.tar.gz</span><br><span class="line">INFO[0002] starting installer container <span class="keyword">for</span> rancher/os-installer:latest (new)</span><br><span class="line">Installing from rancher/os-installer:latest</span><br><span class="line">mke2fs 1.45.2 (27-May-2019)</span><br><span class="line">64-bit filesystem support is not enabled.  The larger fields afforded by this feature <span class="built_in">enable</span> full-strength checksumming.  Pass -O 64bit to rectify.</span><br><span class="line">Creating filesystem with 7863808 4k blocks and 7864320 inodes</span><br><span class="line">Filesystem UUID: fe29cb27-b4ac-4c75-a12d-895ea7e52af9</span><br><span class="line">Superblock backups stored on blocks:</span><br><span class="line">        32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208,</span><br><span class="line">        4096000</span><br><span class="line"></span><br><span class="line">Allocating group tables: <span class="keyword">done</span></span><br><span class="line">Writing inode tables: <span class="keyword">done</span></span><br><span class="line">Creating journal (32768 blocks): <span class="keyword">done</span></span><br><span class="line">Writing superblocks and filesystem accounting information: <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">Continue with reboot [y/N]:y</span><br><span class="line">INFO[0288] Rebooting</span><br><span class="line">INFO[0288] Setting reboot timeout to 60 (rancher.shutdown_timeout <span class="built_in">set</span> to 60)</span><br><span class="line">....^[            ] reboot:info: Setting reboot timeout to 60 (rancher.shutdown_timeout <span class="built_in">set</span> to 60)</span><br><span class="line">.=.[            ] reboot:info: Stopping /docker : 3d39a73e4089</span><br><span class="line">...........M..........[            ] reboot:info: Stopping /open-vm-tools : ccd97f8a7775</span><br><span class="line">:.[            ] reboot:info: Stopping /ntp : acf47c78a711</span><br><span class="line">.&gt;.[            ] reboot:info: Stopping /network : 08be8ef68e27</span><br><span class="line">..&lt;..[            ] reboot:info: Stopping /udev : 4986cd58a227</span><br><span class="line">.=.[            ] reboot:info: Stopping /syslog : 254137c5e66a</span><br><span class="line">.&lt;.[            ] reboot:info: Stopping /acpid : a2ededff859c</span><br><span class="line">..C..[            ] reboot:info: Stopping /system-cron : 899028a78e3a</span><br><span class="line">..H.[            ] reboot:info: Console Stopping [/console] : 6fc9ef66b43c</span><br><span class="line">Connection to 10.20.172.119 closed by remote host.</span><br><span class="line">Connection to 10.20.172.119 closed.</span><br></pre></td></tr></table></figure>
<h3 id="å†…æ ¸ä»¥åŠå‘è¡Œç‰ˆä¿¡æ¯-1"><a href="#å†…æ ¸ä»¥åŠå‘è¡Œç‰ˆä¿¡æ¯-1" class="headerlink" title="å†…æ ¸ä»¥åŠå‘è¡Œç‰ˆä¿¡æ¯"></a>å†…æ ¸ä»¥åŠå‘è¡Œç‰ˆä¿¡æ¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@rancher rancher]<span class="comment"># uname -a</span></span><br><span class="line">Linux rancher 4.14.138-rancher <span class="comment">#1 SMP Sat Aug 10 11:25:46 UTC 2019 x86_64 GNU/Linux</span></span><br><span class="line">[root@rancher rancher]<span class="comment"># cat /etc/os-release</span></span><br><span class="line">NAME=<span class="string">"RancherOS"</span></span><br><span class="line">VERSION=v1.5.5</span><br><span class="line">ID=rancheros</span><br><span class="line">ID_LIKE=</span><br><span class="line">VERSION_ID=v1.5.5</span><br><span class="line">PRETTY_NAME=<span class="string">"RancherOS v1.5.5"</span></span><br><span class="line">HOME_URL=<span class="string">"http://rancher.com/rancher-os/"</span></span><br><span class="line">SUPPORT_URL=<span class="string">"https://forums.rancher.com/c/rancher-os"</span></span><br><span class="line">BUG_REPORT_URL=<span class="string">"https://github.com/rancher/os/issues"</span></span><br><span class="line">BUILD_ID=</span><br></pre></td></tr></table></figure>
<h3 id="docker-å®¹å™¨å¼•æ“-2"><a href="#docker-å®¹å™¨å¼•æ“-2" class="headerlink" title="docker å®¹å™¨å¼•æ“"></a>docker å®¹å™¨å¼•æ“</h3><p>åœ¨ RancherOS ä¸­æœ‰ä¸¤å¥— docker ï¼Œä¸€å¥—æ˜¯ç”¨æ¥å®¹å™¨åŒ–è¿è¡Œç³»ç»ŸæœåŠ¡çš„ï¼ŒåŒ…æ‹¬ç”¨æˆ·ç©ºé—´çš„ docker ï¼Œè€Œå¦ä¸€å¥— docker å°±æ˜¯ç”¨æˆ·ç©ºé—´çš„ docker</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[root@rancher rancher]</span><span class="comment"># docker info</span></span><br><span class="line">Client:</span><br><span class="line"> Debug Mode: false</span><br><span class="line"></span><br><span class="line">Server:</span><br><span class="line"> Containers: 0</span><br><span class="line">  Running: 0</span><br><span class="line">  Paused: 0</span><br><span class="line">  Stopped: 0</span><br><span class="line"> Images: 0</span><br><span class="line"> Server Version: 19.03.5</span><br><span class="line"> Storage Driver: overlay2</span><br><span class="line">  Backing Filesystem: tmpfs</span><br><span class="line">  Supports d_type: true</span><br><span class="line">  Native Overlay Diff: true</span><br><span class="line"> Logging Driver: json-file</span><br><span class="line"> Cgroup Driver: cgroupfs</span><br><span class="line"> Plugins:</span><br><span class="line">  Volume: local</span><br><span class="line">  Network: bridge host ipvlan macvlan null overlay</span><br><span class="line">  Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog</span><br><span class="line"> Swarm: inactive</span><br><span class="line"> Runtimes: runc</span><br><span class="line"> Default Runtime: runc</span><br><span class="line"> Init Binary: docker-init</span><br><span class="line"> containerd version: b34a5c8af56e510852c35414db4c1f4fa6172339</span><br><span class="line"> runc version: 3e425f80a8c931f88e6d94a8c831b9d5aa481657</span><br><span class="line"> init version: fec3683</span><br><span class="line"> Security Options:</span><br><span class="line">  seccomp</span><br><span class="line">   Profile: default</span><br><span class="line"> Kernel Version: 4.14.138-rancher</span><br><span class="line"> Operating System: RancherOS v1.5.5</span><br><span class="line"> OSType: linux</span><br><span class="line"> Architecture: x86_64</span><br><span class="line"> CPUs: 4</span><br><span class="line"> Total Memory: 3.855GiB</span><br><span class="line"> Name: rancher</span><br><span class="line"> ID: 2256:3I2G:WFHC:ZRTL:CKG6:GXD6:3RDL:645J:CD4J:GKJ7:55SG:U32I</span><br><span class="line"> Docker Root Dir: /var/lib/docker</span><br><span class="line"> Debug Mode: false</span><br><span class="line"> Registry: https://index.docker.io/v1/</span><br><span class="line"> Labels:</span><br><span class="line"> Experimental: false</span><br><span class="line"> Insecure Registries:</span><br><span class="line">  127.0.0.0/8</span><br><span class="line"> Live Restore Enabled: false</span><br><span class="line"> Product License: Community Engine</span><br></pre></td></tr></table></figure>
<h3 id="rancher-å¼•æ“"><a href="#rancher-å¼•æ“" class="headerlink" title="rancher å¼•æ“"></a>rancher å¼•æ“</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@rancher rancher]<span class="comment"># du -sh /var/lib/rancher/engine/*</span></span><br><span class="line">116.0K  /var/lib/rancher/engine/completion</span><br><span class="line">33.0M   /var/lib/rancher/engine/containerd</span><br><span class="line">5.8M    /var/lib/rancher/engine/containerd-shim</span><br><span class="line">18.0M   /var/lib/rancher/engine/ctr</span><br><span class="line">62.6M   /var/lib/rancher/engine/docker</span><br><span class="line">748.0K  /var/lib/rancher/engine/docker-init</span><br><span class="line">2.7M    /var/lib/rancher/engine/docker-proxy</span><br><span class="line">68.8M   /var/lib/rancher/engine/dockerd</span><br><span class="line">8.3M    /var/lib/rancher/engine/runc</span><br></pre></td></tr></table></figure>
<h3 id="èµ„æºå ç”¨"><a href="#èµ„æºå ç”¨" class="headerlink" title="èµ„æºå ç”¨"></a>èµ„æºå ç”¨</h3><h4 id="è´Ÿè½½-2"><a href="#è´Ÿè½½-2" class="headerlink" title="è´Ÿè½½"></a>è´Ÿè½½</h4><ul>
<li>å¯ä»¥çœ‹å‡º RancherOS è¿è¡Œç€å¤§é‡çš„ <code>system-docker-containerd-shim</code> è¿™æ˜¯å› ä¸ºå®ƒå°†ç³»æœåŠ¡ä¹Ÿéƒ½å®¹å™¨åŒ–æ¥è¿è¡Œï¼Œä½†å¥‡æ€ªçš„æ˜¯æ— æ³•ä½¿ç”¨ docker å‘½ä»¤æ¥ç®¡ç†è¿™äº›æœåŠ¡ã€‚</li>
</ul>
<p><img src="https://p.k8s.li/20191231143958024.png" alt=""></p>
<h4 id="å†…å­˜-2"><a href="#å†…å­˜-2" class="headerlink" title="å†…å­˜"></a>å†…å­˜</h4><ul>
<li>åˆå§‹åŒ–å¯åŠ¨åå†…å­˜ä½¿ç”¨äº† 1224MBğŸ˜‚ï¼Œè¦æ¯” CoreOS å’Œ Photon OS åŠ èµ·æ¥è¿˜å¤šğŸ˜‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[rancher@rancher ~]$ free -m</span><br><span class="line">             total       used       free     shared    buffers     cached</span><br><span class="line">Mem:          3947       1224       2722        993          0        993</span><br><span class="line">-/+ buffers/cache:        231       3715</span><br><span class="line">Swap:            0          0          0</span><br></pre></td></tr></table></figure>
<h4 id="ç£ç›˜-2"><a href="#ç£ç›˜-2" class="headerlink" title="ç£ç›˜"></a>ç£ç›˜</h4><p>ç”±äºç³»ç»ŸæœåŠ¡æ˜¯ä»¥å®¹å™¨çš„æ–¹å¼æ¥è¿è¡Œçš„ï¼Œè€Œå®¹å™¨å†…çš„è¿›ç¨‹è¦è®¿é—®ç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿçš„è¯å°±è¦å°†è¿™äº›æ–‡ä»¶æŒ‚è½½åˆ°å®¹å™¨é‡Œå»ï¼Œæ‰€ä»¥ä¼šå‡ºç°è¿™ä¹ˆå¤šçš„åˆ†åŒºæƒ…å†µï¼Œä¸è¿‡ç»å¤§å¤šæ•°éƒ½æ˜¯å®¹å™¨æŒ‚è½½çš„æ•°æ®å·ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">[root@rancher rancher]<span class="comment"># df -h</span></span><br><span class="line">Filesystem                Size      Used Available Use% Mounted on</span><br><span class="line">overlay                  28.0G      1.0G     25.5G   4% /</span><br><span class="line">tmpfs                     1.9G         0      1.9G   0% /dev</span><br><span class="line">tmpfs                     1.9G         0      1.9G   0% /sys/fs/cgroup</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /media</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /opt</span><br><span class="line">none                      1.9G    944.0K      1.9G   0% /run</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /mnt</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /home</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /etc/resolv.conf</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /etc/logrotate.d</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /usr/lib/firmware</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /usr/sbin/iptables</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /etc/docker</span><br><span class="line">none                      1.9G    944.0K      1.9G   0% /var/run</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /var/<span class="built_in">log</span></span><br><span class="line">devtmpfs                  1.9G         0      1.9G   0% /host/dev</span><br><span class="line">shm                      64.0M         0     64.0M   0% /host/dev/shm</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /etc/selinux</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /etc/hosts</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /usr/lib/modules</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /etc/hostname</span><br><span class="line">shm                      64.0M         0     64.0M   0% /dev/shm</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /usr/bin/system-docker</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /var/lib/boot2docker</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /usr/share/ros</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /var/lib/m-user-docker</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /var/lib/waagent</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /var/lib/docker</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /var/lib/kubelet</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /var/lib/rancher</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /usr/bin/ros</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /usr/bin/system-docker-runc</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /etc/ssl/certs/ca-certificates.crt.rancher</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /var/lib/rancher/cache</span><br><span class="line">/dev/sda1                28.0G      1.0G     25.5G   4% /var/lib/rancher/conf</span><br><span class="line">devtmpfs                  1.9G         0      1.9G   0% /dev</span><br><span class="line">shm                      64.0M         0     64.0M   0% /dev/shm</span><br></pre></td></tr></table></figure>
<h4 id="æ–‡ä»¶ç³»ç»Ÿ"><a href="#æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿ"></a>æ–‡ä»¶ç³»ç»Ÿ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">[root@rancher rancher]<span class="comment"># mount</span></span><br><span class="line">overlay on / <span class="built_in">type</span> overlay (rw,relatime,lowerdir=/var/lib/system-docker/overlay2/l/TBWLXSEPWSCBGMNSU37HJXNRO3:/var/lib/system-docker/overlay2/l/DWK2WF5FKFYZTH74WUBGHTRF4V:/var/lib/system-docker/overlay2/l/HDUW6LV2DFEIJPW3IA33YTCNWX:/var/lib/system-docker/overlay2/l/ZDK3KMGDSN5O33AR6XJJF27NFO:/var/lib/system-docker/overlay2/l/TSWFV744M2LUOSPV2N6QHON4NP:/var/lib/system-docker/overlay2/l/QZ3U27554L5LKMJDYP3DC356L7:/var/lib/system-docker/overlay2/l/D6LSXZS2UGAZ7NMKQJKMQVT24P:/var/lib/system-docker/overlay2/l/KHB3OKMEQIL2P34QMHYF3HWTLT,upperdir=/var/lib/system-docker/overlay2/fc79b6b6cf5c6d0b34b5abb95a1a19d765c1a00d66d0cff1ef3778d109471522/diff,workdir=/var/lib/system-docker/overlay2/fc79b6b6cf5c6d0b34b5abb95a1a19d765c1a00d66d0cff1ef3778d109471522/work)</span><br><span class="line">proc on /proc <span class="built_in">type</span> proc (rw,nosuid,nodev,noexec,relatime)</span><br><span class="line">tmpfs on /dev <span class="built_in">type</span> tmpfs (rw,nosuid,mode=755)</span><br><span class="line">devpts on /dev/pts <span class="built_in">type</span> devpts (rw,nosuid,noexec,relatime,gid=5,mode=620,ptmxmode=666)</span><br><span class="line">sysfs on /sys <span class="built_in">type</span> sysfs (rw,nosuid,nodev,noexec,relatime)</span><br><span class="line">tmpfs on /sys/fs/cgroup <span class="built_in">type</span> tmpfs (rw,nosuid,nodev,noexec,relatime,mode=755)</span><br><span class="line">none on /sys/fs/cgroup/freezer <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,freezer)</span><br><span class="line">none on /sys/fs/cgroup/devices <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,devices)</span><br><span class="line">none on /sys/fs/cgroup/net_cls,net_prio <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,net_cls,net_prio)</span><br><span class="line">none on /sys/fs/cgroup/perf_event <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,perf_event)</span><br><span class="line">none on /sys/fs/cgroup/hugetlb <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,hugetlb)</span><br><span class="line">none on /sys/fs/cgroup/cpuset <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,cpuset)</span><br><span class="line">none on /sys/fs/cgroup/cpu,cpuacct <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,cpu,cpuacct)</span><br><span class="line">none on /sys/fs/cgroup/blkio <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,blkio)</span><br><span class="line">none on /sys/fs/cgroup/memory <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,memory)</span><br><span class="line">none on /sys/fs/cgroup/pids <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,pids)</span><br><span class="line">mqueue on /dev/mqueue <span class="built_in">type</span> mqueue (rw,nosuid,nodev,noexec,relatime)</span><br><span class="line">/dev/sda1 on /media <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /opt <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">none on /run <span class="built_in">type</span> tmpfs (rw,relatime)</span><br><span class="line">nsfs on /run/docker/netns/default <span class="built_in">type</span> nsfs (rw)</span><br><span class="line">nsfs on /run/system-docker/netns/default <span class="built_in">type</span> nsfs (rw)</span><br><span class="line">nsfs on /run/system-docker/netns/d15f3e062bb6 <span class="built_in">type</span> nsfs (rw)</span><br><span class="line">/dev/sda1 on /mnt <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /home <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /etc/resolv.conf <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /etc/logrotate.d <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /usr/lib/firmware <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /usr/sbin/iptables <span class="built_in">type</span> ext4 (ro,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /etc/docker <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">none on /var/run <span class="built_in">type</span> tmpfs (rw,relatime)</span><br><span class="line">nsfs on /var/run/docker/netns/default <span class="built_in">type</span> nsfs (rw)</span><br><span class="line">nsfs on /var/run/system-docker/netns/default <span class="built_in">type</span> nsfs (rw)</span><br><span class="line">nsfs on /var/run/system-docker/netns/d15f3e062bb6 <span class="built_in">type</span> nsfs (rw)</span><br><span class="line">/dev/sda1 on /var/<span class="built_in">log</span> <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">devtmpfs on /host/dev <span class="built_in">type</span> devtmpfs (rw,relatime,size=1949420k,nr_inodes=487355,mode=755)</span><br><span class="line">none on /host/dev/pts <span class="built_in">type</span> devpts (rw,relatime,mode=600,ptmxmode=000)</span><br><span class="line">shm on /host/dev/shm <span class="built_in">type</span> tmpfs (rw,nosuid,nodev,noexec,relatime,size=65536k)</span><br><span class="line">mqueue on /host/dev/mqueue <span class="built_in">type</span> mqueue (rw,nosuid,nodev,noexec,relatime)</span><br><span class="line">/dev/sda1 on /etc/selinux <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /etc/hosts <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /usr/lib/modules <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /etc/hostname <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">shm on /dev/shm <span class="built_in">type</span> tmpfs (rw,nosuid,nodev,noexec,relatime,size=65536k)</span><br><span class="line">/dev/sda1 on /usr/bin/system-docker <span class="built_in">type</span> ext4 (ro,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /var/lib/boot2docker <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /usr/share/ros <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /var/lib/m-user-docker <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /var/lib/waagent <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /var/lib/docker <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /var/lib/kubelet <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /var/lib/rancher <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /usr/bin/ros <span class="built_in">type</span> ext4 (ro,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /usr/bin/system-docker-runc <span class="built_in">type</span> ext4 (ro,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /etc/ssl/certs/ca-certificates.crt.rancher <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /var/lib/rancher/cache <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">/dev/sda1 on /var/lib/rancher/conf <span class="built_in">type</span> ext4 (rw,relatime,data=ordered)</span><br><span class="line">devtmpfs on /dev <span class="built_in">type</span> devtmpfs (rw,relatime,size=1949420k,nr_inodes=487355,mode=755)</span><br><span class="line">none on /dev/pts <span class="built_in">type</span> devpts (rw,relatime,mode=600,ptmxmode=000)</span><br><span class="line">shm on /dev/shm <span class="built_in">type</span> tmpfs (rw,nosuid,nodev,noexec,relatime,size=65536k)</span><br><span class="line">mqueue on /dev/mqueue <span class="built_in">type</span> mqueue (rw,nosuid,nodev,noexec,relatime)</span><br><span class="line">cgroup on /sys/fs/cgroup/systemd <span class="built_in">type</span> cgroup (rw,relatime,name=systemd)</span><br><span class="line">none on /sys/fs/selinux <span class="built_in">type</span> selinuxfs (ro,relatime)</span><br></pre></td></tr></table></figure>
<h3 id="ç³»ç»ŸæœåŠ¡å®¹å™¨åŒ–"><a href="#ç³»ç»ŸæœåŠ¡å®¹å™¨åŒ–" class="headerlink" title="ç³»ç»ŸæœåŠ¡å®¹å™¨åŒ–"></a>ç³»ç»ŸæœåŠ¡å®¹å™¨åŒ–</h3><p>é€šè¿‡ top å‘½ä»¤å’Œ ps å‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿè¿è¡Œçš„è¿›ç¨‹å¯ä»¥å‘ç°ä»¥ä¸‹å‡ ä¸ªé‡è¦çš„è¿›ç¨‹</p>
<h4 id="top"><a href="#top" class="headerlink" title="top"></a>top</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">PID  PPID USER     STAT   VSZ %VSZ %CPU COMMAND</span><br><span class="line">1695  1620 root     S     558m  14%   0% containerd --config /var/run/docker/containerd/containerd.toml --<span class="built_in">log</span>-level info</span><br><span class="line">1988  1922 root     S    11420   0%   0% top</span><br><span class="line">   1     0 root     S    1287m  32%   0% system-dockerd --storage-driver overlay2 --graph /var/lib/system-docker --config-file /etc/docker/system-docker.json --restart=<span class="literal">false</span> --group root --userland-proxy=<span class="literal">false</span> --bip 172.18.42.1/16 --<span class="built_in">log</span>-opt max-file=2 --<span class="built_in">log</span>-opt max-size</span><br><span class="line"> 489     1 root     S     833m  21%   0% system-docker-containerd -l unix:///var/run/system-docker/libcontainerd/system-docker-containerd.sock --metrics-interval=0 --start-timeout 2m --state-dir /var/run/system-docker/libcontainerd/containerd --shim system-docker-contai</span><br><span class="line">1370  1353 root     S     808m  20%   0% respawn -f /etc/respawn.conf</span><br><span class="line">1620  1415 root     S     658m  16%   0% dockerd --group docker --host unix:///var/run/docker.sock --<span class="built_in">log</span>-opt max-file=2 --<span class="built_in">log</span>-opt max-size=25m</span><br><span class="line">1398   489 root     S     472m  12%   0% system-docker-containerd-shim 3d39a73e4089dcbdd144277adb398d3e0d8ba62812a699be7cfeac9598539f6e /var/run/system-docker/libcontainerd/3d39a73e4089dcbdd144277adb398d3e0d8ba62812a699be7cfeac9598539f6e system-docker-runc</span><br><span class="line">1285   489 root     S     470m  12%   0% system-docker-containerd-shim 254137c5e66a7075c2104cca82fa2e6584509170688064fac1147fbfcda2f5c0 /var/run/system-docker/libcontainerd/254137c5e66a7075c2104cca82fa2e6584509170688064fac1147fbfcda2f5c0 system-docker-runc</span><br><span class="line">1588  1370 root     S     452m  11%   0% /usr/bin/autologin rancher:tty1</span><br><span class="line">1013   995 root     S     452m  11%   0% netconf</span><br><span class="line">1151   489 root     S     406m  10%   0% system-docker-containerd-shim ccd97f8a77756dcc4ae21c935dcaf35aa8f02399e9ca87811a5f4ec1d5d6d1a3 /var/run/system-docker/libcontainerd/ccd97f8a77756dcc4ae21c935dcaf35aa8f02399e9ca87811a5f4ec1d5d6d1a3 system-docker-runc</span><br><span class="line"> 995   489 root     S     398m  10%   0% system-docker-containerd-shim 08be8ef68e27d7e3b8f9d2a62914f9b581545ed96d65a751b487e7814f2bc795 /var/run/system-docker/libcontainerd/08be8ef68e27d7e3b8f9d2a62914f9b581545ed96d65a751b487e7814f2bc795 system-docker-runc</span><br><span class="line"> 784   489 root     S     335m   8%   0% system-docker-containerd-shim 899028a78e3a3baa42ad1e3042d49f23e9fe2d6cce8b824850aaca4270d681fd /var/run/system-docker/libcontainerd/899028a78e3a3baa42ad1e3042d49f23e9fe2d6cce8b824850aaca4270d681fd system-docker-runc</span><br><span class="line"> 803   489 root     S     335m   8%   0% system-docker-containerd-shim a2ededff859cc3d7c1a6342eb5d92606d4da605433d03abc92cc5f6503d53c6f /var/run/system-docker/libcontainerd/a2ededff859cc3d7c1a6342eb5d92606d4da605433d03abc92cc5f6503d53c6f system-docker-runc</span><br><span class="line">1076   489 root     S     334m   8%   0% system-docker-containerd-shim acf47c78a71194f1ef094302846855c777ef84fe613eb1ac1cc5f7ac868d618c /var/run/system-docker/libcontainerd/acf47c78a71194f1ef094302846855c777ef84fe613eb1ac1cc5f7ac868d618c system-docker-runc</span><br><span class="line"> 956   489 root     S     280m   7%   0% system-docker-containerd-shim 4986cd58a227547af8e4867da067cf9f066062536268bf025466f88b4b38d9c3 /var/run/system-docker/libcontainerd/4986cd58a227547af8e4867da067cf9f066062536268bf025466f88b4b38d9c3 system-docker-runc</span><br><span class="line">1353   489 root     S     270m   7%   0% system-docker-containerd-shim 6fc9ef66b43c9902e23cea7cfdd78b8b5842df2b981d8d7899eacb3b063294fd /var/run/system-docker/libcontainerd/6fc9ef66b43c9902e23cea7cfdd78b8b5842df2b981d8d7899eacb3b063294fd system-docker-runc</span><br><span class="line">1311  1285 root     S     238m   6%   0% rsyslogd -n</span><br><span class="line">1168  1151 root     S     146m   4%   0% /usr/bin/vmtoolsd</span><br><span class="line">1415  1398 root     S     122m   3%   0% system-docker-runc <span class="built_in">exec</span> -- 6fc9ef66b43c9902e23cea7cfdd78b8b5842df2b981d8d7899eacb3b063294fd env PATH=/usr/<span class="built_in">local</span>/sbin:/usr/<span class="built_in">local</span>/bin:/usr/sbin:/usr/bin:/sbin:/bin HOSTNAME=rancher HOME=/ ros docker-init --group docker --host unix:</span><br><span class="line"> 907   784 root     S     109m   3%   0% container-crontab</span><br><span class="line">1105  1076 root     S    94084   2%   0% ntpd --nofork -g</span><br><span class="line"> 973   956 root     S    22544   1%   0% udevd</span><br><span class="line">1890  1888 rancher  S    22448   1%   0% sshd: rancher@pts/0</span><br><span class="line">1586  1370 root     S    22096   1%   0% /usr/sbin/sshd -D</span><br><span class="line">1888  1586 root     S    22096   1%   0% sshd: rancher [priv]</span><br><span class="line">1989  1586 root     S    22096   1%   0% sshd: rancher [priv]</span><br><span class="line">1991  1989 rancher  S    22096   1%   0% sshd: rancher@pts/1</span><br><span class="line">1922  1891 root     S    16244   0%   0% bash</span><br><span class="line">1641  1588 rancher  S    16116   0%   0% -bash</span><br><span class="line">1885  1641 root     S    16116   0%   0% bash</span><br><span class="line">1891  1890 rancher  S    16116   0%   0% -bash</span><br><span class="line">1992  1991 rancher  S    16116   0%   0% -bash</span><br><span class="line">1997  1992 rancher  R    11420   0%   0% top</span><br><span class="line">1589  1370 root     S     6404   0%   0% /sbin/agetty --noclear tty2 linux</span><br><span class="line">1591  1370 root     S     6404   0%   0% /sbin/agetty --noclear tty3 linux</span><br><span class="line">1592  1370 root     S     6404   0%   0% /sbin/agetty --noclear tty4 linux</span><br><span class="line">1594  1370 root     S     6404   0%   0% /sbin/agetty --noclear tty5 linux</span><br><span class="line">1595  1370 root     S     6404   0%   0% /sbin/agetty --noclear tty6 linux</span><br><span class="line">1112   995 root     S     4660   0%   0% dhcpcd -MA4 -e force_hostname=<span class="literal">true</span> --timeout 10 -w --debug eth0</span><br><span class="line"> 850   803 root     S     4276   0%   0% /usr/sbin/acpid -f</span><br><span class="line"> 477     1 root     Z        0   0%   0% [ros]</span><br><span class="line">  49     2 root     IW       0   0%   0% [kworker/1:1]</span><br><span class="line">   8     2 root     IW       0   0%   0% [rcu_sched]</span><br><span class="line">  33     2 root     IW       0   0%   0% [kworker/0:1]</span><br><span class="line">   7     2 root     SW       0   0%   0% [ksoftirqd/0]</span><br><span class="line">  39     2 root     SWN      0   0%   0% [khugepaged]</span><br><span class="line">1317     2 root     IW       0   0%   0% [kworker/3:2]</span><br><span class="line">  48     2 root     IW       0   0%   0% [kworker/u8:1]</span><br><span class="line">  76     2 root     SW       0   0%   0% [scsi_eh_1]</span><br><span class="line">1244     2 root     IW       0   0%   0% [kworker/2:2]</span><br><span class="line">   2     0 root     SW       0   0%   0% [kthreadd]</span><br><span class="line">   4     2 root     IW&lt;      0   0%   0% [kworker/0:0H]</span><br><span class="line">   6     2 root     IW&lt;      0   0%   0% [mm_percpu_wq]</span><br><span class="line">   9     2 root     IW       0   0%   0% [rcu_bh]</span><br><span class="line">  10     2 root     SW       0   0%   0% [migration/0]</span><br><span class="line">  11     2 root     SW       0   0%   0% [watchdog/0]</span><br><span class="line">  12     2 root     SW       0   0%   0% [cpuhp/0]</span><br><span class="line">  13     2 root     SW       0   0%   0% [cpuhp/1]</span><br><span class="line">  14     2 root     SW       0   0%   0% [watchdog/1]</span><br><span class="line">  15     2 root     SW       0   0%   0% [migration/1]</span><br><span class="line">  16     2 root     SW       0   0%   0% [ksoftirqd/1]</span><br><span class="line">  18     2 root     IW&lt;      0   0%   0% [kworker/1:0H]</span><br></pre></td></tr></table></figure>
<h3 id="ros"><a href="#ros" class="headerlink" title="ros"></a>ros</h3><blockquote>
<p>A system service is a container that can be run in either System Docker or Docker. Rancher provides services that are already available in RancherOS by adding them to the <a href="https://github.com/rancher/os-services" target="_blank" rel="noopener">os-services repo</a>. Anything in the <code>index.yml</code> file from the repository for the tagged release will be an available system service when using the <code>ros service list</code> command.</p>
</blockquote>
<p>RancherOS ç§»é™¤äº† systemd ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä½¿ç”¨ ros æ¥ç®¡ç†ç³»ç»ŸæœåŠ¡ã€‚è€Œç›¸åº”çš„ç³»ç»ŸæœåŠ¡ä¹Ÿæ˜¯é‡‡ç”¨ docker çš„æ–¹å¼æ¥è¿è¡Œï¼ŒåŒ…æ‹¬ç”¨æˆ·ç©ºé—´çš„ docker ä¹Ÿæ˜¯é‡‡ç”¨ docker çš„æ–¹å¼æ¥è¿è¡Œã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@rancher rancher]<span class="comment"># ros</span></span><br><span class="line">NAME:</span><br><span class="line">   ros - Control and configure RancherOS</span><br><span class="line">built: <span class="string">'2019-12-30T09:16:00Z'</span></span><br><span class="line"></span><br><span class="line">USAGE:</span><br><span class="line">   ros [global options] <span class="built_in">command</span> [<span class="built_in">command</span> options] [arguments...]</span><br><span class="line"></span><br><span class="line">VERSION:</span><br><span class="line">   v1.5.5</span><br><span class="line"></span><br><span class="line">AUTHOR(S):</span><br><span class="line">   Rancher Labs, Inc.</span><br><span class="line"></span><br><span class="line">COMMANDS:</span><br><span class="line">     config, c   configure settings</span><br><span class="line">     console     manage <span class="built_in">which</span> console container is used</span><br><span class="line">     engine      manage <span class="built_in">which</span> Docker engine is used</span><br><span class="line">     service, s</span><br><span class="line">     os          operating system upgrade/downgrade</span><br><span class="line">     tls         setup tls configuration</span><br><span class="line">     install     install RancherOS to disk</span><br><span class="line">     <span class="built_in">help</span>, h     Shows a list of commands or <span class="built_in">help</span> <span class="keyword">for</span> one <span class="built_in">command</span></span><br><span class="line"></span><br><span class="line">GLOBAL OPTIONS:</span><br><span class="line">   --<span class="built_in">help</span>, -h     show <span class="built_in">help</span></span><br><span class="line">   --version, -v  <span class="built_in">print</span> the version</span><br></pre></td></tr></table></figure>
<h3 id="ç³»ç»Ÿè¿›ç¨‹"><a href="#ç³»ç»Ÿè¿›ç¨‹" class="headerlink" title="ç³»ç»Ÿè¿›ç¨‹"></a>ç³»ç»Ÿè¿›ç¨‹</h3><ul>
<li>å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨ <code>ros service ps</code> å‘½ä»¤æ¥æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„ç³»ç»ŸæœåŠ¡ï¼Œè¿™äº›æœåŠ¡éƒ½æ˜¯ä»¥å®¹å™¨çš„æ–¹å¼æ¥è¿è¡Œçš„ã€‚æ¯”å¦‚ç”¨æˆ·ç©ºé—´é‡Œçš„ <code>user-docker</code> ã€<code>syslog</code> ã€<code>udevd</code>   ç­‰ç­‰éƒ½æ˜¯ä»¥å®¹å™¨çš„æ–¹å¼æ¥è¿è¡Œçš„ï¼Œè€Œä¸æ˜¯ä»¥ä¼ ç»Ÿè¿›ç¨‹æœåŠ¡æ¥è¿è¡Œçš„ã€‚åŒ…æ‹¬æˆ‘ä»¬å®‰è£… RancherOS åˆ°ç£ç›˜çš„æ—¶å€™  <code>starting installer container for rancher/os-installer:latest (new)</code> è¿™ä¸ªå®‰è£…ç¨‹åºä¹Ÿæ˜¯ç”±å®¹å™¨çš„æ–¹å¼æ¥è¿è¡Œçš„ï¼ŒæŠŠç£ç›˜è®¾å¤‡å’Œ <code>cloud-init</code> é…ç½®æ–‡ä»¶ä¸€å¹¶æŒ‚è½½åˆ°å®¹å™¨ä¸­ã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@rancher rancher]<span class="comment"># ros service ps</span></span><br><span class="line">Name                    Command                                                            State                     Ports</span><br><span class="line">docker                  ros user-docker                                                    Up 9 minutes</span><br><span class="line">logrotate               /usr/bin/entrypoint.sh /usr/sbin/logrotate -v /etc/logrotate.conf  Created</span><br><span class="line">system-cron             container-crontab                                                  Up 9 minutes</span><br><span class="line">container-data-volumes  /usr/bin/ros entrypoint <span class="built_in">echo</span>                                       Created</span><br><span class="line">console                 /usr/bin/ros entrypoint ros console-init                           Up 9 minutes</span><br><span class="line">system-volumes          /usr/bin/ros entrypoint <span class="built_in">echo</span>                                       Created</span><br><span class="line">ntp                     /usr/bin/ros entrypoint /bin/start_ntp.sh                          Up 9 minutes</span><br><span class="line">subscriber              /usr/bin/ros entrypoint os-subscriber                              Exited (0) 2 minutes ago</span><br><span class="line">syslog                  /usr/bin/entrypoint.sh rsyslogd -n                                 Up 9 minutes</span><br><span class="line">media-volumes           /usr/bin/ros entrypoint <span class="built_in">echo</span>                                       Created</span><br><span class="line">preload-user-images     /usr/bin/ros entrypoint ros preload-images                         Exited (0) 9 minutes ago</span><br><span class="line">udev                    /usr/bin/ros entrypoint udevd                                      Up 9 minutes</span><br><span class="line">udev-cold               /usr/bin/ros entrypoint ros udev-settle                            Exited (0) 9 minutes ago</span><br><span class="line">network                 /usr/bin/ros entrypoint netconf                                    Up 9 minutes</span><br><span class="line">open-vm-tools           /usr/bin/ros entrypoint /usr/bin/vmtoolsd                          Up 9 minutes</span><br><span class="line">acpid                   /usr/bin/ros entrypoint /usr/sbin/acpid -f                         Up 9 minutes</span><br><span class="line"><span class="built_in">command</span>-volumes         /usr/bin/ros entrypoint <span class="built_in">echo</span>                                       Created</span><br><span class="line">cloud-init-execute      /usr/bin/ros entrypoint cloud-init-execute -pre-console            Exited (0) 9 minutes ago</span><br><span class="line">user-volumes            /usr/bin/ros entrypoint <span class="built_in">echo</span>                                       Created</span><br><span class="line">all-volumes             /usr/bin/ros entrypoint <span class="built_in">echo</span></span><br></pre></td></tr></table></figure>
<h3 id="åŒ…ç®¡ç†å™¨"><a href="#åŒ…ç®¡ç†å™¨" class="headerlink" title="åŒ…ç®¡ç†å™¨"></a>åŒ…ç®¡ç†å™¨</h3><p>å’Œ CoreOS ä¸€æ ·ï¼ŒRancherOS ä¹Ÿæ²¡å¾—ç›¸åº”çš„åŒ…ç®¡ç†å™¨ğŸ˜‚ï¼Œéƒ½æ˜¯é‡‡ç”¨å®¹å™¨æ¥è¿è¡Œæ‰€éœ€çš„æœåŠ¡ï¼Œä½¿ç”¨ <code>ros</code> å‘½ä»¤æ¥ç®¡ç†ç›¸åº”çš„æœåŠ¡ã€‚å¦‚æœæƒ³è¦è¿è¡Œä¸€ä¸ªæœåŠ¡çš„è¯ï¼Œéœ€è¦ä½¿ç”¨ ros æ¥åˆ›å»ºç›¸åº”çš„å®¹å™¨æ¥è¿è¡Œæ‰å¯ä»¥ã€‚è€Œä½¿ç”¨ ros æ¥åˆ›å»ºæœåŠ¡</p>
<h2 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h2><p>æ–‡ç« å†™çš„å¤ªä»“ä¿ƒäº†ï¼Œæ„Ÿè§‰è¿™äº›å®¹å™¨ä¼˜åŒ–è¡Œæ“ä½œç³»ç»Ÿéƒ½å€¼å¾—ç©ä¸€ç©å¾—ï¼Œå°¤å…¶æ˜¯ RancherOS è¿™ç§å°† systemc å–ä»£æ‰ä½¿ç”¨ docker æ¥ç®¡ç†ç³»ç»ŸæœåŠ¡å¾—ç‰›çš®æŠ€æœ¯ï¼Œå€¼å¾—ç ”ç©¶ä¸€å“ˆã€‚å› ä¸ºæ—¶é—´æœ‰é™ï¼Œæ‰€ä»¥å°±æ²¡æœ‰è¯¦ç»†åœ°å±•å¼€æ¥å°†ï¼Œå°±ç­‰åˆ° 2020 å¹´å§ğŸ˜‚ã€‚ç¥å¤§å®¶ 2020 å¹´å…ƒæ—¦å¿«ä¹ï¼Œæ–°çš„ä¸€å¹´é‡Œâ€¦â€¦çœç•¥åƒå­—ç¥ç¦ğŸ˜</p>
    </div>
      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%AE%B9%E5%99%A8/" rel="tag"><i class="fa fa-tag"></i> å®¹å™¨</a>
              <a href="/tags/Linux/" rel="tag"><i class="fa fa-tag"></i> Linux</a>
              <a href="/tags/docker/" rel="tag"><i class="fa fa-tag"></i> docker</a>
              <a href="/tags/kubernees/" rel="tag"><i class="fa fa-tag"></i> kubernees</a>
          </div>
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019-reading-notes.html" rel="prev" title="2019 å¹´è¯»ä¹¦ç¬”è®°å’Œæ€è€ƒ">
      <i class="fa fa-chevron-left"></i> 2019 å¹´è¯»ä¹¦ç¬”è®°å’Œæ€è€ƒ
    </a></div>
      <div class="post-nav-item">
    <a href="/2019-review.html" rel="next" title="2019 review">
      2019 review <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
  </article>
  </div>
          </div>
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
        </div>
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>
  <aside class="sidebar">
    <div class="sidebar-inner">
      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>
      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#æ›´æ–°æ—¥å¿—"><span class="nav-number">1.</span> <span class="nav-text">æ›´æ–°æ—¥å¿—</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å®¹å™¨ä¼˜åŒ–å‹æ“ä½œç³»ç»Ÿï¼Ÿ"><span class="nav-number">2.</span> <span class="nav-text">å®¹å™¨ä¼˜åŒ–å‹æ“ä½œç³»ç»Ÿï¼Ÿ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GKE-çš„-Container-Optimized-OS"><span class="nav-number">2.1.</span> <span class="nav-text">GKE çš„  Container-Optimized OS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CoreOS-Container-Linux"><span class="nav-number">2.2.</span> <span class="nav-text">CoreOS Container Linux</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Photon-OS"><span class="nav-number">2.3.</span> <span class="nav-text">Photon OS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RancherOS"><span class="nav-number">2.4.</span> <span class="nav-text">RancherOS</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å®‰è£…ä½“éªŒ"><span class="nav-number">3.</span> <span class="nav-text">å®‰è£…ä½“éªŒ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Container-Optimized-OS"><span class="nav-number">3.1.</span> <span class="nav-text">Container-Optimized OS</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Photon-OS-1"><span class="nav-number">4.</span> <span class="nav-text">Photon OS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å®˜æ–¹æ–‡æ¡£"><span class="nav-number">4.1.</span> <span class="nav-text">å®˜æ–¹æ–‡æ¡£</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å®‰è£…é•œåƒ"><span class="nav-number">4.2.</span> <span class="nav-text">å®‰è£…é•œåƒ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å®‰è£…"><span class="nav-number">4.3.</span> <span class="nav-text">å®‰è£…</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç³»ç»Ÿå¯åŠ¨"><span class="nav-number">4.4.</span> <span class="nav-text">ç³»ç»Ÿå¯åŠ¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å†…æ ¸"><span class="nav-number">4.5.</span> <span class="nav-text">å†…æ ¸</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#èµ„æºå ç”¨æƒ…å†µ"><span class="nav-number">4.6.</span> <span class="nav-text">èµ„æºå ç”¨æƒ…å†µ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è¿›ç¨‹å’ŒæœåŠ¡"><span class="nav-number">4.7.</span> <span class="nav-text">è¿›ç¨‹å’ŒæœåŠ¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åŒ…ç®¡ç†å·¥å…·"><span class="nav-number">4.8.</span> <span class="nav-text">åŒ…ç®¡ç†å·¥å…·</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#docker-å®¹å™¨å¼•æ“"><span class="nav-number">4.9.</span> <span class="nav-text">docker å®¹å™¨å¼•æ“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä½¿ç”¨ä½“éªŒ"><span class="nav-number">4.10.</span> <span class="nav-text">ä½¿ç”¨ä½“éªŒ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CoreOS-Container-Linux-1"><span class="nav-number">5.</span> <span class="nav-text">CoreOS Container Linux</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å®˜æ–¹æ–‡æ¡£-1"><span class="nav-number">5.1.</span> <span class="nav-text">å®˜æ–¹æ–‡æ¡£</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å®‰è£…é•œåƒ-OVA"><span class="nav-number">5.2.</span> <span class="nav-text">å®‰è£…é•œåƒ OVA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å®‰è£…-1"><span class="nav-number">5.3.</span> <span class="nav-text">å®‰è£…</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç³»ç»Ÿå¯åŠ¨-1"><span class="nav-number">5.4.</span> <span class="nav-text">ç³»ç»Ÿå¯åŠ¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#èµ„æºå ç”¨æƒ…å†µ-1"><span class="nav-number">5.5.</span> <span class="nav-text">èµ„æºå ç”¨æƒ…å†µ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å†…æ ¸ä»¥åŠå‘è¡Œç‰ˆä¿¡æ¯"><span class="nav-number">5.6.</span> <span class="nav-text">å†…æ ¸ä»¥åŠå‘è¡Œç‰ˆä¿¡æ¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#docker-å®¹å™¨å¼•æ“-1"><span class="nav-number">5.7.</span> <span class="nav-text">docker å®¹å™¨å¼•æ“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è´Ÿè½½-1"><span class="nav-number">5.8.</span> <span class="nav-text">è´Ÿè½½</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è¿›ç¨‹å’ŒæœåŠ¡-1"><span class="nav-number">5.9.</span> <span class="nav-text">è¿›ç¨‹å’ŒæœåŠ¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åŒ…ç®¡ç†å·¥å…·-1"><span class="nav-number">5.10.</span> <span class="nav-text">åŒ…ç®¡ç†å·¥å…·</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä½¿ç”¨ä½“éªŒ-1"><span class="nav-number">5.11.</span> <span class="nav-text">ä½¿ç”¨ä½“éªŒ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RancherOS-1"><span class="nav-number">6.</span> <span class="nav-text">RancherOS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å®˜æ–¹æ–‡æ¡£-2"><span class="nav-number">6.1.</span> <span class="nav-text">å®˜æ–¹æ–‡æ¡£</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å®‰è£…é•œåƒ-1"><span class="nav-number">6.2.</span> <span class="nav-text">å®‰è£…é•œåƒ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å®‰è£…-2"><span class="nav-number">6.3.</span> <span class="nav-text">å®‰è£…</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å†…æ ¸ä»¥åŠå‘è¡Œç‰ˆä¿¡æ¯-1"><span class="nav-number">6.4.</span> <span class="nav-text">å†…æ ¸ä»¥åŠå‘è¡Œç‰ˆä¿¡æ¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#docker-å®¹å™¨å¼•æ“-2"><span class="nav-number">6.5.</span> <span class="nav-text">docker å®¹å™¨å¼•æ“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rancher-å¼•æ“"><span class="nav-number">6.6.</span> <span class="nav-text">rancher å¼•æ“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#èµ„æºå ç”¨"><span class="nav-number">6.7.</span> <span class="nav-text">èµ„æºå ç”¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç³»ç»ŸæœåŠ¡å®¹å™¨åŒ–"><span class="nav-number">6.8.</span> <span class="nav-text">ç³»ç»ŸæœåŠ¡å®¹å™¨åŒ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ros"><span class="nav-number">6.9.</span> <span class="nav-text">ros</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç³»ç»Ÿè¿›ç¨‹"><span class="nav-number">6.10.</span> <span class="nav-text">ç³»ç»Ÿè¿›ç¨‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åŒ…ç®¡ç†å™¨"><span class="nav-number">6.11.</span> <span class="nav-text">åŒ…ç®¡ç†å™¨</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç»“æŸ"><span class="nav-number">7.</span> <span class="nav-text">ç»“æŸ</span></a></li></ol></div>
      </div>
      <!--/noindex-->
      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="æœ¨å­"
      src="https://blog.k8s.li/avatar.png">
  <p class="site-author-name" itemprop="name">æœ¨å­</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">98</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">120</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/muzi502" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;muzi502" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:blog@502.li" title="E-Mail â†’ mailto:blog@502.li" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/muzi_ii" title="Twitter â†’ https:&#x2F;&#x2F;twitter.com&#x2F;muzi_ii" rel="noopener" target="_blank"><i class="fa fa-fw fa-twitter"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://t.me/muzi_ii" title="Telegram â†’ https:&#x2F;&#x2F;t.me&#x2F;muzi_ii" rel="noopener" target="_blank"><i class="fa fa-fw fa-telegram"></i>Telegram</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://kindle.502.li/" title="Kindle â†’ https:&#x2F;&#x2F;kindle.502.li" rel="noopener" target="_blank"><i class="fa fa-fw fa-book"></i>Kindle</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tg.k8s.li/" title="Channel â†’ https:&#x2F;&#x2F;tg.k8s.li" rel="noopener" target="_blank"><i class="fa fa-fw fa-telegram"></i>Channel</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS â†’ &#x2F;atom.xml"><i class="fa fa-fw fa-rss"></i>RSS</a>
      </span>
  </div>
      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>
      </div>
    </main>
    <footer class="footer">
      <div class="footer-inner">
<div class="copyright">
  &copy; 2018 â€“ 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">æœ¨å­</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
      <span class="post-meta-item-text">ç«™ç‚¹æ€»å­—æ•°ï¼š</span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">1.4m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">39:50</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> å¼ºåŠ›é©±åŠ¨
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">ä¸»é¢˜ â€“ <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>
      </div>
    </footer>
  </div>
  <script src="/lib/anime.min.js"></script>
<script src="/js/utils.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>
<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://muzi.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: {page: {
            url: "https://blog.k8s.li/container-linux-os.html",
            identifier: "container-linux-os.html",
            title: "Container Linux OS ä»å…¥å‘åˆ°çˆ¬å‡ºæ¥ğŸ˜‚"
          }
        }
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://muzi.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>
</body>
</html>
